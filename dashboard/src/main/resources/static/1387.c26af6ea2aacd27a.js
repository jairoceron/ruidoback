"use strict";var at=Object.defineProperty,ot=Object.defineProperties,lt=Object.getOwnPropertyDescriptors,it=Object.getOwnPropertySymbols,ut=Object.prototype.hasOwnProperty,ct=Object.prototype.propertyIsEnumerable,nt=(P,I,f)=>I in P?at(P,I,{enumerable:!0,configurable:!0,writable:!0,value:f}):P[I]=f,rt=(P,I)=>{for(var f in I||(I={}))ut.call(I,f)&&nt(P,f,I[f]);if(it)for(var f of it(I))ct.call(I,f)&&nt(P,f,I[f]);return P},st=(P,I)=>ot(P,lt(I));(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[1387],{43588:(P,I,f)=>{f.d(I,{e:()=>H});var W,tt,w={exports:{}};W=w,void 0!==(tt=function(){function b(t,r,s){s=s||2;var i,n,a,o,v,y,A,j=r&&r.length,B=j?r[0]*s:t.length,D=U(t,0,B,s,!0),S=[];if(!D||D.next===D.prev)return S;if(j&&(D=function(t,r,s,i){var n,a,o,v=[];for(n=0,a=r.length;n<a;n++)(o=U(t,r[n]*i,n<a-1?r[n+1]*i:t.length,i,!1))===o.next&&(o.steiner=!0),v.push(q(o));for(v.sort(G),n=0;n<v.length;n++)s=K(s=Q(v[n],s),s.next);return s}(t,r,D,s)),t.length>80*s){i=a=t[0],n=o=t[1];for(var g=s;g<B;g+=s)(v=t[g])<i&&(i=v),(y=t[g+1])<n&&(n=y),v>a&&(a=v),y>o&&(o=y);A=0!==(A=Math.max(a-i,o-n))?1/A:0}return Z(D,S,s,i,n,A),S}function U(t,r,s,i,n){var a,o;if(n===V(t,r,s,i)>0)for(a=r;a<s;a+=i)o=T(a,t[a],t[a+1],o);else for(a=s-i;a>=r;a-=i)o=T(a,t[a],t[a+1],o);if(o&&u(o,o.next)){var v=o.next;x(o),o=v}return o}function K(t,r){if(!t)return t;r||(r=t);var s,i=t;do{if(s=!1,i.steiner||!u(i,i.next)&&0!==l(i.prev,i,i.next))i=i.next;else{var n=i.prev;if(x(i),(i=r=n)===i.next)break;s=!0}}while(s||i!==r);return r}function Z(t,r,s,i,n,a,o){if(t){!o&&a&&E(t,i,n,a);for(var v,y,A=t;t.prev!==t.next;)if(v=t.prev,y=t.next,a?F(t,i,n,a):J(t))r.push(v.i/s),r.push(t.i/s),r.push(y.i/s),x(t),t=y.next,A=y.next;else if((t=y)===A){o?1===o?Z(t=N(K(t),r,s),r,s,i,n,a,2):2===o&&k(t,r,s,i,n,a):Z(K(t),r,s,i,n,a,1);break}}}function J(t){var r=t.prev,s=t,i=t.next;if(l(r,s,i)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(R(r.x,r.y,s.x,s.y,i.x,i.y,n.x,n.y)&&l(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function F(t,r,s,i){var n=t.prev,a=t,o=t.next;if(l(n,a,o)>=0)return!1;for(var A=n.x>a.x?n.x>o.x?n.x:o.x:a.x>o.x?a.x:o.x,j=n.y>a.y?n.y>o.y?n.y:o.y:a.y>o.y?a.y:o.y,B=C(n.x<a.x?n.x<o.x?n.x:o.x:a.x<o.x?a.x:o.x,n.y<a.y?n.y<o.y?n.y:o.y:a.y<o.y?a.y:o.y,r,s,i),D=C(A,j,r,s,i),S=t.prevZ,g=t.nextZ;S&&S.z>=B&&g&&g.z<=D;){if(S!==t.prev&&S!==t.next&&R(n.x,n.y,a.x,a.y,o.x,o.y,S.x,S.y)&&l(S.prev,S,S.next)>=0||(S=S.prevZ,g!==t.prev&&g!==t.next&&R(n.x,n.y,a.x,a.y,o.x,o.y,g.x,g.y)&&l(g.prev,g,g.next)>=0))return!1;g=g.nextZ}for(;S&&S.z>=B;){if(S!==t.prev&&S!==t.next&&R(n.x,n.y,a.x,a.y,o.x,o.y,S.x,S.y)&&l(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;g&&g.z<=D;){if(g!==t.prev&&g!==t.next&&R(n.x,n.y,a.x,a.y,o.x,o.y,g.x,g.y)&&l(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function N(t,r,s){var i=t;do{var n=i.prev,a=i.next.next;!u(n,a)&&d(n,i,i.next,a)&&p(n,a)&&p(a,n)&&(r.push(n.i/s),r.push(i.i/s),r.push(a.i/s),x(i),x(i.next),i=t=a),i=i.next}while(i!==t);return K(i)}function k(t,r,s,i,n,a){var o=t;do{for(var v=o.next.next;v!==o.prev;){if(o.i!==v.i&&et(o,v)){var y=L(o,v);return o=K(o,o.next),y=K(y,y.next),Z(o,r,s,i,n,a),void Z(y,r,s,i,n,a)}v=v.next}o=o.next}while(o!==t)}function G(t,r){return t.x-r.x}function Q(t,r){var s=function(t,r){var s,i=r,n=t.x,a=t.y,o=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var v=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(v<=n&&v>o){if(o=v,v===n){if(a===i.y)return i;if(a===i.next.y)return i.next}s=i.x<i.next.x?i:i.next}}i=i.next}while(i!==r);if(!s)return null;if(n===o)return s;var y,A=s,j=s.x,B=s.y,D=1/0;i=s;do{n>=i.x&&i.x>=j&&n!==i.x&&R(a<B?n:o,a,j,B,a<B?o:n,a,i.x,i.y)&&(y=Math.abs(a-i.y)/(n-i.x),p(i,t)&&(y<D||y===D&&(i.x>s.x||i.x===s.x&&$(s,i)))&&(s=i,D=y)),i=i.next}while(i!==A);return s}(t,r);if(!s)return r;var i=L(s,t),n=K(s,s.next);return K(i,i.next),r===s?n:r}function $(t,r){return l(t.prev,t,r.prev)<0&&l(r.next,t,t.next)<0}function E(t,r,s,i){var n=t;do{if(null===n.z&&(n.z=C(n.x,n.y,r,s,i)),n.prev.next!==n||n.next.prev!==n)return n.prev.next=n,n.next.prev=n,E(t,r,s,i);n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var r,s,i,n,a,o,v,y,A=1;do{for(s=t,t=null,a=null,o=0;s;){for(o++,i=s,v=0,r=0;r<A&&(v++,i=i.nextZ);r++);for(y=A;v>0||y>0&&i;)0!==v&&(0===y||!i||s.z<=i.z)?(n=s,s=s.nextZ,v--):(n=i,i=i.nextZ,y--),a?a.nextZ=n:t=n,n.prevZ=a,a=n;s=i}a.nextZ=null,A*=2}while(o>1)}(n)}function C(t,r,s,i,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-s)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-i)*n)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function q(t){var r=t,s=t;do{(r.x<s.x||r.x===s.x&&r.y<s.y)&&(s=r),r=r.next}while(r!==t);return s}function R(t,r,s,i,n,a,o,v){return(n-o)*(r-v)-(t-o)*(a-v)>=0&&(t-o)*(i-v)-(s-o)*(r-v)>=0&&(s-o)*(a-v)-(n-o)*(i-v)>=0}function et(t,r){return t.next.i!==r.i&&t.prev.i!==r.i&&!function(t,r){var s=t;do{if(s.i!==t.i&&s.next.i!==t.i&&s.i!==r.i&&s.next.i!==r.i&&d(s,s.next,t,r))return!0;s=s.next}while(s!==t);return!1}(t,r)&&(p(t,r)&&p(r,t)&&function(t,r){var s=t,i=!1,n=(t.x+r.x)/2,a=(t.y+r.y)/2;do{s.y>a!=s.next.y>a&&s.next.y!==s.y&&n<(s.next.x-s.x)*(a-s.y)/(s.next.y-s.y)+s.x&&(i=!i),s=s.next}while(s!==t);return i}(t,r)&&(l(t.prev,t,r.prev)||l(t,r.prev,r))||u(t,r)&&l(t.prev,t,t.next)>0&&l(r.prev,r,r.next)>0)}function l(t,r,s){return(r.y-t.y)*(s.x-r.x)-(r.x-t.x)*(s.y-r.y)}function u(t,r){return t.x===r.x&&t.y===r.y}function d(t,r,s,i){var n=h(l(t,r,s)),a=h(l(t,r,i)),o=h(l(s,i,t)),v=h(l(s,i,r));return n!==a&&o!==v||!(0!==n||!c(t,s,r))||!(0!==a||!c(t,i,r))||!(0!==o||!c(s,t,i))||!(0!==v||!c(s,r,i))}function c(t,r,s){return r.x<=Math.max(t.x,s.x)&&r.x>=Math.min(t.x,s.x)&&r.y<=Math.max(t.y,s.y)&&r.y>=Math.min(t.y,s.y)}function h(t){return t>0?1:t<0?-1:0}function p(t,r){return l(t.prev,t,t.next)<0?l(t,r,t.next)>=0&&l(t,t.prev,r)>=0:l(t,r,t.prev)<0||l(t,t.next,r)<0}function L(t,r){var s=new O(t.i,t.x,t.y),i=new O(r.i,r.x,r.y),n=t.next,a=r.prev;return t.next=r,r.prev=t,s.next=n,n.prev=s,i.next=s,s.prev=i,a.next=i,i.prev=a,i}function T(t,r,s,i){var n=new O(t,r,s);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function x(t){t.next.prev=t.prev,t.prev.next=t.next,t.next=t,t.prev=t,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function O(t,r,s){this.i=t,this.x=r,this.y=s,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function V(t,r,s,i){for(var n=0,a=r,o=s-i;a<s;a+=i)n+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return n}return b.deviation=function(t,r,s,i){var n=r&&r.length,o=Math.abs(V(t,0,n?r[0]*s:t.length,s));if(n)for(var v=0,y=r.length;v<y;v++)o-=Math.abs(V(t,r[v]*s,v<y-1?r[v+1]*s:t.length,s));var B=0;for(v=0;v<i.length;v+=3){var D=i[v]*s,S=i[v+1]*s,g=i[v+2]*s;B+=Math.abs((t[D]-t[g])*(t[S+1]-t[D+1])-(t[D]-t[S])*(t[g+1]-t[D+1]))}return 0===o&&0===B?0:Math.abs((B-o)/o)},b.flatten=function(t){for(var r=t[0][0].length,s={vertices:[],holes:[],dimensions:r},i=0,n=0;n<t.length;n++){for(var a=0;a<t[n].length;a++)for(var o=0;o<r;o++)s.vertices.push(t[n][a][o]);n>0&&s.holes.push(i+=t[n-1].length)}return s},b}())&&(W.exports=tt);var H=w.exports},42367:(P,I,f)=>{f.d(I,{vX:()=>$,s5:()=>X,k3:()=>G,Or:()=>k});const H=128/Math.PI,F=1/Math.LN2;function N(E,z){return(E%=z)>=0?E:E+z}function k(E){return N(E*H,256)}function X(E){return N(.7111111111111111*E,256)}function G(E){return Math.log(E)*F}function $(E,z,C){return E>=z&&E<=C||E>=C&&E<=z}},21194:(P,I,f)=>{f.d(I,{dk:()=>L,Gq:()=>V,a:()=>x,mE:()=>T,m2:()=>c,qr:()=>O,jj:()=>u,hF:()=>d});var W=f(22795),_=f(38963),tt=f(43281);function u(t,r,s,i,n){switch(t){case _.LW.FILL:return L.from(r,i);case _.LW.LINE:return x.from(r,s);case _.LW.MARKER:return T.from(r);case _.LW.TEXT:return O.from(r);case _.LW.LABEL:return V.from(r,n);default:throw new Error(`Unable to createMaterialKey for unknown geometryType ${t}`)}}function d(t){switch(c.load(t).geometryType){case _.LW.MARKER:return new T(t);case _.LW.FILL:return new L(t);case _.LW.LINE:return new x(t);case _.LW.TEXT:return new O(t);case _.LW.LABEL:return new V(t)}}class c{constructor(r){this._data=0,this._data=r}static load(r){const s=this.shared;return s.data=r,s}set data(r){this._data=r}get data(){return this._data}get geometryType(){return this.bits(8,11)}set geometryType(r){this.setBits(r,8,11)}get mapAligned(){return!!this.bit(20)}set mapAligned(r){this.setBit(20,r)}get sdf(){return!!this.bit(11)}set sdf(r){this.setBit(11,r)}get pattern(){return!!this.bit(12)}set pattern(r){this.setBit(12,r)}get textureBinding(){return this.bits(0,8)}set textureBinding(r){this.setBits(r,0,8)}get geometryTypeString(){switch(this.geometryType){case _.LW.FILL:return"fill";case _.LW.MARKER:return"marker";case _.LW.LINE:return"line";case _.LW.TEXT:return"text";case _.LW.LABEL:return"label";default:throw new W.Z(`Unable to handle unknown geometryType: ${this.geometryType}`)}}setBit(r,s){const i=1<<r;s?this._data|=i:this._data&=~i}bit(r){return(this._data&1<<r)>>r}setBits(r,s,i){for(let n=s,a=0;n<i;n++,a++)this.setBit(n,0!=(r&1<<a))}bits(r,s){let i=0;for(let n=r,a=0;n<s;n++,a++)i|=this.bit(n)<<a;return i}hasVV(){return!1}setVV(r,s){}getVariation(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}}getVariationHash(){return this._data&~(7&this.textureBinding)}}c.shared=new c(0);const h=t=>class extends t{get vvSizeMinMaxValue(){return 0!==this.bit(16)}set vvSizeMinMaxValue(r){this.setBit(16,r)}get vvSizeScaleStops(){return 0!==this.bit(17)}set vvSizeScaleStops(r){this.setBit(17,r)}get vvSizeFieldStops(){return 0!==this.bit(18)}set vvSizeFieldStops(r){this.setBit(18,r)}get vvSizeUnitValue(){return 0!==this.bit(19)}set vvSizeUnitValue(r){this.setBit(19,r)}hasVV(){return super.hasVV()||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}setVV(r,s){super.setVV(r,s);const i=function(t,r=!1){const s=_.X.SIZE_FIELD_STOPS|_.X.SIZE_MINMAX_VALUE|_.X.SIZE_SCALE_STOPS|_.X.SIZE_UNIT_VALUE,i=(t&(_.mf.FIELD_TARGETS_OUTLINE|_.mf.MINMAX_TARGETS_OUTLINE|_.mf.SCALE_TARGETS_OUTLINE|_.mf.UNIT_TARGETS_OUTLINE))>>>4;return r?s&i:s&~i}(r,s)&r;this.vvSizeMinMaxValue=!!(i&_.X.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(i&_.X.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(i&_.X.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(i&_.X.SIZE_SCALE_STOPS)}},m=t=>class extends t{get vvRotation(){return 0!==this.bit(15)}set vvRotation(r){this.setBit(15,r)}hasVV(){return super.hasVV()||this.vvRotation}setVV(r,s){super.setVV(r,s),this.vvRotation=!s&&!!(r&_.X.ROTATION)}},p=t=>class extends t{get vvColor(){return 0!==this.bit(13)}set vvColor(r){this.setBit(13,r)}hasVV(){return super.hasVV()||this.vvColor}setVV(r,s){super.setVV(r,s),this.vvColor=!s&&!!(r&_.X.COLOR)}},M=t=>class extends t{get vvOpacity(){return 0!==this.bit(14)}set vvOpacity(r){this.setBit(14,r)}hasVV(){return super.hasVV()||this.vvOpacity}setVV(r,s){super.setVV(r,s),this.vvOpacity=!s&&!!(r&_.X.OPACITY)}};class L extends(p(M(c))){static load(r){const s=this.shared;return s.data=r,s}static from(r,s){const i=this.load(0);return i.geometryType=_.LW.FILL,s?i.dotDensity=!0:i.setVV(r,!1),i.data}getVariation(){return st(rt({},super.getVariation()),{dotDensity:this.dotDensity,vvColor:this.vvColor,vvOpacity:this.vvOpacity})}get dotDensity(){return!!this.bit(15)}set dotDensity(r){this.setBit(15,r)}}L.shared=new L(0);class T extends(p(M(m(h(c))))){static load(r){const s=this.shared;return s.data=r,s}static from(r){const s=this.load(0);return s.geometryType=_.LW.MARKER,s.setVV(r,!1),s.data}getVariation(){return st(rt({},super.getVariation()),{vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}T.shared=new T(0);class x extends(p(M(h(c)))){static load(r){const s=this.shared;return s.data=r,s}static from(r,s){const i=this.load(0);return i.geometryType=_.LW.LINE,i.setVV(r,s),i.data}getVariation(){return st(rt({},super.getVariation()),{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}x.shared=new x(0);class O extends(p(M(m(h(c))))){static load(r){const s=this.shared;return s.data=r,s}static from(r){const s=this.load(r);return s.geometryType=_.LW.TEXT,s.setVV(r,!1),s.data}getVariation(){return st(rt({},super.getVariation()),{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}O.shared=new O(0);class V extends(h(c)){static load(r){const s=this.shared;return s.data=r,s}static from(r,s){const i=this.load(0);return i.geometryType=_.LW.LABEL,i.setVV(r,!1),i.mapAligned=(0,tt.N)(s),i.data}getVariation(){return st(rt({},super.getVariation()),{vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}V.shared=new V(0)},43281:(P,I,f)=>{function W(_){switch(_){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}f.d(I,{N:()=>W})},8244:(P,I,f)=>{f.r(I),f.d(I,{default:()=>et});var W=f(61921),_=f(60046),w=(f(22795),f(67474)),H=f(33870),b=f(60305),U=f(12523),J=(f(9077),f(57025),f(42442)),F=f(32699),N=f(56703),k=f(15049),X=f(89213),G=f(89883),Q=f(83704),Y=f(34238),$=f(38519),E=f(73331),z=f(59802);function C(l,u){return(!l.minScale||l.minScale>=u)&&(!l.maxScale||l.maxScale<=u)}function q(l){const u=l.message,d={message:{data:{},tileKey:u.tileKey,tileKeyOrigin:u.tileKeyOrigin},transferList:new Array};for(const c in u.data){const h=u.data[c];if(d.message.data[c]=null,(0,b.pC)(h)){const m=h.stride,p=h.indices.slice(0),M=h.vertices.slice(0),L=h.records.slice(0),T={stride:m,indices:p,vertices:M,records:L,metrics:(0,b.Po)(h.metrics,x=>x.slice(0))};d.transferList.push(p,M,L),d.message.data[c]=T}}return d}H.Z.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");let R=class extends E.Z{constructor(){super(...arguments),this.type="symbol",this._matchers={feature:null,aggregate:null},this._bufferData=new Map,this._bufferIds=new Map}initialize(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])}destroy(){}get supportsTileUpdates(){return!0}forEachBufferId(l){this._bufferIds.forEach(u=>{u.forEach(l)})}update(l,u){var d=this;return(0,W.Z)(function*(){const c=u.schema.processors[0];if("symbol"!==c.type)return;const h=(0,F.Hg)(d._schema,c);(0,F.uD)(h,"mesh")&&((0,w.Z)("esri-2d-update-debug")&&console.debug("Applying Update - Processor:",h),l.mesh=!0,l.why.mesh.push("Symbology changed"),d._schema=c,d._factory=d._createFactory(c),d._factory.update(c,d.tileStore.tileScheme.tileInfo))})()}onTileMessage(l,u,d,c){return(0,U.k_)(c),this._onTileData(l,u,d,c)}onTileClear(l){return this._bufferData.delete(l.key.id),this._bufferIds.delete(l.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:l.id,data:{clear:!0}})}onTileError(l,u,d){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:l.id,error:u},{signal:d.signal})}onTileUpdate(l){for(const u of l.removed)this._bufferData.has(u.key.id)&&this._bufferData.delete(u.key.id),this._bufferIds.has(u.key.id)&&this._bufferIds.delete(u.key.id);for(const u of l.added)this._bufferData.forEach(d=>{for(const c of d)c.message.tileKey===u.id&&this._updateTileMesh("append",u,q(c),[],!1,!1,null)})}_addBufferData(l,u){this._bufferData.has(l)||this._bufferData.set(l,[]),this._bufferData.get(l).push(q(u))}_createFactory(l){const{geometryType:u,objectIdField:d,fields:c}=this.service,m={geometryType:u,fields:c,spatialReference:N.Z.fromJSON(this.spatialReference)},p=new G.W((T,x)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",T,x),this.tileStore.tileScheme.tileInfo),{matcher:M,aggregateMatcher:L}=l.mesh;return this._store=p,this._matchers.feature=(0,Y.fL)(M,p,m),this._matchers.aggregate=(0,b.Po)(L,T=>(0,Y.fL)(T,p,m)),new X.j(u,d,p)}_onTileData(l,u,d,c){var h=this;return(0,W.Z)(function*(){(0,U.k_)(c);const{type:m,addOrUpdate:p,remove:M}=u,L=u.end,T=!!h._schema.mesh.sortKey;if(!p)return h.remoteClient.invoke("tileRenderer.onTileData",{tileKey:l.id,data:{type:m,addOrUpdate:null,remove:M,clear:!1,end:L,sort:T}},c);const x=h._processFeatures(l,p,d,c);try{const O=yield x;if((0,b.Wi)(O))return h.remoteClient.invoke("tileRenderer.onTileData",{tileKey:l.id,data:{type:m,addOrUpdate:null,remove:M,clear:!1,end:L,sort:T}},c);const V=[];for(const t of O){let r=!1;const s=t.message.bufferIds,i=l.key.id,n=t.message.tileKey;if(i!==n&&(0,b.pC)(s)){if(!h.tileStore.get(n))continue;let a=h._bufferIds.get(n);a||(a=new Set,h._bufferIds.set(n,a));const o=Array.from(s);for(const v of o){if(a.has(v)){r=!0;break}a.add(v)}}r||(h._addBufferData(i,t),V.push(t))}yield(0,U.$6)(V.map(t=>{const r=l.key.id===t.message.tileKey;return h._updateTileMesh(m,l,t,r?u.remove:[],r&&u.end,u.clear,c.signal)}))}catch(O){h._handleError(l,O,c)}})()}_updateTileMesh(l,u,d,c,h,m,p){var M=this;return(0,W.Z)(function*(){const L=l,T=d.message.tileKey,x=!!M._schema.mesh.sortKey;T!==u.key.id&&(h=!1);const O=(0,b.Po)(d,s=>s.message),V=(0,b.Po)(d,s=>s.transferList)||[],t={type:L,addOrUpdate:O,remove:c,clear:!1,end:h,sort:x},r={transferList:(0,b.Wg)(V)||[],signal:p};return(0,U.k_)(r),M.remoteClient.invoke("tileRenderer.onTileData",{tileKey:T,data:t},r)})()}_processFeatures(l,u,d,c){var h=this;return(0,W.Z)(function*(){if((0,b.Wi)(u)||!u.hasFeatures)return null;const m={transform:l.transform,hasZ:!1,hasM:!1},p=h._factory,M={viewingMode:"",scale:l.scale},L=yield h._matchers.feature,T=yield h._matchers.aggregate;(0,U.k_)(c);const x=h._getLabelInfos(l,u);return yield p.analyze(u.getCursor(),L,T,m,M),(0,U.k_)(c),h._writeFeatureSet(l,u,m,x,p,d)})()}_writeFeatureSet(l,u,d,c,h,m){const p=u.getSize(),L=new k._(l.key.id,{features:p,records:p,metrics:0},"simple"===this._schema.mesh.matcher.type&&this._schema.mesh.matcher.isDotDensity,m,!0),T={viewingMode:"",scale:l.scale},x=u.getCursor();for(;x.next();)try{const V=x.getDisplayId(),t=(0,b.pC)(c)?c.get(V):null;h.writeCursor(L,x,d,T,l.level,t)}catch(V){}return L.serialize(l.tileInfoView.tileInfo.isWrappable)}_handleError(l,u,d){if(!(0,U.D_)(u))return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:l.id,error:u.message},{signal:d.signal})}_getLabelingSchemaForScale(l){const u=this._schema.mesh.labels;if((0,b.Wi)(u))return null;if("subtype"===u.type){const c={type:"subtype",classes:{}};let h=!1;for(const m in u.classes){const p=u.classes[m].filter(M=>C(M,l.scale));h=h||!!p.length,c.classes[m]=p}return h?c:null}const d=u.classes.filter(c=>C(c,l.scale));return d.length?{type:"simple",classes:d}:null}_getLabels(l,u){if("subtype"===u.type){var d;const h=(0,b.s3)(this.service.subtypeField,"Expected to find subtype Field"),m=l.readAttribute(h);return null==m?[]:null!=(d=u.classes[m])?d:[]}return u.classes}_getLabelInfos(l,u){const d=this._getLabelingSchemaForScale(l);if((0,b.Wi)(d))return null;const c=new Map,h=u.getCursor();for(;h.next();){const m=h.getDisplayId(),p=[],M=(0,z.nE)(m),L=M&&1!==h.readAttribute("cluster_count")?"aggregate":"feature",T=this._getLabels(h,d);for(const x of T){if(x.target!==L)continue;const V=h.getStorage().getComputedStringAtIndex(M&&"feature"===L?h.readAttribute("referenceId"):m,x.fieldIndex);if(!V)continue;const t=(0,Q.E)(V.toString()),s=t[1];this._store.getMosaicItem(x.symbol,(0,$._)(t[0])).then(i=>{p[x.index]={glyphs:i.glyphMosaicItems,rtl:s,index:x.index}})}c.set(m,p)}return c}};R=(0,_._)([(0,J.j)("esri.views.2d.layers.features.processors.SymbolProcessor")],R);var et=R}}]);