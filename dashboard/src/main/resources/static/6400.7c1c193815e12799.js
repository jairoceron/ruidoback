"use strict";var H=Object.defineProperty,N=Object.defineProperties,X=Object.getOwnPropertyDescriptors,B=Object.getOwnPropertySymbols,Y=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable,Z=(E,c,i)=>c in E?H(E,c,{enumerable:!0,configurable:!0,writable:!0,value:i}):E[c]=i,A=(E,c)=>{for(var i in c||(c={}))Y.call(c,i)&&Z(E,i,c[i]);if(B)for(var i of B(c))k.call(c,i)&&Z(E,i,c[i]);return E},L=(E,c)=>N(E,X(c));(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[6400],{16400:(E,c,i)=>{i.r(c),i.d(c,{default:()=>V});var v=i(61921),T=i(22795),M=i(60305),O=i(52917),C=i(89096),j=i(90097),x=i(33820),U=i(32620),_=i(68310),I=i(44654),D=i(31378),h=i(99303),R=i(25808),q=i(26047),K=i(76009);const Q=C.Zn,G={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:C.Zn},$={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};function J(b){return(0,O.wp)(b)?null!=b.m:!!b.hasM}class V{constructor(){this._queryEngine=null,this._nextObjectId=null}destroy(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy(),this._queryEngine=this._requiredFields=this._fieldsIndex=this._createDefaultAttributes=null}load(e){var t=this;return(0,v.Z)(function*(){const n=[],{features:r}=e,o=t._inferLayerProperties(r,e.fields),u=e.fields||[],g=null!=e.hasM?e.hasM:o.hasM,m=null!=e.hasZ?e.hasZ:o.hasZ,d=!e.spatialReference&&!o.spatialReference,a=d?Q:e.spatialReference||o.spatialReference,l=d?G:null,y=e.geometryType||o.geometryType;let f=e.objectIdField||o.objectIdField,p=e.timeInfo;if(y&&(d&&n.push({name:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"}),!y))throw new T.Z("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");if(!f)throw new T.Z("feature-layer:missing-property","objectIdField not set and couldn't be found in the provided fields");if(o.objectIdField&&f!==o.objectIdField&&(n.push({name:"feature-layer:duplicated-oid-field",message:`Provided objectIdField "${f}" doesn't match the field name "${o.objectIdField}", found in the provided fields`}),f=o.objectIdField),f&&!o.objectIdField){let s=null;u.some(P=>P.name===f&&(s=P,!0))?(s.type="esriFieldTypeOID",s.editable=!1,s.nullable=!1):u.unshift({alias:f,name:f,type:"esriFieldTypeOID",editable:!1,nullable:!1})}for(const s of u){if(null==s.name&&(s.name=s.alias),null==s.alias&&(s.alias=s.name),!s.name)throw new T.Z("feature-layer:invalid-field-name","field name is missing",{field:s});if(s.name===f&&(s.type="esriFieldTypeOID"),-1===q.v.jsonValues.indexOf(s.type))throw new T.Z("feature-layer:invalid-field-type",`invalid type for field "${s.name}"`,{field:s})}const S={};t._requiredFields=[];for(const s of u)if("esriFieldTypeOID"!==s.type&&"esriFieldTypeGlobalID"!==s.type){s.editable=null==s.editable||!!s.editable,s.nullable=null==s.nullable||!!s.nullable;const P=(0,K.os)(s);s.nullable||void 0!==P?S[s.name]=P:t._requiredFields.push(s)}if(t._fieldsIndex=new R.Z(u),t._createDefaultAttributes=(0,D.Dm)(S,f),p){if(p.startTimeField){const s=t._fieldsIndex.get(p.startTimeField);s?(p.startTimeField=s.name,s.type="esriFieldTypeDate"):p.startTimeField=null}if(p.endTimeField){const s=t._fieldsIndex.get(p.endTimeField);s?(p.endTimeField=s.name,s.type="esriFieldTypeDate"):p.endTimeField=null}if(p.trackIdField){const s=t._fieldsIndex.get(p.trackIdField);s?p.trackIdField=s.name:(p.trackIdField=null,n.push({name:"feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:p}}))}p.startTimeField||p.endTimeField||(n.push({name:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:p}}),p=null)}const W={warnings:n,featureErrors:[],layerDefinition:L(A({},$),{drawingInfo:(0,D.bU)(y),templates:(0,D.Hq)(S),extent:l,geometryType:y,objectIdField:f,fields:u,hasZ:!!m,hasM:!!g,timeInfo:p}),assignedObjectIds:{}};if(t._queryEngine=new I.Z({fields:u,geometryType:y,hasM:g,hasZ:m,objectIdField:f,spatialReference:a,featureStore:new U.Z({geometryType:y,hasM:g,hasZ:m}),timeInfo:p,cacheSpatialQueries:!0}),!r||!r.length)return t._nextObjectId=x.X,W;const z=(0,x.S)(f,r);return t._nextObjectId=z+1,yield(0,_._W)(r,a),t._loadInitialFeatures(W,r)})()}applyEdits(e){var t=this;return(0,v.Z)(function*(){const{spatialReference:n,geometryType:r}=t._queryEngine;return yield Promise.all([(0,h.b)(n,r),(0,_._W)(e.adds,n),(0,_._W)(e.updates,n)]),t._applyEdits(e)})()}queryFeatures(e,t={}){return this._queryEngine.executeQuery(e,t.signal)}queryFeatureCount(e,t={}){return this._queryEngine.executeQueryForCount(e,t.signal)}queryObjectIds(e,t={}){return this._queryEngine.executeQueryForIds(e,t.signal)}queryExtent(e,t={}){return this._queryEngine.executeQueryForExtent(e,t.signal)}querySnapping(e,t={}){return this._queryEngine.executeQueryForSnapping(e,t.signal)}_inferLayerProperties(e,t){let n,r,o=null,u=null,g=null;for(const m of e){const d=m.geometry;if(!(0,M.Wi)(d)&&(o||(o=(0,O.Ji)(d)),u||(u=d.spatialReference),null==n&&(n=(0,O.wp)(b=d)?null!=b.z:!!b.hasZ),null==r&&(r=J(d)),o&&u&&null!=n&&null!=r))break}var b;if(t&&t.length){let m=null;t.some(d=>{const a="esriFieldTypeOID"===d.type,l=!d.type&&d.name&&"objectid"===d.name.toLowerCase();return m=d,a||l})&&(g=m.name)}return{geometryType:o,spatialReference:u,objectIdField:g,hasM:r,hasZ:n}}_loadInitialFeatures(e,t){const{geometryType:n,hasM:r,hasZ:o,objectIdField:u,spatialReference:g,featureStore:m}=this._queryEngine,d=[];for(const a of t){if(null!=a.uid&&(e.assignedObjectIds[a.uid]=-1),a.geometry&&n!==(0,O.Ji)(a.geometry)){e.featureErrors.push((0,h.av)("Incorrect geometry type."));continue}const l=this._createDefaultAttributes(),y=(0,h.O0)(this._fieldsIndex,l,a.attributes,this._requiredFields,!0,e.warnings);y?e.featureErrors.push(y):(this._assignObjectId(l,a.attributes,!0),a.attributes=l,null!=a.uid&&(e.assignedObjectIds[a.uid]=a.attributes[u]),(0,M.pC)(a.geometry)&&(a.geometry=(0,_.iV)(a.geometry,a.geometry.spatialReference,g)),d.push(a))}if(m.addMany((0,j.Yn)([],d,n,o,r,u)),e.layerDefinition.extent=this._queryEngine.fullExtent,e.layerDefinition.timeInfo){const{start:a,end:l}=this._queryEngine.timeExtent;e.layerDefinition.timeInfo.timeExtent=[a,l]}return e}_applyEdits(e){const{adds:t,updates:n,deletes:r}=e,o={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(t&&t.length&&this._applyAddEdits(o,t),n&&n.length&&this._applyUpdateEdits(o,n),r&&r.length){for(const u of r)o.deleteResults.push((0,h.d1)(u));this._queryEngine.featureStore.removeManyById(r)}return{fullExtent:this._queryEngine.fullExtent,featureEditResults:o}}_applyAddEdits(e,t){const{addResults:n}=e,{geometryType:r,hasM:o,hasZ:u,objectIdField:g,spatialReference:m,featureStore:d}=this._queryEngine,a=[];for(const l of t){if(l.geometry&&r!==(0,O.Ji)(l.geometry)){n.push((0,h.av)("Incorrect geometry type."));continue}const y=this._createDefaultAttributes(),F=(0,h.O0)(this._fieldsIndex,y,l.attributes,this._requiredFields);F?n.push(F):(this._assignObjectId(y,l.attributes),l.attributes=y,null!=l.uid&&(e.uidToObjectId[l.uid]=l.attributes[g]),(0,M.pC)(l.geometry)&&(l.geometry=(0,_.iV)((0,h.og)(l.geometry,m),l.geometry.spatialReference,m)),a.push(l),n.push((0,h.d1)(l.attributes[g])))}d.addMany((0,j.Yn)([],a,r,u,o,g))}_applyUpdateEdits({updateResults:e},t){const{geometryType:n,hasM:r,hasZ:o,objectIdField:u,spatialReference:g,featureStore:m}=this._queryEngine;for(const d of t){const{attributes:a,geometry:l}=d,y=a&&a[u];if(null==y){e.push((0,h.av)(`Identifier field ${u} missing`));continue}if(!m.has(y)){e.push((0,h.av)(`Feature with object id ${y} missing`));continue}const F=(0,j.EI)(m.getFeature(y),n,o,r);if((0,M.pC)(l)){if(n!==(0,O.Ji)(l)){e.push((0,h.av)("Incorrect geometry type."));continue}F.geometry=(0,_.iV)((0,h.og)(l,g),l.spatialReference,g)}if(a){const f=(0,h.O0)(this._fieldsIndex,F.attributes,a,this._requiredFields);if(f){e.push(f);continue}}m.add((0,j.XA)(F,n,o,r,u)),e.push((0,h.d1)(y))}}_assignObjectId(e,t,n=!1){const r=this._queryEngine.objectIdField;e[r]=n&&t&&isFinite(t[r])?t[r]:this._nextObjectId++}}},31378:(E,c,i)=>{i.d(c,{MS:()=>U,Dm:()=>j,Hq:()=>x,bU:()=>C});var v=i(67474),T=i(85071),M=i(26729),O=i(21984);function C(_){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===_||"esriGeometryMultipoint"===_?O.I4:"esriGeometryPolyline"===_?O.ET:O.lF}}}function j(_,I){if((0,v.Z)("csp-restrictions"))return()=>A({[I]:null},_);try{let D=`this.${I} = null;`;for(const R in _)D+=`this${R.indexOf(".")?`["${R}"]`:`.${R}`} = ${JSON.stringify(_[R])};`;const h=new Function(D);return()=>new h}catch(D){return()=>A({[I]:null},_)}}function x(_={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,T.d9)(_)}}]}function U(_,I){return{attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:_},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:I,supportsDelete:I,supportsEditing:I,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:I,supportsExceedsLimitStatistics:!0},query:M.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0},editing:{supportsGeometryUpdate:I,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}}}]);