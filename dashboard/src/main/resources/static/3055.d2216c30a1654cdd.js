"use strict";var ae=Object.defineProperty,le=Object.defineProperties,ie=Object.getOwnPropertyDescriptors,q=Object.getOwnPropertySymbols,ue=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable,k=(E,v,n)=>v in E?ae(E,v,{enumerable:!0,configurable:!0,writable:!0,value:n}):E[v]=n,W=(E,v)=>{for(var n in v||(v={}))ue.call(v,n)&&k(E,n,v[n]);if(q)for(var n of q(v))de.call(v,n)&&k(E,n,v[n]);return E},ee=(E,v)=>le(E,ie(v));(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[3055,3446],{83055:(E,v,n)=>{n.d(v,{V:()=>te});var m=n(61921),c=n(60046),M=n(40662),f=n(22795),K=(n(67474),n(33870)),U=n(60305),b=n(12523),I=n(89225),h=n(9077),P=(n(57025),n(67424)),w=n(42442),D=n(43190),T=n(64526),R=n(82059),L=n(9446),O=n(56703),F=n(38192),G=n(99737),a=n(62803),i=n(93112),g=n(45608),x=n(50898),Z=n(93653),$=n(93446);function N(p,l,t){return j.apply(this,arguments)}function j(){return(j=(0,m.Z)(function*(p,l,t){if(!l||!l.resources)return;const e=l.portalItem===p.portalItem?new Set(p.paths):new Set;p.paths.length=0,p.portalItem=l.portalItem;const o=new Set(l.resources.toKeep.map(d=>d.resource.path)),s=new Set,r=[];o.forEach(d=>{e.delete(d),p.paths.push(d)});for(const d of l.resources.toUpdate)if(e.delete(d.resource.path),o.has(d.resource.path)||s.has(d.resource.path)){const{resource:B,content:oe,finish:ne,error:se}=d,Y=(0,$.getSiblingOfSameTypeI)(B,(0,Z.D)());p.paths.push(Y.path),r.push(z({resource:Y,content:oe,finish:ne,error:se},t))}else p.paths.push(d.resource.path),r.push(V(d,t)),s.add(d.resource.path);for(const d of l.resources.toAdd)r.push(z(d,t)),p.paths.push(d.resource.path);if(e.forEach(d=>{const B=l.portalItem.resourceFromPath(d);r.push(B.portalItem.removeResource(B).catch(()=>{}))}),0===r.length)return;const u=yield(0,b.as)(r);(0,b.k_)(t);const y=u.filter(d=>"error"in d).map(d=>d.error);if(y.length>0)throw new f.Z("save:resources","Failed to save one or more resources",{errors:y})})).apply(this,arguments)}function z(p,l){return S.apply(this,arguments)}function S(){return(S=(0,m.Z)(function*(p,l){const t=yield(0,x.q6)(p.resource.portalItem.addResource(p.resource,p.content,l));if(!0!==t.ok)throw p.error&&p.error(t.error),t.error;p.finish&&p.finish(p.resource)})).apply(this,arguments)}function V(p,l){return J.apply(this,arguments)}function J(){return(J=(0,m.Z)(function*(p,l){const t=yield(0,x.q6)(p.resource.update(p.content,l));if(!0!==t.ok)throw p.error(t.error),t.error;p.finish(p.resource)})).apply(this,arguments)}const A=K.Z.getLogger("esri.layers.mixins.SceneService"),te=p=>{let l=class extends p{constructor(){var t;super(...arguments),t=this,this.spatialReference=null,this.fullExtent=null,this.heightModelInfo=null,this.minScale=0,this.maxScale=0,this.version={major:Number.NaN,minor:Number.NaN,versionString:""},this.copyright=null,this.sublayerTitleMode="item-title",this.title=null,this.layerId=null,this.indexInfo=null,this._debouncedSaveOperations=(0,b.Ds)(function(){var e=(0,m.Z)(function*(o,s,r){switch(o){case 0:return t._save(s);case 1:return t._saveAs(r,s)}});return function(o,s,r){return e.apply(this,arguments)}}())}readSpatialReference(t,e){return this._readSpatialReference(e)}_readSpatialReference(t){if(null!=t.spatialReference)return O.Z.fromJSON(t.spatialReference);{const e=t.store,o=e.indexCRS||e.geographicCRS,s=o&&parseInt(o.substring(o.lastIndexOf("/")+1,o.length),10);return null!=s?new O.Z(s):null}}readFullExtent(t,e,o){if(null!=t&&"object"==typeof t){const u=null==t.spatialReference?ee(W({},t),{spatialReference:this._readSpatialReference(e)}):t;return R.Z.fromJSON(u,o)}const s=e.store,r=this._readSpatialReference(e);return null==r||null==s||null==s.extent||!Array.isArray(s.extent)||s.extent.some(u=>u<Q)?null:new R.Z({xmin:s.extent[0],ymin:s.extent[1],xmax:s.extent[2],ymax:s.extent[3],spatialReference:r})}readVersion(t,e){const o=e.store,s=null!=o.version?o.version.toString():"",r={major:Number.NaN,minor:Number.NaN,versionString:s},u=s.split(".");return u.length>=2&&(r.major=parseInt(u[0],10),r.minor=parseInt(u[1],10)),r}readTitlePortalItem(t){return"item-title"!==this.sublayerTitleMode?void 0:t}readTitleService(t,e){const o=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return(0,F.a7)(this.url,e.name);let s=e.name;if(!s&&this.url){const r=(0,F.Qc)(this.url);(0,U.pC)(r)&&(s=r.title)}return"item-title-and-service-name"===this.sublayerTitleMode&&o&&(s=o+" - "+s),(0,F.ld)(s)}set url(t){const e=(0,F.XG)({layer:this,url:t,nonStandardUrlAllowed:!1,logger:A});this._set("url",e.url),null!=e.layerId&&this._set("layerId",e.layerId)}writeUrl(t,e,o,s){(0,F.wH)(this,t,"layers",e,s)}get parsedUrl(){const t=this._get("url");if(!t)return null;const e=(0,I.mN)(t);return null!=this.layerId&&(e.path=`${e.path}/layers/${this.layerId}`),e}_fetchIndexAndUpdateExtent(t,e){var o=this;return(0,m.Z)(function*(){o.indexInfo=(0,a.T)(o.parsedUrl.path,o.rootNode,t,o.apiKey,A,e),null==o.fullExtent||o.fullExtent.hasZ||o._updateExtent(yield o.indexInfo)})()}_updateExtent(t){if("page"===(null==t?void 0:t.type)){var e,o;const r=t.rootIndex%t.pageSize,u=null==(e=t.rootPage)||null==(o=e.nodes)?void 0:o[r];if(null==u||null==u.obb||null==u.obb.center||null==u.obb.halfSize)throw new f.Z("sceneservice:invalid-node-page","Invalid node page.");if(u.obb.center[0]<Q||null==this.fullExtent||this.fullExtent.hasZ)return;const y=u.obb.halfSize,d=u.obb.center[2],B=Math.sqrt(y[0]*y[0]+y[1]*y[1]+y[2]*y[2]);this.fullExtent.zmin=d-B,this.fullExtent.zmax=d+B}else if("node"===(null==t?void 0:t.type)){var s;const r=null==(s=t.rootNode)?void 0:s.mbs;if(!Array.isArray(r)||4!==r.length||r[0]<Q)return;const u=r[2],y=r[3];this.fullExtent.zmin=u-y,this.fullExtent.zmax=u+y}}_fetchService(t){var e=this;return(0,m.Z)(function*(){if(null==e.url)throw new f.Z("sceneservice:url-not-set","Scene service can not be loaded without valid portal item or url");if(null==e.layerId&&/SceneServer\/*$/i.test(e.url)){const o=yield e._fetchFirstLayerId(t);null!=o&&(e.layerId=o)}return e._fetchServiceLayer(t)})()}_fetchFirstLayerId(t){var e=this;return(0,m.Z)(function*(){const o=yield(0,M.default)(e.url,{query:{f:"json",token:e.apiKey},responseType:"json",signal:t});if(o.data&&Array.isArray(o.data.layers)&&o.data.layers.length>0)return o.data.layers[0].id})()}_fetchServiceLayer(t){var e=this;return(0,m.Z)(function*(){const o=yield(0,M.default)(e.parsedUrl.path,{query:{f:"json",token:e.apiKey},responseType:"json",signal:t});o.ssl&&(e.url=e.url.replace(/^http:/i,"https:"));const s=o.data;e.read(s,{origin:"service",url:e.parsedUrl}),e.validateLayer(s)})()}_ensureLoadBeforeSave(){var t=this;return(0,m.Z)(function*(){yield t.load(),"beforeSave"in t&&"function"==typeof t.beforeSave&&(yield t.beforeSave())})()}validateLayer(t){}_updateTypeKeywords(t,e,o){t.typeKeywords||(t.typeKeywords=[]);const s=e.getTypeKeywords();for(const r of s)t.typeKeywords.push(r);t.typeKeywords&&(t.typeKeywords=t.typeKeywords.filter((r,u,y)=>y.indexOf(r)===u),1===o&&(t.typeKeywords=t.typeKeywords.filter(r=>"Hosted Service"!==r)))}_saveAs(t,e){var o=this;return(0,m.Z)(function*(){const s=W(W({},X),e);let r=g.default.from(t);r||(A.error("_saveAs(): requires a portal item parameter"),yield Promise.reject(new f.Z("sceneservice:portal-item-required","_saveAs() requires a portal item to save to"))),r.id&&(r=r.clone(),r.id=null);const u=r.portal||i.Z.getDefault();yield o._ensureLoadBeforeSave(),r.type=H,r.portal=u;const y={origin:"portal-item",url:null,messages:[],portal:u,portalItem:r,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},d={layers:[o.write(null,y)]};return yield Promise.all(y.resources.pendingOperations),yield o._validateAgainstJSONSchema(d,y,s),r.url=o.url,r.title||(r.title=o.title),o._updateTypeKeywords(r,s,1),yield u._signIn(),yield u.user.addItem({item:r,folder:s&&s.folder,data:d}),yield N(o.resourceReferences,y,null),o.portalItem=r,(0,T.D)(y),y.portalItem=r,r})()}_save(t){var e=this;return(0,m.Z)(function*(){const o=W(W({},X),t);e.portalItem||(A.error("_save(): requires the .portalItem property to be set"),yield Promise.reject(new f.Z("sceneservice:portal-item-not-set","Portal item to save to has not been set on this SceneService"))),e.portalItem.type!==H&&(A.error("_save(): Non-matching portal item type. Got "+e.portalItem.type+", expected "+H),yield Promise.reject(new f.Z("sceneservice:portal-item-wrong-type",`Portal item needs to have type "${H}"`))),yield e._ensureLoadBeforeSave();const s={origin:"portal-item",url:e.portalItem.itemUrl&&(0,I.mN)(e.portalItem.itemUrl),messages:[],portal:e.portalItem.portal||i.Z.getDefault(),portalItem:e.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},r={layers:[e.write(null,s)]};return yield Promise.all(s.resources.pendingOperations),yield e._validateAgainstJSONSchema(r,s,o),e.portalItem.url=e.url,e.portalItem.title||(e.portalItem.title=e.title),e._updateTypeKeywords(e.portalItem,o,0),yield e.portalItem.update({data:r}),yield N(e.resourceReferences,s,null),(0,T.D)(s),e.portalItem})()}_validateAgainstJSONSchema(t,e,o){return(0,m.Z)(function*(){let s=e.messages.filter(r=>"error"===r.type).map(r=>new f.Z(r.name,r.message,r.details));if(o&&o.validationOptions.ignoreUnsupported&&(s=s.filter(r=>"layer:unsupported"!==r.name&&"symbol:unsupported"!==r.name&&"symbol-layer:unsupported"!==r.name&&"property:unsupported"!==r.name&&"url:unsupported"!==r.name&&"scenemodification:unsupported"!==r.name)),o.validationOptions.enabled||re){const r=(yield n.e(7285).then(n.bind(n,77285))).validate(t,o.portalItemLayerType);if(r.length>0){const u=`Layer item did not validate:\n${r.join("\n")}`;if(A.error(`_validateAgainstJSONSchema(): ${u}`),"throw"===o.validationOptions.failPolicy){const y=r.map(d=>new f.Z("sceneservice:schema-validation",d)).concat(s);throw new f.Z("sceneservice-validate:error","Failed to save layer item due to schema validation, see `details.errors`.",{combined:y})}}}if(s.length>0)throw new f.Z("sceneservice:save","Failed to save SceneService due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:s})})()}};return(0,c._)([(0,h.Cb)(G.id)],l.prototype,"id",void 0),(0,c._)([(0,h.Cb)({type:O.Z})],l.prototype,"spatialReference",void 0),(0,c._)([(0,P.r)("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],l.prototype,"readSpatialReference",null),(0,c._)([(0,h.Cb)({type:R.Z})],l.prototype,"fullExtent",void 0),(0,c._)([(0,P.r)("fullExtent",["fullExtent","store.extent","spatialReference","store.indexCRS","store.geographicCRS"])],l.prototype,"readFullExtent",null),(0,c._)([(0,h.Cb)({readOnly:!0,type:L.Z})],l.prototype,"heightModelInfo",void 0),(0,c._)([(0,h.Cb)({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:{source:"minScale"},write:!1}}}})],l.prototype,"minScale",void 0),(0,c._)([(0,h.Cb)({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:{source:"maxScale"},write:!1}}}})],l.prototype,"maxScale",void 0),(0,c._)([(0,h.Cb)({readOnly:!0})],l.prototype,"version",void 0),(0,c._)([(0,P.r)("version",["store.version"])],l.prototype,"readVersion",null),(0,c._)([(0,h.Cb)({type:String,json:{read:{source:"copyrightText"}}})],l.prototype,"copyright",void 0),(0,c._)([(0,h.Cb)({type:String,json:{read:!1}})],l.prototype,"sublayerTitleMode",void 0),(0,c._)([(0,h.Cb)({type:String})],l.prototype,"title",void 0),(0,c._)([(0,P.r)("portal-item","title")],l.prototype,"readTitlePortalItem",null),(0,c._)([(0,P.r)("service","title",["name"])],l.prototype,"readTitleService",null),(0,c._)([(0,h.Cb)({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{write:{target:"id",isRequired:!0,ignoreOrigin:!0},read:!1}}}})],l.prototype,"layerId",void 0),(0,c._)([(0,h.Cb)(G.HQ)],l.prototype,"url",null),(0,c._)([(0,D.c)("url")],l.prototype,"writeUrl",null),(0,c._)([(0,h.Cb)()],l.prototype,"parsedUrl",null),(0,c._)([(0,h.Cb)({readOnly:!0})],l.prototype,"store",void 0),(0,c._)([(0,h.Cb)({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],l.prototype,"rootNode",void 0),l=(0,c._)([(0,w.j)("esri.layers.mixins.SceneService")],l),l},Q=-1e38,re=!1,H="Scene Service",X={getTypeKeywords:()=>[],portalItemLayerType:"unknown",validationOptions:{enabled:!0,ignoreUnsupported:!1,failPolicy:"throw"}}},62803:(E,v,n)=>{n.d(v,{T:()=>_});var m=n(61921),c=n(40662),M=n(22795),f=n(60305);function _(U,b,I,h,C,P){return K.apply(this,arguments)}function K(){return(K=(0,m.Z)(function*(U,b,I,h,C,P){let w=null;if((0,f.pC)(I)){const R=`${U}/nodepages/`,L=R+Math.floor(I.rootIndex/I.nodesPerPage);try{return{type:"page",rootPage:(yield(0,c.default)(L,{query:{f:"json",token:h},responseType:"json",signal:P})).data,rootIndex:I.rootIndex,pageSize:I.nodesPerPage,lodMetric:I.lodSelectionMetricType,urlPrefix:R}}catch(O){(0,f.pC)(C)&&C.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",L,O),w=O}}if(!b)return null;const D=`${U}/nodes/`,T=D+(b&&b.split("/").pop());try{return{type:"node",rootNode:(yield(0,c.default)(T,{query:{f:"json",token:h},responseType:"json",signal:P})).data,urlPrefix:D}}catch(R){throw new M.Z("sceneservice:root-node-missing","Root node missing.",{pageError:w,nodeError:R,url:T})}})).apply(this,arguments)}},93446:(E,v,n)=>{n.r(v),n.d(v,{addOrUpdateResource:()=>b,contentToBlob:()=>L,fetchResources:()=>K,getSiblingOfSameType:()=>F,getSiblingOfSameTypeI:()=>G,removeAllResources:()=>P,removeResource:()=>h,splitPrefixFileNameAndExtension:()=>T});var m=n(61921),c=n(40662),M=n(22795),f=n(60305),_=n(89225);function K(a){return U.apply(this,arguments)}function U(){return(U=(0,m.Z)(function*(a,i={},g){yield a.load(g);const x=(0,_.v_)(a.itemUrl,"resources"),{start:Z=1,num:$=10,sortOrder:N="asc",sortField:j="created"}=i,z={query:{start:Z,num:$,sortOrder:N,sortField:j,token:a.apiKey},signal:(0,f.U2)(g,"signal")},S=yield a.portal._request(x,z);return{total:S.total,nextStart:S.nextStart,resources:S.resources.map(({created:V,size:J,resource:A})=>({created:new Date(V),size:J,resource:a.resourceFromPath(A)}))}})).apply(this,arguments)}function b(a,i,g,x){return I.apply(this,arguments)}function I(){return(I=(0,m.Z)(function*(a,i,g,x){if(!a.hasPath())throw new M.Z(`portal-item-resource-${i}:invalid-path`,"Resource does not have a valid path");const Z=a.portalItem;yield Z.load(x);const $=(0,_.v_)(Z.userItemUrl,"add"===i?"addResources":"updateResources"),[N,j]=D(a.path),z=yield L(g),S=new FormData;return N&&"."!==N&&S.append("resourcesPrefix",N),S.append("fileName",j),S.append("file",z,j),S.append("f","json"),(0,f.pC)(x)&&x.access&&S.append("access",x.access),yield Z.portal._request($,{method:"post",body:S,signal:(0,f.U2)(x,"signal")}),a})).apply(this,arguments)}function h(a,i,g){return C.apply(this,arguments)}function C(){return(C=(0,m.Z)(function*(a,i,g){if(!i.hasPath())throw new M.Z("portal-item-resources-remove:invalid-path","Resource does not have a valid path");yield a.load(g);const x=(0,_.v_)(a.userItemUrl,"removeResources");yield a.portal._request(x,{method:"post",query:{resource:i.path},signal:(0,f.U2)(g,"signal")}),i.portalItem=null})).apply(this,arguments)}function P(a,i){return w.apply(this,arguments)}function w(){return(w=(0,m.Z)(function*(a,i){yield a.load(i);const g=(0,_.v_)(a.userItemUrl,"removeResources");return a.portal._request(g,{method:"post",query:{deleteAll:!0},signal:(0,f.U2)(i,"signal")})})).apply(this,arguments)}function D(a){const i=a.lastIndexOf("/");return-1===i?[".",a]:[a.slice(0,i),a.slice(i+1)]}function T(a){const[i,g]=function(a){const i=(0,_.Ml)(a);return(0,f.Wi)(i)?[a,""]:[a.slice(0,a.length-i.length-1),`.${i}`]}(a),[x,Z]=D(i);return[x,Z,g]}function L(a){return O.apply(this,arguments)}function O(){return(O=(0,m.Z)(function*(a){return a instanceof Blob?a:(yield(0,c.default)(a.url,{responseType:"blob"})).data})).apply(this,arguments)}function F(a,i){if(!a.hasPath())return null;const[g,,x]=T(a.path);return a.portalItem.resourceFromPath((0,_.v_)(g,i+x))}function G(a,i){if(!a.hasPath())return null;const[g,,x]=T(a.path);return a.portalItem.resourceFromPath((0,_.v_)(g,i+x))}}}]);