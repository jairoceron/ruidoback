"use strict";var Ie=Object.defineProperty,Oe=Object.defineProperties,Be=Object.getOwnPropertyDescriptors,Le=Object.getOwnPropertySymbols,De=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable,Re=(fe,H,d)=>H in fe?Ie(fe,H,{enumerable:!0,configurable:!0,writable:!0,value:d}):fe[H]=d,he=(fe,H)=>{for(var d in H||(H={}))De.call(H,d)&&Re(fe,d,H[d]);if(Le)for(var d of Le(H))Ue.call(H,d)&&Re(fe,d,H[d]);return fe},be=(fe,H)=>Oe(fe,Be(H));(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[5691],{43392:(fe,H,d)=>{d.d(H,{F:()=>U,M:()=>C});const C={Base64:0,Hex:1,String:2,Raw:3};function B(a,_){const r=(65535&a)+(65535&_);return(a>>16)+(_>>16)+(r>>16)<<16|65535&r}function J(a,_,r,i,t,u){return B(function(a,_){return a<<_|a>>>32-_}(B(B(_,a),B(i,u)),t),r)}function W(a,_,r,i,t,u,f){return J(_&r|~_&i,a,_,t,u,f)}function N(a,_,r,i,t,u,f){return J(_&i|r&~i,a,_,t,u,f)}function V(a,_,r,i,t,u,f){return J(_^r^i,a,_,t,u,f)}function E(a,_,r,i,t,u,f){return J(r^(_|~i),a,_,t,u,f)}function U(a,_=C.Hex){const r=_||C.Base64,i=function(a,_){a[_>>5]|=128<<_%32,a[14+(_+64>>>9<<4)]=_;let r=1732584193,i=-271733879,t=-1732584194,u=271733878;for(let f=0;f<a.length;f+=16){const b=r,D=i,g=t,l=u;r=W(r,i,t,u,a[f+0],7,-680876936),u=W(u,r,i,t,a[f+1],12,-389564586),t=W(t,u,r,i,a[f+2],17,606105819),i=W(i,t,u,r,a[f+3],22,-1044525330),r=W(r,i,t,u,a[f+4],7,-176418897),u=W(u,r,i,t,a[f+5],12,1200080426),t=W(t,u,r,i,a[f+6],17,-1473231341),i=W(i,t,u,r,a[f+7],22,-45705983),r=W(r,i,t,u,a[f+8],7,1770035416),u=W(u,r,i,t,a[f+9],12,-1958414417),t=W(t,u,r,i,a[f+10],17,-42063),i=W(i,t,u,r,a[f+11],22,-1990404162),r=W(r,i,t,u,a[f+12],7,1804603682),u=W(u,r,i,t,a[f+13],12,-40341101),t=W(t,u,r,i,a[f+14],17,-1502002290),i=W(i,t,u,r,a[f+15],22,1236535329),r=N(r,i,t,u,a[f+1],5,-165796510),u=N(u,r,i,t,a[f+6],9,-1069501632),t=N(t,u,r,i,a[f+11],14,643717713),i=N(i,t,u,r,a[f+0],20,-373897302),r=N(r,i,t,u,a[f+5],5,-701558691),u=N(u,r,i,t,a[f+10],9,38016083),t=N(t,u,r,i,a[f+15],14,-660478335),i=N(i,t,u,r,a[f+4],20,-405537848),r=N(r,i,t,u,a[f+9],5,568446438),u=N(u,r,i,t,a[f+14],9,-1019803690),t=N(t,u,r,i,a[f+3],14,-187363961),i=N(i,t,u,r,a[f+8],20,1163531501),r=N(r,i,t,u,a[f+13],5,-1444681467),u=N(u,r,i,t,a[f+2],9,-51403784),t=N(t,u,r,i,a[f+7],14,1735328473),i=N(i,t,u,r,a[f+12],20,-1926607734),r=V(r,i,t,u,a[f+5],4,-378558),u=V(u,r,i,t,a[f+8],11,-2022574463),t=V(t,u,r,i,a[f+11],16,1839030562),i=V(i,t,u,r,a[f+14],23,-35309556),r=V(r,i,t,u,a[f+1],4,-1530992060),u=V(u,r,i,t,a[f+4],11,1272893353),t=V(t,u,r,i,a[f+7],16,-155497632),i=V(i,t,u,r,a[f+10],23,-1094730640),r=V(r,i,t,u,a[f+13],4,681279174),u=V(u,r,i,t,a[f+0],11,-358537222),t=V(t,u,r,i,a[f+3],16,-722521979),i=V(i,t,u,r,a[f+6],23,76029189),r=V(r,i,t,u,a[f+9],4,-640364487),u=V(u,r,i,t,a[f+12],11,-421815835),t=V(t,u,r,i,a[f+15],16,530742520),i=V(i,t,u,r,a[f+2],23,-995338651),r=E(r,i,t,u,a[f+0],6,-198630844),u=E(u,r,i,t,a[f+7],10,1126891415),t=E(t,u,r,i,a[f+14],15,-1416354905),i=E(i,t,u,r,a[f+5],21,-57434055),r=E(r,i,t,u,a[f+12],6,1700485571),u=E(u,r,i,t,a[f+3],10,-1894986606),t=E(t,u,r,i,a[f+10],15,-1051523),i=E(i,t,u,r,a[f+1],21,-2054922799),r=E(r,i,t,u,a[f+8],6,1873313359),u=E(u,r,i,t,a[f+15],10,-30611744),t=E(t,u,r,i,a[f+6],15,-1560198380),i=E(i,t,u,r,a[f+13],21,1309151649),r=E(r,i,t,u,a[f+4],6,-145523070),u=E(u,r,i,t,a[f+11],10,-1120210379),t=E(t,u,r,i,a[f+2],15,718787259),i=E(i,t,u,r,a[f+9],21,-343485551),r=B(r,b),i=B(i,D),t=B(t,g),u=B(u,l)}return[r,i,t,u]}(function(a){const _=[];for(let r=0,i=8*a.length;r<i;r+=8)_[r>>5]|=(255&a.charCodeAt(r/8))<<r%32;return _}(a),8*a.length);switch(r){case C.Raw:return i;case C.Hex:return function(a){const _="0123456789abcdef",r=[];for(let i=0,t=4*a.length;i<t;i++)r.push(_.charAt(a[i>>2]>>i%4*8+4&15)+_.charAt(a[i>>2]>>i%4*8&15));return r.join("")}(i);case C.String:return function(a){const _=[];for(let r=0,i=32*a.length;r<i;r+=8)_.push(String.fromCharCode(a[r>>5]>>>r%32&255));return _.join("")}(i);case C.Base64:return function(a){const i=[];for(let t=0,u=4*a.length;t<u;t+=3){const f=(a[t>>2]>>t%4*8&255)<<16|(a[t+1>>2]>>(t+1)%4*8&255)<<8|a[t+2>>2]>>(t+2)%4*8&255;for(let b=0;b<4;b++)i.push(8*t+6*b>32*a.length?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(f>>6*(3-b)&63))}return i.join("")}(i)}}},75335:(fe,H,d)=>{var C,R,T;function O(T){switch(T){case"left":return C.Left;case"right":return C.Right;case"center":case"justify":return C.Center}}function B(T){switch(T){case"top":return R.Top;case"middle":return R.Center;case"baseline":return R.Baseline;case"bottom":return R.Bottom}}function ae(T){switch(T){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[C.Right,R.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[C.Center,R.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[C.Left,R.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[C.Right,R.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":return[C.Center,R.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[C.Left,R.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[C.Right,R.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[C.Center,R.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[C.Left,R.Top];case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[C.Center,R.Baseline];default:return console.debug(`Found invalid placement type ${T}`),[C.Center,R.Center]}}function S(T){switch(T){case C.Right:return-1;case C.Center:return 0;case C.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${T}`),0}}function Y(T){switch(T){case R.Top:return 1;case R.Center:return 0;case R.Bottom:case R.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${T}`),0}}function k(T){switch(T){case"left":return C.Left;case"right":return C.Right;case"center":case"justify":return C.Center}}d.d(H,{TR:()=>R,qv:()=>ae,Hd:()=>k,kH:()=>O,g:()=>S,b7:()=>B,tf:()=>Y}),(T=C||(C={}))[T.Left=-1]="Left",T[T.Center=0]="Center",T[T.Right=1]="Right",function(T){T[T.Top=1]="Top",T[T.Center=0]="Center",T[T.Bottom=-1]="Bottom",T[T.Baseline=2]="Baseline"}(R||(R={}))},45880:(fe,H,d)=>{d.d(H,{Nr:()=>D});var C=d(97209),R=d(62764),O=d(87492),B=d(3878),ae=d(75335),S=d(1452),Y=d(36392),k=d(22791);class T{constructor(l,e,o,c){this.center=(0,B.f)(l,e),this.centerT=(0,B.c)(),this.halfWidth=o/2,this.halfHeight=c/2,this.width=o,this.height=c}get x(){return this.center[0]}get y(){return this.center[1]}get blX(){return this.center[0]+this.halfWidth}get blY(){return this.center[1]+this.halfHeight}get trX(){return this.center[0]-this.halfWidth}get trY(){return this.center[1]-this.halfHeight}get xmin(){return this.x-this.halfWidth}get xmax(){return this.x+this.halfWidth}get ymin(){return this.y-this.halfHeight}get ymax(){return this.y+this.halfHeight}set x(l){this.center[0]=l}set y(l){this.center[1]=l}clone(){return new T(this.x,this.y,this.width,this.height)}serialize(l){return l.writeF32(this.center[0]),l.writeF32(this.center[1]),l.push(this.width),l.push(this.height),l}findCollisionDelta(l,e=4){const o=Math.abs(l.centerT[0]-this.centerT[0]),c=Math.abs(l.centerT[1]-this.centerT[1]),L=Math.min((l.halfWidth+this.halfWidth+e)/o,(l.halfHeight+this.halfHeight+e)/c);return(0,k.k3)(L)}extend(l){const e=Math.min(this.xmin,l.xmin),o=Math.min(this.ymin,l.ymin),c=Math.max(this.xmax,l.xmax)-e,m=Math.max(this.ymax,l.ymax)-o,y=e+c/2,L=o+m/2;this.width=c,this.height=m,this.halfWidth=c/2,this.halfHeight=m/2,this.x=y,this.y=L}static deserialize(l){const e=l.readF32(),o=l.readF32(),c=l.readInt32(),m=l.readInt32();return new T(e,o,c,m)}}const U=Math.PI/180;class a{constructor(l,e,o,c){this._rotationT=(0,R.c)(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const m=o.rect,y=new Float32Array(8);e*=c;const L=o.code?m.width*c:o.metrics.width,j=o.code?m.height*c:o.metrics.height;y[0]=l*=c,y[1]=e,y[2]=l+L,y[3]=e,y[4]=l,y[5]=e+j,y[6]=l+L,y[7]=e+j,this._data=y,this._setTextureCoords(m),this._scale=c,this._mosaic=o,this.x=l,this.y=e,this.maxOffset=Math.max(l+L,e+j)}get width(){return this._mosaic.metrics.width*this._scale}get mosaic(){return this._mosaic}set angle(l){this._angle=l,(0,C.i)(this._rotationT),(0,C.r)(this._rotationT,this._rotationT,-l),this._setOffsets(this._data)}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(this._data),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:l,width:e}=this._mosaic.metrics,o=e*this._scale,c=Math.abs(l)*this._scale,m=new Float32Array(8);m[0]=this.x,m[1]=this.y,m[2]=this.x+o,m[3]=this.y,m[4]=this.x,m[5]=this.y+c,m[6]=this.x+o,m[7]=this.y+c;const y=(0,C.m)((0,R.c)(),this._rotationT,this._T);(0,R.t)(m,m,y);let L=1/0,j=1/0,z=0,ne=0;for(let le=0;le<4;le++){const ce=m[2*le],x=m[2*le+1];L=Math.min(L,ce),j=Math.min(j,x),z=Math.max(z,ce),ne=Math.max(ne,x)}const ye=z-L,ie=ne-j;this._bounds=new T(L+ye/2,j+ie/2,ye,ie)}return this._bounds}setTransform(l){this._T=l,this._offsets=null}_setOffsets(l){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const e=this._offsets,o=new Float32Array(8),c=(0,C.m)((0,R.c)(),this._rotationT,this._T);(0,R.t)(o,l,c),e.upperLeft=(0,S.UJ)(8*o[0],8*o[1]),e.upperRight=(0,S.UJ)(8*o[2],8*o[3]),e.lowerLeft=(0,S.UJ)(8*o[4],8*o[5]),e.lowerRight=(0,S.UJ)(8*o[6],8*o[7])}_setTextureCoords({x:l,y:e,width:o,height:c}){this._texcoords={upperLeft:(0,S.UJ)(l,e),upperRight:(0,S.UJ)(l+o,e),lowerLeft:(0,S.UJ)(l,e+c),lowerRight:(0,S.UJ)(l+o,e+c)}}}const _=(g,l)=>({code:0,page:0,sdf:!0,rect:new Y.Z(0,0,11,8),textureBinding:l,metrics:{advance:0,height:4,width:g,left:0,top:0}});class r{constructor(l,e,o){this._rotation=0,this._decorate(l,e,o),this.glyphs=l,this.bounds=this._createBounds(l),this.isMultiline=e.length>1,this._hasRotation=0!==o.angle,this._T=this._createGlyphTransform(this.bounds,o);for(const c of l)c.setTransform(this._T)}setRotation(l){if(0===l&&0===this._rotation)return;this._rotation=l;const e=this._T,o=(0,C.b)((0,R.c)(),l);(0,C.m)(e,o,e);for(const c of this.glyphs)c.setTransform(this._T)}_decorate(l,e,o){if(!o.decoration||"none"===o.decoration||!l.length)return;const c=o.scale,m="underline"===o.decoration?30:20,y=l[0].textureBinding;for(const L of e)l.push(new a(L.startX*c,L.startY*c+m*c,_((L.width+L.glyphWidthEnd)*c,y),1))}get boundsT(){const l=this.bounds,e=(0,O.s)((0,B.c)(),l.x,l.y);if((0,O.t)(e,e,this._T),this._hasRotation){const o=Math.max(l.width,l.height);return new T(e[0],e[1],o,o)}return new T(e[0],e[1],l.width,l.height)}_createBounds(l){let e=1/0,o=1/0,c=0,m=0;for(const j of l)e=Math.min(e,j.xTopLeft),o=Math.min(o,j.yTopLeft),c=Math.max(c,j.xTopLeft+j.width),m=Math.max(m,j.yBottomRight);const y=c-e,L=m-o;return new T(e+y/2,o+L/2,y,L)}_createGlyphTransform(l,e){const o=U*e.angle,c=(0,R.c)(),m=(0,B.c)();return(0,C.t)(c,c,(0,O.s)(m,e.xOffset,-e.yOffset)),e.isCIM?(0,C.r)(c,c,o):((0,C.t)(c,c,(0,O.s)(m,l.x,l.y)),(0,C.r)(c,c,o),(0,C.t)(c,c,(0,O.s)(m,-l.x,-l.y))),c}}class i{constructor(l,e,o,c,m,y){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(e,o)),this.end=Math.max(0,Math.max(e,o)),this.end<l.length&&(this.glyphWidthEnd=l[this.end].metrics.width),this.width=c,this.yMin=m,this.yMax=y}}const t=g=>10===g,u=g=>32===g;function D(g,l,e){const o=e.scale,c=new Array,m=function(g,l,e){const o=new Array,m=e.maxLineWidth*(1/e.scale),y=l?g.length-1:0,L=l?-1:g.length,j=l?-1:1;let z=y,ne=0,ye=0,ie=z,Me=ie,Ee=0,le=1/0,ce=0;for(;z!==L;){const{code:v,metrics:P}=g[z],w=Math.abs(P.top);t(v)||u(v)||(le=Math.min(le,w),ce=Math.max(ce,w+P.height)),t(v)?(z!==y&&(o.push(new i(g,ie,z-j,ne,le,ce)),le=1/0,ce=0),ne=0,ie=z+j,Me=z+j,ye=0):u(v)?(Me=z+j,ye=0,Ee=P.advance,ne+=P.advance):ne>m?(Me!==ie?(ne-=Ee,o.push(new i(g,ie,Me-2*j,ne-ye,le,ce)),le=1/0,ce=0,ie=Me,ne=ye):(o.push(new i(g,ie,z-j,ne,le,ce)),le=1/0,ce=0,ie=z,Me=z,ne=0),ne+=P.advance,ye+=P.advance):(ne+=P.advance,ye+=P.advance),z+=j}const x=new i(g,ie,z-j,ne,le,ce);return x.start>=0&&x.end<g.length&&o.push(x),o}(g,l,e),y=function(g,l){let e=0;for(let m=0;m<g.length;m++){const{width:y}=g[m];e=Math.max(y,e)}const c=g[0].yMin;return{x:0,y:c,height:g[g.length-1].yMax+l.lineHeight*(g.length-1)+("underline"===l.decoration?4:0)-c,width:e}}(m,e),{vAlign:L,hAlign:j}=e,z=L===ae.TR.Baseline?1:0,ye=(1-z)*-y.y+y.height/2*(z?0:L-1)+-26*(z?1:0);for(let ie=0;ie<m.length;ie++){const{start:Me,end:Ee,width:le}=m[ie];let ce=-1*(j+1)*(le/2)-3;const x=ie*e.lineHeight+ye-3;m[ie].startX=ce,m[ie].startY=x;for(let v=Me;v<=Ee;v++){const P=g[v];if(t(P.code))continue;const w=new a(ce+P.metrics.left,x-P.metrics.top,P,o);ce+=P.metrics.advance,c.push(w)}}return new r(c,m,e)}},83704:(fe,H,d)=>{d.d(H,{E:()=>O});const R=new(d(64455).Z);function O(B){if(!R.hasBidiChar(B))return[B,!1];let ae;return ae="rtl"===R.checkContextual(B)?"IDNNN":"ICNNN",[R.bidiTransform(B,ae,"VLYSN"),!0]}},15691:(fe,H,d)=>{d.d(H,{MD:()=>$,Ew:()=>Me,PY:()=>m}),d(76138),d(45594),d(12205),d(39196),d(32800);var S=d(66771),T=(d(32320),d(38750),d(22795)),J=d(67474),W=d(85071),N=d(33870),V=d(60305),E=d(12788),I=d(68957),U=d(38963),a=d(20547),_=d(21194),r=d(96054),t=d(2967),u=d(57538),f=d(54188),b=d(28621);const D=N.Z.getLogger("esri.views.2d.layers.features.schemaUtils"),g="ValidationError",l={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};function e(s){return(0,_.hF)(s)}function c(s){var h;return"line-marker"===s.type?{type:"line-marker",color:null==(h=s.color)?void 0:h.toJSON(),placement:s.placement,style:s.style}:(0,I.i)(s.toJSON()).toJSON()}function m(s,h,n){if(!s)return null;let p=0,M=!1,F=0;switch((0,V.pC)(h)&&(F=(0,t.J)(h),"visualVariables"in h&&(p=function(s){if(!s)return U.X.NONE;let h=0;for(const n of s)if("size"===n.type){const p=(0,r.a)(n);h|=p,"outline"===n.target&&(h|=p<<4)}else"color"===n.type?h|=U.X.COLOR:"opacity"===n.type?h|=U.X.OPACITY:"rotation"===n.type&&(h|=U.X.ROTATION);return h}(h.visualVariables||[]),M="dot-density"===h.type)),s.type){case"simple-fill":case"picture-fill":return function(s,h,n,p){const M=(0,_.jj)(U.LW.FILL,h,!1,n),F=p?e(M):M,A=s.clone(),Z=A.outline;A.outline=null;const X=[],re=he({materialKey:F,hash:A.hash()},c(A));if(X.push(re),Z){const me=(0,_.jj)(U.LW.LINE,h,!0,!1),ge=he({materialKey:p?e(me):me,hash:Z.hash()},c(Z));X.push(ge)}return{type:"composite-symbol",layers:X,hash:X.reduce((me,ge)=>ge.hash+me,"")}}(s,p,M,n);case"simple-marker":case"picture-marker":return function(s,h,n,p){const M=(0,_.jj)(U.LW.MARKER,h,!1,!1),F=p?e(M):M,A=c(s);return be(he({materialKey:F,hash:s.hash()},A),{angle:s.angle,maxVVSize:n})}(s,p,F,n);case"simple-line":return function(s,h,n){const p=(0,_.jj)(U.LW.LINE,h,!1,!1),M=n?e(p):p,F=s.clone(),A=F.marker;F.marker=null;const Z=[];if(Z.push(he({materialKey:M,hash:F.hash()},c(F))),A){var X;const re=(0,_.jj)(U.LW.MARKER,h,!1,!1),me=n?e(re):re;A.color=null!=(X=A.color)?X:F.color,Z.push(he({materialKey:me,hash:A.hash(),lineWidth:F.width},c(A)))}return{type:"composite-symbol",layers:Z,hash:Z.reduce((re,me)=>me.hash+re,"")}}(s,p,n);case"text":return function(s,h,n,p){const M=(0,_.jj)(U.LW.TEXT,h,!1,!1),F=p?e(M):M,A=c(s);return be(he({materialKey:F,hash:s.hash()},A),{angle:s.angle,maxVVSize:n})}(s,p,F,n);case"label":return function(s,h,n){const p=s.toJSON(),M=(0,_.jj)(U.LW.LABEL,h,!1,!1,p.labelPlacement);return be(he({materialKey:n?e(M):M,hash:s.hash()},p),{labelPlacement:p.labelPlacement})}(s,p,n);case"cim":return{type:"cim",rendererKey:p,data:s.data,maxVVSize:F};case"web-style":return be(he({},c(s)),{type:"web-style",hash:s.hash(),rendererKey:p,maxVVSize:F});default:throw new Error(`symbol not supported ${s.type}`)}}function ye(s,h){const n=(0,W.d9)(s);return n.some(p=>function(s,h){const n=s.labelPlacement,p=l[h];if(!s.symbol)return D.warn("No ILabelClass symbol specified."),!0;if(!p)return D.error(new T.Z("mapview-labeling:unsupported-geometry-type",`Unable to create labels for Feature Layer, ${h} is not supported`)),!0;if(!p.some(M=>M===n)){const M=p[0];n&&D.warn(`Found invalid label placement type ${n} for ${h}. Defaulting to ${M}`),s.labelPlacement=M}return!1}(p,h))?[]:n}function Me(s){return(0,J.Z)("esri-2d-update-debug")&&console.debug("Created new schema",Ee(s,!0)),Ee(s)}function Ee(s,h=!1){try{var n,p;const M=function(s,h=!1){const n=new Array;return n.push(function(s,h,n=!1){const p={indexCount:0,fields:{}},M="featureReduction"in s&&s.featureReduction,F=M?"aggregate":"feature";if("sublayers"in s){const A={type:"subtype",subtypeField:s.subtypeField,renderers:{}},Z={type:"subtype",mapping:{},target:"feature"},X={type:"subtype",classes:{}},re={type:"symbol",target:"feature",aggregateFields:[],attributes:p,storage:Z,mesh:{matcher:A,aggregateMatcher:null,labels:X,sortKey:null}},me=new Set;let ge=0;for(const{renderer:xe,subtypeCode:_e,labelingInfo:Pe,labelsVisible:Fe}of s.sublayers){const Te=$(p,F,xe,n),Se=K(p,F,xe),Ce=Fe&&Pe;if("visualVariables"in xe&&xe.visualVariables&&xe.visualVariables.length)throw new T.Z(g,"Visual variables are currently not supported for subtype layers");if("dictionary"===Te.type)throw new T.Z(g,"Dictionary renderer is not supported in subtype layers");if("subtype"===Te.type)throw new T.Z(g,"Nested subtype renderers is not supported");if((0,V.pC)(Se)&&"subtype"===Se.type)throw new T.Z(g,"Nested subtype storage is not supported");if((0,V.pC)(Se)&&"dot-density"===Se.type)throw new T.Z(g,"Dot density attributes are not supported in subtype layers");if(me.has(_e))throw new T.Z(g,"Subtype codes for sublayers must be unique");me.add(_e),A.renderers[_e]=Te,Z.mapping[_e]=Se,Ce&&(X.classes[_e]=Ce.map(ze=>Q(xe,p,ze,"feature",ge++,n)))}return re}if("heatmap"===s.renderer.type){const{blurRadius:A,fieldOffset:Z,field:X}=s.renderer;return{type:"heatmap",aggregateFields:[],attributes:p,target:F,storage:null,mesh:{blurRadius:A,fieldOffset:Z,field:w(p,{target:F,field:X,resultType:"numeric"}).field}}}{const A=[],Z="aggregate"===F?(0,f.S1)(A,s.renderer,M,null):s.renderer;!function(s,h){const n={mesh:!0,storage:!0};for(const p of h){const{name:M,outStatistic:F}=p,{statisticType:A,onStatisticField:Z}=F;let X=null,re=null,me=null;const ge="numeric",xe="feature";"onStatisticValueExpression"in F?re=G(s,{type:"expression",target:xe,valueExpression:F.onStatisticValueExpression,resultType:ge}).fieldIndex:"onStatisticNormalizationField"in F?(X=G(s,{type:"field",target:xe,field:Z,resultType:ge}).field,me=F.onStatisticNormalizationField):X=G(s,{type:"field",target:xe,field:Z,resultType:ge}).field,G(s,{type:"statistic",target:"aggregate",name:M,context:n,inField:X,inNormalizationField:me,inFieldIndex:re,statisticType:A})}}(p,A);const X=$(p,F,Z,n);let re=null;const me=K(p,F,Z),ge=(0,b.o)(s.geometryType);let xe=s.labelsVisible&&s.labelingInfo||[],_e=[];if(M){if("selection"===M.type)throw new T.Z(g,"Mapview does not support `selection` reduction type",M);if(M.symbol){const Se=new S.Z({symbol:M.symbol,visualVariables:"visualVariables"in Z?Z.visualVariables:null});re=$(p,F,Se,n)}_e=M&&M.labelsVisible&&M.labelingInfo||[]}xe=ye(xe,ge),_e=ye(_e,ge);let Pe=0;const Fe=[...xe.map(Se=>Q(Z,p,Se,"feature",Pe++,n)),..._e.map(Se=>Q(Z,p,Se,"aggregate",Pe++,n))],Te=function(s,h){if((0,V.Wi)(h)||!h.length)return null;h.length>1&&D.warn(`Layer rendering currently only supports ordering by 1 orderByInfo, but found ${h.length}. All but the first will be discarded`);const n=h[0],p="ascending"===n.order?"asc":"desc";return n.field?{field:n.field,order:p}:n.valueExpression?{fieldIndex:G(s,{type:"expression",target:"feature",valueExpression:n.valueExpression,resultType:"numeric"}).fieldIndex,order:p}:(D.error(new T.Z(g,"Expected to find a field or valueExpression for OrderByInfo",n)),null)}(p,s.orderBy);return{type:"symbol",target:F,attributes:p,aggregateFields:A,storage:me,mesh:{matcher:X,labels:{type:"simple",classes:Fe},aggregateMatcher:re,sortKey:Te}}}}(s)),n}(s,h),F={};return M.map(A=>function(s,h,n){switch(n.target){case"feature":return void v(s,x(h),n);case"aggregate":{if(!("featureReduction"in h))return;const p=h.featureReduction;if("selection"===p.type)throw new T.Z(g,"Mapview does not support `selection` reduction type",p);return v(s,x(h),n),void function(s,h,n){s.aggregate||(s.aggregate={name:"aggregate",input:"feature",filters:null,attributes:{},params:{clusterRadius:(0,E.F2)(h.clusterRadius/2),clusterPixelBuffer:64*Math.ceil((0,E.F2)(h.clusterMaxSize)/64),fields:n.aggregateFields}}),ce(s.aggregate,n.attributes.fields)}(s,p,n)}}}(F,s,A)),{source:{definitionExpression:s.definitionExpression,fields:s.fields.map(A=>A.toJSON()),gdbVersion:s.gdbVersion,historicMoment:null==(n=s.historicMoment)?void 0:n.getTime(),outFields:s.availableFields,pixelBuffer:s.pixelBuffer,spatialReference:s.spatialReference.toJSON(),timeExtent:null==(p=s.timeExtent)?void 0:p.toJSON(),customParameters:s.customParameters},attributes:{fields:{},indexCount:0},processors:M,targets:F}}catch(M){if(M.fieldName===g)return D.error(M),null;throw M}}function ce(s,h){for(const n in h){const p=h[n];if(p.target!==s.name)continue;const M=s.attributes[n];M?(M.context.mesh=M.context.mesh||p.context.mesh,M.context.storage=M.context.storage||p.context.storage):s.attributes[n]=p}return s}function x(s){var h,n,p,M,F;return[null!=(h=null==(n=s.filter)?void 0:n.toJSON())?h:null,null!=(p=null==(M=s.effect)||null==(F=M.filter)?void 0:F.toJSON())?p:null]}function v(s,h,n){return s.feature||(s.feature={name:"feature",input:"source",filters:h,attributes:{}}),ce(s.feature,n.attributes.fields),s}function w(s,h){return h.field?G(s,be(he({},h),{type:"field",field:h.field})):h.valueExpression?G(s,be(he({},h),{type:"expression",valueExpression:h.valueExpression})):{field:null,fieldIndex:null}}function G(s,h){switch(h.type){case"expression":{const n=h.valueExpression;if(!s.fields[n]){const p=s.indexCount++;s.fields[n]=be(he({},h),{name:n,fieldIndex:p})}return{fieldIndex:s.fields[n].fieldIndex}}case"label-expression":{const n=JSON.stringify(h.label);if(!s.fields[n]){const p=s.indexCount++;s.fields[n]=be(he({},h),{name:n,fieldIndex:p})}return{fieldIndex:s.fields[n].fieldIndex}}case"field":{const n=h.field;return"aggregate"===h.target&&s.fields[n]||(s.fields[n]=be(he({},h),{name:n})),{field:n}}case"statistic":return s.fields[h.name]=he({},h),{field:h.name}}}function Q(s,h,n,p,M,F=!1){const A=G(h,{type:"label-expression",target:p,context:{mesh:!0},resultType:"string",label:{labelExpression:n.labelExpression,labelExpressionInfo:n.labelExpressionInfo?{expression:n.labelExpressionInfo.expression}:null,symbol:!!n.symbol,where:n.where}}),{fieldIndex:Z}=A;return be(he({},m(n,s,F)),{fieldIndex:Z,target:p,index:M})}function K(s,h,n){switch(n.type){case"dot-density":return function(s,h,n){return n&&n.length?{type:"dot-density",mapping:n.map((p,M)=>{const{field:F,fieldIndex:A}=w(s,{valueExpression:p.valueExpression,field:p.field,resultType:"numeric",target:h});return{binding:M,field:F,fieldIndex:A}}),target:h}:{type:"dot-density",mapping:[],target:h}}(s,h,n.attributes);case"simple":case"class-breaks":case"unique-value":case"dictionary":return function(s,h,n){if(!n||!n.length)return{type:"visual-variable",mapping:[],target:h};const p={storage:!0},M="numeric";return{type:"visual-variable",mapping:(0,u.t)(n).map(F=>{var A;const Z=(0,a.nU)(F.type),{field:X,fieldIndex:re}=w(s,{target:h,valueExpression:F.valueExpression,field:F.field,context:p,resultType:M});switch(F.type){case"size":return"$view.scale"===F.valueExpression?null:{type:"size",binding:Z,field:X,fieldIndex:re,normalizationField:w(s,{target:h,field:F.normalizationField,context:p,resultType:M}).field,valueRepresentation:null!=(A=F.valueRepresentation)?A:null};case"color":return{type:"color",binding:Z,field:X,fieldIndex:re,normalizationField:w(s,{target:h,field:F.normalizationField,context:p,resultType:M}).field};case"opacity":return{type:"opacity",binding:Z,field:X,fieldIndex:re,normalizationField:w(s,{target:h,field:F.normalizationField,context:p,resultType:M}).field};case"rotation":return{type:"rotation",binding:Z,field:X,fieldIndex:re}}}).filter(F=>F),target:h}}(s,h,n.visualVariables);case"heatmap":return null}}function $(s,h,n,p=!1){const M=(0,V.Pt)(s,{indexCount:0,fields:{}});switch(n.type){case"simple":case"dot-density":return function(s,h,n,p=!1){const M=h.getSymbols();return{type:"simple",symbol:m(M.length?M[0]:null,h,p),isDotDensity:n}}(0,n,"dot-density"===n.type,p);case"class-breaks":return function(s,h,n,p=!1){const F=n.backgroundFillSymbol,{field:A,fieldIndex:Z}=w(s,{target:h,field:n.field,valueExpression:n.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}}),X=n.normalizationType,re="log"===X?"esriNormalizeByLog":"percent-of-total"===X?"esriNormalizeByPercentOfTotal":"field"===X?"esriNormalizeByField":null,me=n.classBreakInfos.map(ge=>({symbol:m(ge.symbol,n,p),min:ge.minValue,max:ge.maxValue})).sort((ge,xe)=>ge.min-xe.min);return{type:"interval",attributes:s.fields,field:A,fieldIndex:Z,backgroundFillSymbol:m(F,n,p),defaultSymbol:m(n.defaultSymbol,n,p),intervals:me,normalizationField:n.normalizationField,normalizationTotal:n.normalizationTotal,normalizationType:re,isMaxInclusive:n.isMaxInclusive}}(M,h,n,p);case"unique-value":return function(s,h,n,p=!1){const M=[],F=n.backgroundFillSymbol,A={target:h,context:{mesh:!0},resultType:"string"};if(n.field&&"string"!=typeof n.field)throw new T.Z(g,"Expected renderer.field to be a string",n);const{field:Z,fieldIndex:X}=w(s,be(he({},A),{field:n.field,valueExpression:n.valueExpression}));for(const re of n.uniqueValueInfos)M.push({value:""+re.value,symbol:m(re.symbol,n,p)});return{type:"map",attributes:s.fields,field:Z,fieldIndex:X,field2:w(s,be(he({},A),{field:n.field2})).field,field3:w(s,be(he({},A),{field:n.field3})).field,fieldDelimiter:n.fieldDelimiter,backgroundFillSymbol:m(F,n),defaultSymbol:m(n.defaultSymbol,n),map:M}}(M,h,n,p);case"dictionary":return function(s,h,n=!1){return{type:"dictionary",renderer:h.toJSON()}}(0,n,p)}}},2967:(fe,H,d)=>{d.d(H,{G:()=>W,J:()=>T});var C=d(61921),R=d(12788),O=d(79391),B=d(35779),ae=d(99155),S=d(31888);const Y={"simple-marker":1,"picture-marker":1,text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1};function T(b){if(!("visualVariables"in b)||!b.hasVisualVariables("size"))return 0;const D=b.getVisualVariablesForType("size");if(!D[0])return 0;const g=D[0];if("outline"===g.target)return 0;if("stops"===g.transformationType)return g.stops.map(l=>l.size).reduce(f,0);if("clamped-linear"===g.transformationType){let l=-1/0,e=-1/0;return l="number"==typeof g.maxSize?g.maxSize:g.maxSize.stops.map(o=>o.size).reduce(f,0),e="number"==typeof g.minSize?g.minSize:g.minSize.stops.map(o=>o.size).reduce(f,0),Math.max(l,e)}return"real-world-size"===g.transformationType?30:void 0}function J(b){return b.type in Y}function W(b,D,g){return N.apply(this,arguments)}function N(){return(N=(0,C.Z)(function*(b,D,g){if(!b||g&&"cluster"===g.type)return 0;if("heatmap"===b.type)return Math.round(3*b.blurRadius);if("dot-density"===b.type)return 0;if("dictionary"===b.type)return"esriGeometryPoint"===D||"esriGeometryMultipoint"===D?100:200;const l=b.getSymbols(),e=T(b),o=[];for(const m of l)o.push(i(m,e));const c=yield Promise.all(o);return(0,R.F2)(c.reduce(f,0))})).apply(this,arguments)}const V=[0,0,0,0];function E(b,D){return null==b?D:b}function I(b,D){return null==b.outline?D:E(b.outline.width,D)}const U={sdf:!0,code:99,metrics:ae.eF.metrics,rect:new B.Z(0,0,24,24),page:0,textureBinding:2};function a(b){const D=b.text&&b.text.length;if(!D)return{glyphMosaicItems:[U]};const g=[];for(let l=0;l<D;l++)g.push(be(he({},U),{code:b.text.charCodeAt(l)}));return{glyphMosaicItems:g}}function _(b,D){return r.apply(this,arguments)}function r(){return(r=(0,C.Z)(function*(b,D){if("simple-marker"===b.type){const g=Math.max(E(b.size,12),D);return u(b)+.707*g}if("picture-marker"===b.type){const g=Math.max(E(b.height,12),D),l=E(b.width,12)*(g/E(b.height,12))/2,e=g/2;return u(b)+Math.sqrt(l*l+e*e)}if("text"===b.type){const g=a(b);(0,S.Q2)(V,b.toJSON(),g);const l=Math.abs(V[0]),e=Math.abs(V[1]),o=V[2],c=V[3];return Math.max(l,e)+Math.max(o,c)}if("simple-line"===b.type){const g=b,l=Math.max(E(g.width,.75),D)/2;return g.marker?Math.max(6*g.width,2*D):l}if("simple-fill"===b.type||"picture-fill"===b.type)return Math.max(I(b,0),D)/2;if("cim"===b.type){const g=O.B$.getEnvelope(b.data);return g?Math.sqrt(g.width*g.width+g.height*g.height):0}return"web-style"===b.type?_(yield b.fetchCIMSymbol(),D):0})).apply(this,arguments)}function i(b,D){return t.apply(this,arguments)}function t(){return(t=(0,C.Z)(function*(b,D){return J(b)?Math.min(yield _(b,D),75):0})).apply(this,arguments)}function u(b){const D=E(b.xoffset,0),g=E(b.yoffset,0);return Math.sqrt(D*D+g*g)}function f(b,D){return Math.max(b,D)}},57538:(fe,H,d)=>{d.d(H,{a:()=>S,t:()=>Y});var C=d(33870),R=d(12788);const ae=C.Z.getLogger("esri.renderers.visualVariables.support.utils"),S=E=>{if(!("visualVariables"in E)||!E.visualVariables||!E.visualVariables.length)return E;const I=E.clone(),U=I.visualVariables.map(a=>k(a)?T(a):a);return I.visualVariables=U,I};function Y(E){return E.map(I=>k(I)?T(I.clone()):I)}function k(E){return("size"===E.type||"color"===E.type||"opacity"===E.type)&&null!=E.stops}function T(E){return E.stops=function(E,I){return I.length<=8?I:(ae.warn(`Found ${I.length} Visual Variable stops, but MapView only supports 8. Displayed stops will be simplified.`),I.length>16?function(E,I){const[U,...a]=I,_=a.pop(),r=a[0].value,i=a[a.length-1].value,t=(i-r)/6,u=[];for(let f=r;f<i;f+=t){let b=0;for(;f>=a[b].value;)b++;const D=a[b],g=I[b-1],l=f-g.value,e=D.value===g.value?1:l/(D.value-g.value);if("color"===E){const o=a[b],c=I[b-1],m=o.color.clone();m.r=J(c.color.r,m.r,e),m.g=J(c.color.g,m.g,e),m.b=J(c.color.b,m.b,e),m.a=J(c.color.a,m.a,e),u.push({value:f,color:m,label:o.label})}else if("size"===E){const o=a[b],c=I[b-1],m=(0,R.t_)(o.size),y=J((0,R.t_)(c.size),m,e);u.push({value:f,size:y,label:o.label})}else{const o=a[b],c=J(I[b-1].opacity,o.opacity,e);u.push({value:f,opacity:c,label:o.label})}}return[U,...u,_]}(E,I):function(E){const[I,...U]=E,a=U.pop();for(;U.length>6;){let _=0,r=0;for(let i=1;i<U.length;i++){const f=Math.abs(U[i].value-U[i-1].value);f>r&&(r=f,_=i)}U.splice(_,1)}return[I,...U,a]}(I))}(E.type,E.stops),E}function J(E,I,U){return(1-U)*E+U*I}},31888:(fe,H,d)=>{d.d(H,{y1:()=>f,I_:()=>u,zX:()=>D,oD:()=>ie,Il:()=>ye,Zw:()=>Me,Q2:()=>le,eT:()=>e,Zu:()=>b,yA:()=>l,nl:()=>ne,ab:()=>g}),d(67474);var R=d(60305),O=d(12788),B=d(97209),ae=d(62764),S=d(87492),Y=d(3878),k=d(13638),T=d(25481),J=d(52917),W=d(62354),N=d(93722),V=d(89096),E=d(79391),I=d(75335),U=d(45880),a=d(83704);const _=Math.PI/180,r=.04,i=(0,ae.c)(),t=(0,Y.c)(),u=512,f=50;function b(x,v){if(!v.isWrappable)return null;const[P,w]=(0,N.uS)(v);return x[2]>w?[(0,k.Ue)([x[0],x[1],w,x[3]]),(0,k.Ue)([P,x[1],P+x[2]-w,x[3]])]:x[0]<P?[(0,k.Ue)([P,x[1],x[2],x[3]]),(0,k.Ue)([w-(P-x[0]),x[1],w,x[3]])]:null}function D(x,v,P,w,G,se,Q){if(!w||!P.symbol)return x[0]=x[1]=x[2]=x[3]=0,v[0]=v[1]=v[2]=v[3]=0,x;const q=w;if(!(0,J.wp)(q)){(0,T.$P)(x,q);let ee=v[0];0===ee&&(ee=Ee(P),v[0]=ee);const oe=G*ee/2;return x[0]-=oe,x[1]-=oe,x[2]+=oe,x[3]+=oe,x}{const ee=q.x,oe=q.y;"esriTS"===P.symbol.type&&0===v[2]&&0===v[3]&&le(v,P.symbol,P.mosaicItem),function(x,v,P,w,G,se,Q,q){let ee;switch(w.type){case"esriSMS":case"esriPMS":ee=ye(v,P,w,se,Q,0);break;case"esriTS":ee=Me(v,P,w,G,se,0);break;case"cim":case"CIMSymbolReference":case"expanded-cim":ee=ie(v,P,w,se,Q,0)}let oe,K,de=0;for(let ue=0;ue<ee.rings[0].length-1;ue++)K=ee.rings[0][ue],oe=(v-K[0])*(v-K[0])+(P-K[1])*(P-K[1]),de=Math.max(de,oe);de=Math.sqrt(de);let te=(0,W.or)(v-de,q),$=(0,W.or)(v+de,q);if(te>$){const ue=(0,V.C5)(q);if(ue){const[ve,pe]=ue.valid;te=ve,$=pe}}x[0]=te,x[1]=P-de,x[2]=$,x[3]=P+de}(x,ee,oe,P.symbol,v,G,se,Q)}return x}function g(x){return"text"===x||"esriTS"===x}function l(x){return"simple-marker"===x||"picture-marker"===x||"esriSMS"===x||"esriPMS"===x}function e(x){switch((0,R.Wg)(x.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0}const o=(0,Y.c)(),c=(0,Y.c)(),m=(0,Y.c)(),y=(0,Y.c)(),L=(0,Y.c)(),j=(0,Y.c)(),z=(0,Y.c)();function ne(x,v,P,w){(0,S.s)(m,v,P);const G=x.paths;let se,Q,q,ee,oe,K,de,te,$,ue=1/0;for(let ve=0;ve<G.length;ve++){const pe=G[ve];if(!(pe.length<2))for(let we=1;we<pe.length;we++)se=pe[we-1][0],q=pe[we-1][1],Q=pe[we][0],ee=pe[we][1],oe=Math.min(se,Q)-w,K=Math.min(q,ee)-w,de=Math.max(se,Q)+w,te=Math.max(q,ee)+w,v<oe||v>de||P<K||P>te||((0,S.s)(o,se,q),(0,S.s)(c,Q,ee),(0,S.a)(y,c,o),(0,S.a)(L,o,m),(0,S.b)(j,y,(0,S.h)(y,L)/(0,S.h)(y,y)),(0,S.a)(z,L,j),$=(0,S.h)(z,z),ue>$&&(ue=$))}return Math.sqrt(ue)<=w}function ye(x,v,P,w,G,se){let Q,q;const ee=(0,O.F2)(P.xoffset),oe=(0,O.F2)(P.yoffset),K=_*P.angle,de=_*se;switch(P.type){case"esriSMS":Q=q=(0,O.F2)(P.size);break;case"esriPMS":Q=(0,O.F2)(P.width),q=(0,O.F2)(P.height)}G<r&&(w=r*w/G);const te=(0,B.i)(i);(0,B.t)(te,te,(0,S.s)(t,x,v)),(0,B.r)(te,te,de-K),(0,B.s)(te,te,(0,S.s)(t,w,-w)),(0,B.t)(te,te,(0,S.s)(t,ee,-oe));const $=[0,0];(0,S.t)($,(0,S.s)(t,-.5*Q,-.5*q),te);const ue=[0,0];(0,S.t)(ue,(0,S.s)(t,-.5*Q,.5*q),te);const ve=[0,0];(0,S.t)(ve,(0,S.s)(t,.5*Q,-.5*q),te);const pe=[0,0];return(0,S.t)(pe,(0,S.s)(t,.5*Q,.5*q),te),{rings:[[$,ve,pe,ue,$]]}}function ie(x,v,P,w,G,se){const Q=E.B$.getEnvelope(P.data);if(!Q)return null;G<r&&(w=r*w/G);const q=(0,O.F2)(Q.width),ee=(0,O.F2)(Q.height),oe=(0,O.F2)(Q.x),K=(0,O.F2)(Q.y),de=0*_,te=_*se,$=(0,B.i)(i);(0,B.t)($,$,(0,S.s)(t,x,v)),(0,B.r)($,$,te-de),(0,B.s)($,$,(0,S.s)(t,w,w));const ue=[0,0];(0,S.t)(ue,(0,S.s)(t,oe,K+ee),$);const ve=[0,0];(0,S.t)(ve,(0,S.s)(t,oe,K),$);const pe=[0,0];(0,S.t)(pe,(0,S.s)(t,oe+q,K+ee),$);const we=[0,0];return(0,S.t)(we,(0,S.s)(t,oe+q,K),$),{rings:[[ue,pe,we,ve,ue]]}}function Me(x,v,P,w,G,se){const Q=(0,O.F2)(P.xoffset),q=(0,O.F2)(P.yoffset),ee=_*P.angle,oe=_*se,K=(0,B.i)(i);(0,B.t)(K,K,(0,S.s)(t,x,v)),(0,B.r)(K,K,oe),(0,B.s)(K,K,(0,S.s)(t,G,-G));const de=w[0]+w[2]/2,te=w[1]+w[3]/2;(0,B.t)(K,K,(0,S.s)(t,Q,-q)),(0,B.t)(K,K,(0,S.s)(t,de,te)),(0,B.r)(K,K,ee),(0,B.t)(K,K,(0,S.s)(t,-de,-te));const $=[0,0];(0,S.t)($,(0,S.s)(t,w[0],w[1]),K);const ue=[0,0];(0,S.t)(ue,(0,S.s)(t,w[0],w[1]+w[3]),K);const ve=[0,0];(0,S.t)(ve,(0,S.s)(t,w[0]+w[2],w[1]),K);const pe=[0,0];return(0,S.t)(pe,(0,S.s)(t,w[0]+w[2],w[1]+w[3]),K),{rings:[[$,ve,pe,ue,$]]}}function Ee(x){switch(x.symbol.type){case"esriSFS":case"esriPFS":{const v=x.symbol.outline;return v?v.width:0}case"esriSLS":return(0,O.F2)(x.symbol.width);case"esriSMS":{const v=x.symbol,P=(0,O.F2)(v.xoffset),w=(0,O.F2)(v.yoffset);return(0,O.F2)(v.size)+Math.sqrt(P*P+w*w)}case"esriPMS":{const v=x.symbol,P=(0,O.F2)(v.xoffset),w=(0,O.F2)(v.yoffset);return(0,O.F2)(Math.max(v.width,v.height))+Math.sqrt(P*P+w*w)}case"esriTS":{const v=[0,0,0,0];le(v,x.symbol,x.mosaicItem);const P=Math.max(Math.abs(v[0]),Math.abs(v[1]));return Math.max(v[2],v[3])+P}case"expanded-cim":{const v=E.B$.getEnvelope(x.symbol.data);return v.width!==-1/0&&v.height!==-1/0||(v.width=10,v.height=10,v.x=0,v.y=0),(0,O.F2)(Math.sqrt(v.width*v.width+v.height*v.height))}case"composite-symbol":return x.symbol.layers.length?Ee({symbol:x.symbol.layers[x.symbol.layers.length-1],mosaicItem:null}):0;default:return 0}}function le(x,v,P){if(!P||0===P.glyphMosaicItems.length)return x;const w=(0,a.E)(v.text)[1],se=(0,U.Nr)(P.glyphMosaicItems,w,{scale:(0,O.F2)(v.font.size)/24,angle:v.angle,xOffset:v.xoffset,yOffset:v.yoffset,hAlign:(0,I.kH)(v.horizontalAlignment||"center"),vAlign:(0,I.b7)(v.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(v.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(v.lineHeight||1,4)),decoration:v.font.decoration||"none",isCIM:!1}).bounds;return x[0]=(0,O.F2)(se.x-se.halfWidth),x[1]=(0,O.F2)(se.y-se.halfHeight),x[2]=(0,O.F2)(se.width),x[3]=(0,O.F2)(se.height),x}},54188:(fe,H,d)=>{d.d(H,{aV:()=>u,S1:()=>r,os:()=>i,yR:()=>f});var I,C=d(22795),R=d(67474),O=d(33870),B=d(60305),ae=d(43392),S=d(33036),Y=d(29529),k=d(60046),T=d(85071),J=d(9077),N=(d(57025),d(42442)),V=d(43190),E=d(89333);let U=I=class extends S.Z{writeLevels(e,o,c){for(const m in e)return void(o.stops=this.levels[m])}clone(){return new I({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:(0,E.iY)(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:(0,E.iY)(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(e=>e.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:(0,T.d9)(this.levels)})}};(0,k._)([(0,J.Cb)()],U.prototype,"levels",void 0),(0,k._)([(0,V.c)("levels")],U.prototype,"writeLevels",null),U=I=(0,k._)([(0,N.j)("esri.views.2d.engine.LevelDependentSizeVariable")],U);const a=O.Z.getLogger("esri.views.2d.layers.support.clusterUtils");R.Z.add("esri-cluster-arcade-enabled",!0);const _=(0,R.Z)("esri-cluster-arcade-enabled"),r=(e,o,c,m)=>{const y=o.clone();if(!f(y))return y;if(c.fields)for(const L of c.fields)D(e,L);if("visualVariables"in y){const L=(y.visualVariables||[]).filter(z=>"$view.scale"!==z.valueExpression),j=i(L);L.forEach(z=>{"rotation"===z.type?z.field?z.field=l(e,z.field,"avg_angle"):z.valueExpression&&(z.field=g(e,z.valueExpression,"avg_angle"),z.valueExpression=null):z.normalizationField?(z.field=l(e,z.field,"norm",z.normalizationField),z.normalizationField=null):z.field?z.field=l(e,z.field,"avg"):(z.field=g(e,z.valueExpression,"avg"),z.valueExpression=null)}),(0,B.Wi)(j)&&!t(L)&&(L.push(u(c,m)),y.dynamicClusterSize=!0),y.visualVariables=L}switch(y.type){case"simple":break;case"unique-value":y.field?y.field=l(e,y.field,"mode"):y.valueExpression&&(y.field=g(e,y.valueExpression,"mode"),y.valueExpression=null);break;case"class-breaks":y.normalizationField?(y.field=l(e,y.field,"norm",y.normalizationField),y.normalizationField=null):y.field?y.field=l(e,y.field,"avg"):(y.field=g(e,y.valueExpression,"avg"),y.valueExpression=null)}return y},i=e=>{for(const o of e)if("size"===o.type)return o;return null},t=e=>{for(const o of e)if("cluster_count"===o.field)return!0;return!1},u=(e,o)=>{const c=[new Y.Z({value:0,size:0}),new Y.Z({value:1})];if((0,B.Wi)(o))return new S.Z({field:"cluster_count",stops:[...c,new Y.Z({value:2,size:0})]});const m=Object.keys(o).reduce((y,L)=>be(he({},y),{[L]:[...c,new Y.Z({value:Math.max(2,o[L].minValue),size:e.clusterMinSize}),new Y.Z({value:Math.max(3,o[L].maxValue),size:e.clusterMaxSize})]}),{});return new U({field:"cluster_count",levels:m})},f=e=>{const o=c=>a.error(new C.Z("Unsupported-renderer",c,{renderer:e}));if("unique-value"===e.type){if(e.field2||e.field3)return o("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===e.type){if(e.normalizationField){const c=e.normalizationType;if("field"!==c)return o(`FeatureReductionCluster does not support a normalizationType of ${c}`),!1}}else if("simple"!==e.type)return o(`FeatureReductionCluster does not support renderers of type ${e.type}`),!1;if(!_){if("valueExpression"in e&&e.valueExpression)return o("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in e&&e.visualVariables||[]).some(c=>!(!("valueExpression"in c)||!c.valueExpression)))return o("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function D(e,o){const{name:c,outStatistic:m}=o,{onStatisticField:y,onStatisticValueExpression:L,statisticType:j}=m;if(L){const z=(0,ae.F)(L.toLowerCase());e.push({name:c,outStatistic:{onStatisticField:z,onStatisticValueExpression:L,statisticType:j}})}else y?e.push({name:c,outStatistic:{onStatisticField:y,statisticType:j}}):a.error(new C.Z("mapview-unsupported-field","Unable to handle field",{field:o}))}function g(e,o,c){const m=(0,ae.F)(o),y="mode"===c?`cluster_type_${m}`:`cluster_avg_${m}`;return e.some(L=>L.name===y)||e.push({name:y,outStatistic:{onStatisticField:m,onStatisticValueExpression:o,statisticType:c}}),y}function l(e,o,c,m){if("cluster_count"===o||e.some(L=>L.name===o))return o;const y=function(e,o,c){switch(e){case"avg":case"avg_angle":return`cluster_avg_${o}`;case"mode":return`cluster_type_${o}`;case"norm":{const m=c,y="field",L=o.toLowerCase()+",norm:"+y+","+m.toLowerCase();return"cluster_avg_"+(0,ae.F)(L)}}}(c,o,m);return e.some(L=>L.name===y)||e.push("norm"===c?{name:y,outStatistic:{onStatisticField:o,onStatisticNormalizationField:m,statisticType:c}}:{name:y,outStatistic:{onStatisticField:o,statisticType:c}}),y}},28621:(fe,H,d)=>{d.d(H,{o:()=>O});const R=new(d(9836).Xn)({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function O(ae){return R.toJSON(ae)}}}]);