"use strict";var qe=Object.defineProperty,et=Object.defineProperties,tt=Object.getOwnPropertyDescriptors,ze=Object.getOwnPropertySymbols,st=Object.prototype.hasOwnProperty,it=Object.prototype.propertyIsEnumerable,Ge=Math.pow,Ue=(he,q,m)=>q in he?qe(he,q,{enumerable:!0,configurable:!0,writable:!0,value:m}):he[q]=m,Ne=(he,q)=>{for(var m in q||(q={}))st.call(q,m)&&Ue(he,m,q[m]);if(ze)for(var m of ze(q))it.call(q,m)&&Ue(he,m,q[m]);return he},Be=(he,q)=>et(he,tt(q));(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[4654],{44654:(he,q,m)=>{m.d(q,{Z:()=>Ke});var Z=m(61921),$=m(22795),oe=m(85071),le=m(60305),Ie=m(66727),V=m(4820),J=m(53781),W=m(13638),T=m(25481),D=m(52917),j=m(62354),z=m(89096),ae=m(11249),fe=m(41122);const pe=new class{constructor(s,r){this._cache=new ae.Z(s),this._invalidCache=new ae.Z(r)}get(s,r){const i=`${r.uid}:${s}`,a=this._cache.get(i);if(a)return a;if(void 0!==this._invalidCache.get(i))return null;try{const o=fe.WhereClause.create(s,r);return this._cache.put(i,o),o}catch(o){return this._invalidCache.put(i,null),null}}}(50,500),g="feature-store:unsupported-query",R=" as ",E=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function re(S,s){return S?pe.get(S,s):null}function de(S,s,r,i=!0){const a=[];for(const o of s)if("*"!==o&&!S.has(o))if(i){const u=ye(o);try{const f=re(u,S);if(!f)throw new $.Z(g,"invalid SQL expression",{where:u});if(!f.isStandardized)throw new $.Z(g,"expression is not standard",{clause:f});de(S,f.fieldNames,"expression contains missing fields")}catch(f){const y=f&&f.details;if(y&&(y.clause||y.where))throw f;y&&y.missingFields?a.push(...y.missingFields):a.push(o)}}else a.push(o);if(a.length)throw new $.Z(g,r,{missingFields:a})}function ye(S){return S.split(R)[0]}function me(S,s){const r=s.get(S);return!!r&&!E.has(r.type)}var ee=m(68310),I=m(26729),v=m(21276),U=m(90097),A=m(37194);class L{constructor(s,r,i){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=s.returnDistinctValues,this.fieldsIndex=i,this.featureAdapter=r;const a=s.outFields;if(a&&-1===a.indexOf("*")){this.outFields=a;let o=0;for(const u of a){const f=ye(u),y=this.fieldsIndex.get(f),p=y?null:re(f,i),x=y?y.name:u.split(R)[1]||"FIELD_EXP_"+o++;this._fieldDataCache.set(u,{alias:x,clause:p})}}}countDistinctValues(s){return this.returnDistinctValues?(s.forEach(r=>this.getAttributes(r)),this._returnDistinctMap.size):s.length}getAttributes(s){const r=this._processAttributesForOutFields(s);return this._processAttributesForDistinctValues(r)}getFieldValue(s,r,i){const a=i?i.name:r;let o=null;return this._fieldDataCache.has(a)?o=this._fieldDataCache.get(a).clause:i||(o=re(r,this.fieldsIndex),this._fieldDataCache.set(a,{alias:a,clause:o})),i?this.featureAdapter.getAttribute(s,a):o.calculateValue(s,this.featureAdapter)}getNormalizedValue(s,r){const i=r.normalizationType,a=r.normalizationTotal;let o=this.getFieldValue(s,r.field,r.fieldInfo);if(i&&Number.isFinite(o)){const u=this.getFieldValue(s,r.normalizationField,r.normalizationFieldInfo);o=(0,A.fk)(o,i,u,a)}return o}getExpressionValue(s,r,i){const a={attributes:this.featureAdapter.getAttributes(s)},o=i.createExecContext(a,r.viewInfo);return i.executeFunction(r.compiledFunc,o)}validateItem(s,r){return this._fieldDataCache.has(r)||this._fieldDataCache.set(r,{alias:r,clause:re(r,this.fieldsIndex)}),this._fieldDataCache.get(r).clause.testFeature(s,this.featureAdapter)}validateItems(s,r){return this._fieldDataCache.has(r)||this._fieldDataCache.set(r,{alias:r,clause:re(r,this.fieldsIndex)}),this._fieldDataCache.get(r).clause.testSet(s,this.featureAdapter)}_processAttributesForOutFields(s){const r=this.outFields;if(!r||!r.length)return this.featureAdapter.getAttributes(s);const i={};for(const a of r){const{alias:o,clause:u}=this._fieldDataCache.get(a);i[o]=u?u.calculateValue(s,this.featureAdapter):this.featureAdapter.getAttribute(s,o)}return i}_processAttributesForDistinctValues(s){if((0,le.Wi)(s)||!this.returnDistinctValues)return s;const r=this.outFields,i=[];if(r)for(const u of r){const{alias:f}=this._fieldDataCache.get(u);i.push(s[f])}else for(const u in s)i.push(s[u]);const a=`${(r||["*"]).join(",")}=${i.join(",")}`;let o=this._returnDistinctMap.get(a)||0;return this._returnDistinctMap.set(a,++o),o>1?null:s}}var se=m(32974),h=m(60343),F=m(76009),P=m(8982);function C(S){return S.substr(24,12)+S.substr(19,4)+S.substr(16,2)+S.substr(14,2)+S.substr(11,2)+S.substr(9,2)+S.substr(6,2)+S.substr(4,2)+S.substr(2,2)+S.substr(0,2)}function M(S,s,r){return(r?S>s:S<s)?-1:(r?S<s:S>s)?1:0}function ie(S,s,r){return r?s-S:S-s}function K(S,s,r,i){if(r&&"esriFieldTypeDate"===r.type){const a=new Date(S).getTime(),o=new Date(s).getTime();if(!isNaN(a)&&!isNaN(o))return ie(a,o,i)}if("number"==typeof S&&"number"==typeof s)return ie(S,s,i);if("string"==typeof S&&"string"==typeof s){const a=S.toUpperCase(),o=s.toUpperCase();return!r||"esriFieldTypeGUID"!==r.type&&"esriFieldTypeGlobalID"!==r.type?M(a,o,i):M(C(a),C(o),i)}return i?1:-1}class _{constructor(s,r,i){this.items=s,this.queryGeometry=r,this.definitionExpression=i.definitionExpression,this.geometryType=i.geometryType,this.hasM=i.hasM,this.hasZ=i.hasZ,this.objectIdField=i.objectIdField,this.spatialReference=i.spatialReference,this.fieldsIndex=i.fieldsIndex,this.timeInfo=i.timeInfo,this.featureAdapter=i.featureAdapter,this.aggregateAdapter=i.aggregateAdapter}get size(){return this.items.length}createQueryResponseForCount(s){const r=new L(s,this.featureAdapter,this.fieldsIndex);if(!s.outStatistics)return r.countDistinctValues(this.items);const{groupByFieldsForStatistics:i,having:a}=s;if(!(null==i?void 0:i.length))return 1;const o=new Map,u=new Map,f=new Set,y=s.outStatistics;for(const p of y){const{statisticType:x}=p,b="exceedslimit"!==x?p.onStatisticField:void 0;if(!u.has(b)){const H=[];for(const B of i){const te=this._getAttributeValues(r,B,o);H.push(te)}u.set(b,this._calculateUniqueValues(H,r.returnDistinctValues))}const N=u.get(b);for(const H in N){const{data:B,items:te}=N[H],ne=B.join(",");a&&!r.validateItems(te,a)||f.add(ne)}}return f.size}createQueryResponse(s){let r;return r=s.outStatistics?s.outStatistics.some(i=>"exceedslimit"===i.statisticType)?this._createExceedsLimitQueryResponse(s):this._createStatisticsQueryResponse(s):this._createFeatureQueryResponse(s),s.returnQueryGeometry&&(r.queryGeometry=(0,z.JY)(s.outSR)&&!(0,z.fS)(this.queryGeometry.spatialReference,s.outSR)?(0,h.S2)(Ne({spatialReference:s.outSR},(0,ee.iV)(this.queryGeometry,this.queryGeometry.spatialReference,s.outSR))):(0,h.S2)(Ne({spatialReference:s.outSR},this.queryGeometry))),r}createSnappingResponse(s,r){const i=this.featureAdapter,a=function(S,s){return S?s?4:3:s?3:2}(this.hasZ,this.hasM),{x:o,y:u}=s.point,f="number"==typeof s.distance?s.distance:s.distance.x,y="number"==typeof s.distance?s.distance:s.distance.y,p={candidates:[]},x="esriGeometryPolygon"===this.geometryType,b=this.getPointCreator(s.point,this.spatialReference,r);for(const N of this.items){const H=i.getGeometry(N);if((0,le.Wi)(H))continue;const{coords:B,lengths:te}=H;if(1&s.types){let ne=0;for(let Q=0;Q<te.length;Q++){const Y=te[Q];for(let X=0;X<Y;X++,ne+=a){const ue=B[ne],k=B[ne+1];if(X!==Y-1){const G=B[ne+a],Se=B[ne+a+1],{x:Ee,y:Re}=ge(o,u,ue,k,G,Se),Te=(o-Ee)/f,Qe=(u-Re)/y,Ae=Te*Te+Qe*Qe;Ae<=1&&p.candidates.push({type:"edge",objectId:i.getObjectId(N),distance:Math.sqrt(Ae),target:b(Ee,Re),start:b(ue,k),end:b(G,Se)})}}}}if(2&s.types){const ne=x?B.length-a:B.length;for(let Q=0;Q<ne;Q+=a){const Y=B[Q],X=B[Q+1],ue=(o-Y)/f,k=(u-X)/y,G=ue*ue+k*k;G<=1&&p.candidates.push({type:"vertex",objectId:i.getObjectId(N),distance:Math.sqrt(G),target:b(Y,X)})}}}return p.candidates.sort((N,H)=>N.distance-H.distance),p}getPointCreator(s,r,i){const a=(0,le.pC)(i)&&!(0,z.fS)(r,i)?o=>(0,ee.iV)(o,r,i):o=>o;return null!=s.z&&null!=s.m?(o,u)=>a({x:o,y:u,z:s.z,m:s.m}):null!=s.z?(o,u)=>a({x:o,y:u,z:s.z}):null!=s.m?(o,u)=>a({x:o,y:u,m:s.m}):(o,u)=>a({x:o,y:u})}executeAttributesQuery(s){const r=re(s.where,this.fieldsIndex);if(!r)return Promise.resolve(this);if(r.isStandardized){let i=0;const a=[];for(const u of this.items)r.testFeature(u,this.featureAdapter)&&(a[i++]=u);const o=new _(a,this.queryGeometry,this);return o.definitionExpression=s.where,Promise.resolve(o)}return Promise.reject(new TypeError("Where clause is not standardized"))}executeAggregateIdsQuery(s){if(!s.aggregateIds||!s.aggregateIds.length||(0,le.Wi)(this.aggregateAdapter))return Promise.resolve(this);const r=new Set;for(const a of s.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(a).forEach(o=>r.add(o));const i=this.featureAdapter.getObjectId;return Promise.resolve(new _(this.items.filter(a=>r.has(i(a))),this.queryGeometry,this))}executeObjectIdsQuery(s){if(!s.objectIds||!s.objectIds.length)return Promise.resolve(this);const r=new Set(s.objectIds),i=this.featureAdapter.getObjectId;return Promise.resolve(new _(this.items.filter(a=>r.has(i(a))),this.queryGeometry,this))}executeTimeQuery(s){const r=(0,se.y)(this.timeInfo,s.timeExtent,this.featureAdapter);if(!(0,le.pC)(r))return Promise.resolve(this);const i=this.items.filter(r);return Promise.resolve(new _(i,this.queryGeometry,this))}filterLatest(){const{trackIdField:s,startTimeField:r,endTimeField:i}=this.timeInfo,a=i||r,o=new Map,u=this.featureAdapter.getAttribute;for(const y of this.items){const p=u(y,s),x=u(y,a),b=o.get(p);(!b||x>u(b,a))&&o.set(p,y)}const f=Array.from(o.values());return Promise.resolve(new _(f,this.queryGeometry,this))}project(s){var r=this;return(0,Z.Z)(function*(){if(!s||(0,z.fS)(r.spatialReference,s))return r;const i=r.featureAdapter,a=(yield(0,ee.oj)(r.items.map(o=>(0,h.Op)(r.geometryType,r.hasZ,r.hasM,i.getGeometry(o))),r.spatialReference,s)).map((o,u)=>i.cloneWithGeometry(r.items[u],(0,U.GH)(o,r.hasZ,r.hasM)));return new _(a,r.queryGeometry,{definitionExpression:r.definitionExpression,geometryType:r.geometryType,hasM:r.hasM,hasZ:r.hasZ,objectIdField:r.objectIdField,spatialReference:s,fieldsIndex:r.fieldsIndex,timeInfo:r.timeInfo,featureAdapter:r.featureAdapter})})()}createSummaryStatisticsResponse(s,r){var i=this;return(0,Z.Z)(function*(){const{field:a,normalizationField:o,normalizationType:u,normalizationTotal:f,minValue:y,maxValue:p}=r,x=new L(s,i.featureAdapter,i.fieldsIndex),b=i.fieldsIndex.isDateField(a),N=r.valueExpression?yield i._getAttributeExpressionValues(x,r.valueExpression,r.viewInfoParams):i._getAttributeNormalizedValues(x,{field:a,normalizationField:o,normalizationType:u,normalizationTotal:f}),H=(0,A.S5)({normalizationType:u,normalizationField:o,minValue:y,maxValue:p}),B=(0,F.qN)(i.fieldsIndex.get(a))?(0,A.H0)({values:N,supportsNullCount:H}):(0,A.i5)({values:N,minValue:y,maxValue:p,useSampleStdDev:!u,supportsNullCount:H});return(0,A.rt)(B,b)})()}_sortFeatures(s,r,i){if(s.length>1&&r&&r.length)for(const a of r.reverse()){const o=a.split(" "),u=o[0],f=this.fieldsIndex.get(u),y=o[1]&&"desc"===o[1].toLowerCase();s.sort((p,x)=>K(i(p,u,f),i(x,u,f),f,y))}}_createFeatureQueryResponse(s){const r=this.items,{geometryType:i,hasM:a,hasZ:o,objectIdField:u,spatialReference:f}=this,{outFields:y,outSR:p,quantizationParameters:x,resultRecordCount:b,resultOffset:N,returnZ:H,returnM:B}=s,te=null!=b&&r.length>(N||0)+b,ne=y&&(y.indexOf("*")>-1?[...this.fieldsIndex.fields]:y.map(Q=>this.fieldsIndex.get(Q)));return{exceededTransferLimit:te,features:this._createFeatures(s,r),fields:ne,geometryType:i,hasM:a&&B,hasZ:o&&H,objectIdFieldName:u,spatialReference:(0,h.S2)(p||f),transform:x&&(0,v.vY)(x)||null}}_createFeatures(s,r){const i=new L(s,this.featureAdapter,this.fieldsIndex),{hasM:a,hasZ:o}=this,{orderByFields:u,quantizationParameters:f,returnGeometry:y,returnCentroid:p,maxAllowableOffset:x,resultOffset:b,resultRecordCount:N,returnZ:H=!1,returnM:B=!1}=s,te=o&&H,ne=a&&B;let Q=[],Y=0;const X=[...r];if(this._sortFeatures(X,u,(k,G,Se)=>i.getFieldValue(k,G,Se)),y||p){const k=(0,v.vY)(f);if(y&&!p)for(const G of X)Q[Y++]={attributes:i.getAttributes(G),geometry:(0,h.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(G),x,k,te,ne)};else if(!y&&p)for(const G of X)Q[Y++]={attributes:i.getAttributes(G),centroid:(0,h.EG)(this,this.featureAdapter.getCentroid(G,this),k)};else for(const G of X)Q[Y++]={attributes:i.getAttributes(G),centroid:(0,h.EG)(this,this.featureAdapter.getCentroid(G,this),k),geometry:(0,h.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(G),x,k,te,ne)}}else for(const k of X){const G=i.getAttributes(k);G&&(Q[Y++]={attributes:G})}const ue=b||0;return null!=N&&(Q=Q.slice(ue,Math.min(Q.length,ue+N))),Q}_createExceedsLimitQueryResponse(s){let r=!1,i=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;for(const u of s.outStatistics)if("exceedslimit"===u.statisticType){i=null!=u.maxPointCount?u.maxPointCount:Number.POSITIVE_INFINITY,a=null!=u.maxRecordCount?u.maxRecordCount:Number.POSITIVE_INFINITY,o=null!=u.maxVertexCount?u.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)r=this.items.length>i;else if(this.items.length>a)r=!0;else{const u=this.hasZ?this.hasM?4:3:this.hasM?3:2,f=this.featureAdapter;r=this.items.reduce((y,p)=>{const x=f.getGeometry(p);return y+((0,le.pC)(x)&&x.coords.length||0)},0)/u>o}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(r)}}]}}_createStatisticsQueryResponse(s){const r={attributes:{}},i=[],a=new Map,o=new Map,u=new Map,f=new Map,y=new L(s,this.featureAdapter,this.fieldsIndex),p=s.outStatistics,{groupByFieldsForStatistics:x,having:b,orderByFields:N}=s,H=x&&x.length,B=!!H,te=B&&x[0],ne=B&&!this.fieldsIndex.get(te);for(const Y of p){const{outStatisticFieldName:X,statisticType:ue}=Y,k=Y,G="exceedslimit"!==ue?Y.onStatisticField:void 0,Se="percentile_disc"===ue||"percentile_cont"===ue,Ee=B&&1===H&&(G===te||ne)&&"count"===ue;if(B){if(!u.has(G)){const Te=[];for(const Qe of x){const Ae=this._getAttributeValues(y,Qe,a);Te.push(Ae)}u.set(G,this._calculateUniqueValues(Te,y.returnDistinctValues))}const Re=u.get(G);for(const Te in Re){const{count:Qe,data:Ae,items:Xe,itemPositions:$e}=Re[Te],je=Ae.join(",");if(!b||y.validateItems(Xe,b)){const Ze=f.get(je)||{attributes:{}};let De=null;if(Ee)De=Qe;else{const we=this._getAttributeValues(y,G,a),Me=$e.map(ke=>we[ke]);De=Se&&"statisticParameters"in k?this._getPercentileValue(k,Me):this._getStatisticValue(k,Me,null,y.returnDistinctValues)}Ze.attributes[X]=De,x.forEach((we,Me)=>Ze.attributes[this.fieldsIndex.get(we)?we:`EXPR_${Me+1}`]=Ae[Me]),f.set(je,Ze)}}}else{const Re=this._getAttributeValues(y,G,a);r.attributes[X]=Se&&"statisticParameters"in k?this._getPercentileValue(k,Re):this._getStatisticValue(k,Re,o,y.returnDistinctValues)}i.push({name:X,alias:X,type:"esriFieldTypeDouble"})}const Q=B?Array.from(f.values()):[r];return this._sortFeatures(Q,N,(Y,X)=>Y.attributes[X]),{fields:i,features:Q}}_getStatisticValue(s,r,i,a){const{onStatisticField:o,statisticType:u}=s;let f=null;return f=null!=i&&i.has(o)?i.get(o):(0,F.qN)(this.fieldsIndex.get(o))?(0,A.H0)({values:r,returnDistinct:a}):(0,A.i5)({values:r,minValue:null,maxValue:null,useSampleStdDev:!0}),i&&i.set(o,f),f["var"===u?"variance":u]}_getPercentileValue(s,r){const{onStatisticField:i,statisticParameters:a,statisticType:o}=s,{value:u,orderBy:f}=a,y="desc"===f,p=this.fieldsIndex.get(i),x=[...r].filter(b=>null!=b).sort((b,N)=>K(b,N,p,y));return this._calculatePercentile(x,u,"percentile_disc"===o)}_getAttributeValues(s,r,i){if(i.has(r))return i.get(r);const a=this.fieldsIndex.get(r),o=this.items.map(u=>s.getFieldValue(u,r,a));return i.set(r,o),o}_getAttributeNormalizedValues(s,r){return this.items.map(i=>s.getNormalizedValue(i,{field:r.field,fieldInfo:this.fieldsIndex.get(r.field),normalizationField:r.normalizationField,normalizationFieldInfo:this.fieldsIndex.get(r.normalizationField),normalizationType:r.normalizationType,normalizationTotal:r.normalizationTotal}))}_getAttributeExpressionValues(s,r,i){var a=this;return(0,Z.Z)(function*(){const{arcadeUtils:o}=yield(0,P.LC)(),u=o.createFunction(r),f=i&&o.getViewInfo(i);return a.items.map(y=>s.getExpressionValue(y,{compiledFunc:u,viewInfo:f},o))})()}_calculateUniqueValues(s,r){const i={},a=this.items,o=a.length;for(let u=0;u<o;u++){const f=a[u],y=[];for(const x of s)y.push(x[u]);const p=y.join(",");r?null==i[p]&&(i[p]={count:1,data:y,items:[f],itemPositions:[u]}):null==i[p]?i[p]={count:1,data:y,items:[f],itemPositions:[u]}:(i[p].count++,i[p].items.push(f),i[p].itemPositions.push(u))}return i}_calculatePercentile(s,r,i){if(0===s.length)return null;if(r<=0)return s[0];if(r>=1)return s[s.length-1];const a=(s.length-1)*r,o=Math.floor(a),u=o+1,f=a%1,y=s[o],p=s[u];return u>=s.length||i||"string"==typeof y||"string"==typeof p?y:y*(1-f)+p*f}}function ge(S,s,r,i,a,o){const u=a-r,f=o-i,x=Math.min(1,Math.max(0,((S-r)*u+(s-i)*f)/(u*u+f*f)));return{x:r+u*x,y:i+f*x}}var xe=m(84825),be=m(25808),Ce=m(12523);class We{constructor(){this._tasks=new Array}get length(){return this._tasks.length}push(s,r,i){return new Promise((a,o)=>this._tasks.push(new Ve(a,o,s,r,i)))}unshift(s,r,i){return new Promise((a,o)=>this._tasks.unshift(new Ve(a,o,s,r,i)))}process(){if(0===this._tasks.length)return!1;const s=this._tasks.shift();try{const r=(0,Ce.Hc)(s.signal);if(r&&!s.abortCallback)s.reject((0,Ce.zE)());else{const i=r?s.abortCallback((0,Ce.zE)()):s.callback();(0,Ce.tI)(i)?i.then(s.resolve,s.reject):s.resolve(i)}}catch(r){s.reject(r)}return!0}cancelAll(){const s=(0,Ce.zE)();for(const r of this._tasks)if(r.abortCallback){const i=r.abortCallback(s);r.resolve(i)}else r.reject(s);this._tasks.length=0}}class Ve{constructor(s,r,i,a,o){this.resolve=s,this.reject=r,this.callback=i,this.signal=a,this.abortCallback=o}}const Fe="feature-store:unsupported-query",Oe=new Set,Ye=new Ie.WJ(2e6);let Je=0;class Ke{constructor(s){this.capabilities={query:I.g},this.geometryType=s.geometryType,this.hasM=s.hasM,this.hasZ=s.hasZ,this.objectIdField=s.objectIdField,this.spatialReference=s.spatialReference,this.definitionExpression=s.definitionExpression,this.featureStore=s.featureStore,this.aggregateAdapter=s.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache()),this.timeInfo=s.timeInfo,s.cacheSpatialQueries&&(this._geometryQueryCache=new Ie.Xq(Je+++"$$",Ye)),this.fieldsIndex=new be.Z(s.fields),s.scheduler&&s.priority&&(this._frameQueue=new We,this._frameTask=s.scheduler.registerTask(s.priority,this))}destroy(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const s=this.featureStore.fullBounds;return s?{xmin:s[0],ymin:s[1],xmax:s[2],ymax:s[3],spatialReference:(0,h.S2)(this.spatialReference)}:null}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=(0,se.R)(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}executeQuery(s={},r){var i=this;return(0,Z.Z)(function*(){let a,o=(0,oe.d9)(s);try{o=yield i._schedule(()=>(0,h.Up)(o,i.definitionExpression,i.spatialReference),r),o=yield i._reschedule(()=>i._checkQuerySupport(o),r),a=yield i._reschedule(()=>i._executeGeometryQuery(o,r),r),a=yield i._reschedule(()=>a.executeAggregateIdsQuery(o),r),a=yield i._reschedule(()=>a.executeObjectIdsQuery(o),r),a=yield i._reschedule(()=>a.executeTimeQuery(o),r),a=yield i._reschedule(()=>a.executeAttributesQuery(o),r)}catch(u){if(u!==h.vF)throw u;a=new _([],null,i)}return a.createQueryResponse(o)})()}executeQueryForCount(s={},r){var i=this;return(0,Z.Z)(function*(){let a,o=(0,oe.d9)(s);o.returnGeometry=!1,o.returnCentroid=!1,o.outSR=null;try{o=yield i._schedule(()=>(0,h.Up)(o,i.definitionExpression,i.spatialReference),r),o=yield i._reschedule(()=>i._checkQuerySupport(o),r),a=yield i._reschedule(()=>i._executeGeometryQuery(o,r),r),a=yield i._reschedule(()=>a.executeAggregateIdsQuery(o),r),a=yield i._reschedule(()=>a.executeObjectIdsQuery(o),r),a=yield i._reschedule(()=>a.executeTimeQuery(o),r),a=yield i._reschedule(()=>a.executeAttributesQuery(o),r)}catch(u){if(u!==h.vF)throw u;return 0}return a.createQueryResponseForCount(o)})()}executeQueryForExtent(s={},r){var i=this;return(0,Z.Z)(function*(){let a,o=(0,oe.d9)(s);const u=o.outSR;try{o=yield i._schedule(()=>(0,h.Up)(o,i.definitionExpression,i.spatialReference),r),o=yield i._reschedule(()=>i._checkQuerySupport(o),r),o.returnGeometry=!0,o.returnCentroid=!1,o.outSR=null,a=yield i._reschedule(()=>i._executeGeometryQuery(o,r),r),a=yield i._reschedule(()=>a.executeAggregateIdsQuery(o),r),a=yield i._reschedule(()=>a.executeObjectIdsQuery(o),r),a=yield i._reschedule(()=>a.executeTimeQuery(o),r),a=yield i._reschedule(()=>a.executeAttributesQuery(o),r);const f=a.size;if(!f)return{count:f,extent:null};(0,J.t8)(_e,J.Gv),i.featureStore.forEachBounds(a.items,x=>(0,J.TC)(_e,x),He);const y={xmin:_e[0],ymin:_e[1],xmax:_e[3],ymax:_e[4],spatialReference:(0,h.S2)(i.spatialReference)};i.hasZ&&isFinite(_e[2])&&isFinite(_e[5])&&(y.zmin=_e[2],y.zmax=_e[5]);const p=(0,ee.iV)(y,a.spatialReference,u);if(p.spatialReference=(0,h.S2)(u||i.spatialReference),p.xmax-p.xmin==0){const x=(0,V.c9)(p.spatialReference);p.xmin-=x,p.xmax+=x}if(p.ymax-p.ymin==0){const x=(0,V.c9)(p.spatialReference);p.ymin-=x,p.ymax+=x}if(i.hasZ&&null!=p.zmin&&null!=p.zmax&&p.zmax-p.zmin==0){const x=(0,V.c9)(p.spatialReference);p.zmin-=x,p.zmax+=x}return{count:f,extent:p}}catch(f){if(f===h.vF)return{count:0,extent:null};throw f}})()}executeQueryForIds(s={},r){var i=this;return(0,Z.Z)(function*(){return i.executeQueryForIdSet(s,r).then(a=>Array.from(a))})()}executeQueryForIdSet(s={},r){var i=this;return(0,Z.Z)(function*(){let a,o=(0,oe.d9)(s);o.returnGeometry=!1,o.returnCentroid=!1,o.outSR=null;try{o=yield i._schedule(()=>(0,h.Up)(o,i.definitionExpression,i.spatialReference),r),o=yield i._reschedule(()=>i._checkQuerySupport(o),r),a=yield i._reschedule(()=>i._executeGeometryQuery(o,r),r),a=yield i._reschedule(()=>a.executeAggregateIdsQuery(o),r),a=yield i._reschedule(()=>a.executeObjectIdsQuery(o),r),a=yield i._reschedule(()=>a.executeTimeQuery(o),r),a=yield i._reschedule(()=>a.executeAttributesQuery(o),r);const u=a.items,f=new Set;return yield i._reschedule(()=>{for(const y of u)f.add(a.featureAdapter.getObjectId(y))},r),f}catch(u){if(u===h.vF)return new Set;throw u}})()}executeQueryForSnapping(s,r){var i=this;return(0,Z.Z)(function*(){const{point:a,distance:o,types:u}=s;if(0===u)return{candidates:[]};const f=yield i._reschedule(()=>i._checkQuerySupport(s.query),r),y=!(0,z.fS)(a.spatialReference,i.spatialReference);y&&(yield(0,ee._W)(a.spatialReference,i.spatialReference));const p="number"==typeof o?o:o.x,x="number"==typeof o?o:o.y,b={xmin:a.x-p,xmax:a.x+p,ymin:a.y-x,ymax:a.y+x,spatialReference:a.spatialReference},N=y?(0,ee.iV)(b,i.spatialReference):b;if(!N)return{candidates:[]};const H=(yield(0,j.aX)((0,D.im)(a),null,{signal:r}))[0],B=(yield(0,j.aX)((0,D.im)(N),null,{signal:r}))[0];if((0,le.Wi)(H)||(0,le.Wi)(B))return{candidates:[]};let te=new _(i._searchFeatures(i._getQueryBBoxes(B.toJSON())),null,i);te=yield i._reschedule(()=>te.executeObjectIdsQuery(f),r),te=yield i._reschedule(()=>te.executeTimeQuery(f),r),te=yield i._reschedule(()=>te.executeAttributesQuery(f),r);const ne=H.toJSON(),Q=y?(0,ee.iV)(ne,i.spatialReference):ne,Y=y?Math.max(N.xmax-N.xmin,N.ymax-N.ymin)/2:o;return te.createSnappingResponse(Be(Ne({},s),{point:Q,distance:Y}),a.spatialReference)})()}executeQueryForLatestObservations(s={},r){var i=this;return(0,Z.Z)(function*(){if(!i.timeInfo||!i.timeInfo.trackIdField)throw new $.Z(Fe,"Missing timeInfo or timeInfo.trackIdField",{query:s,timeInfo:i.timeInfo});let a,o=(0,oe.d9)(s);try{o=yield i._schedule(()=>(0,h.Up)(o,i.definitionExpression,i.spatialReference),r),o=yield i._reschedule(()=>i._checkQuerySupport(o),r),a=yield i._reschedule(()=>i._executeGeometryQuery(o,r),r),a=yield i._reschedule(()=>a.executeAggregateIdsQuery(o),r),a=yield i._reschedule(()=>a.executeObjectIdsQuery(o),r),a=yield i._reschedule(()=>a.executeTimeQuery(o),r),a=yield i._reschedule(()=>a.executeAttributesQuery(o),r),a=yield i._reschedule(()=>a.filterLatest(),r)}catch(u){if(u!==h.vF)throw u;a=new _([],null,i)}return a.createQueryResponse(o)})()}executeQueryForSummaryStatistics(s={},r,i){var a=this;return(0,Z.Z)(function*(){let o;s=(0,oe.d9)(s);try{s=yield a._schedule(()=>(0,h.Up)(s,a.definitionExpression,a.spatialReference),i),s=yield a._reschedule(()=>a._checkSummaryStatisticsSupport(s,r),i),o=yield a._reschedule(()=>a._executeGeometryQuery(s,i),i),o=yield a._reschedule(()=>o.executeAggregateIdsQuery(s),i),o=yield a._reschedule(()=>o.executeObjectIdsQuery(s),i),o=yield a._reschedule(()=>o.executeTimeQuery(s),i),o=yield a._reschedule(()=>o.executeAttributesQuery(s),i)}catch(u){if(u!==h.vF)throw u;o=new _([],null,a)}return o.createSummaryStatisticsResponse(s,r)})()}_schedule(s,r){var i=this;return(0,Z.Z)(function*(){return i._frameQueue?i._frameQueue.push(s,r):s()})()}_reschedule(s,r){var i=this;return(0,Z.Z)(function*(){return i._frameQueue?i._frameQueue.unshift(s,r):s()})()}get running(){return this._frameQueue.length>0}runTask(s){for(this._budget=s;!s.done&&this._frameQueue&&this._frameQueue.process();)s.madeProgress();this._budget=null}_getAll(){if(!this._allItems){const s=[];this.featureStore.forEach(r=>s.push(r)),this._allItems=new _(s,null,this)}return this._allItems}_executeGeometryQuery(s,r){var i=this;return(0,Z.Z)(function*(){const{geometry:a,outSR:o,spatialRel:u,returnGeometry:f,returnCentroid:y}=s,p=f||y,x=(0,z.JY)(o)&&!(0,z.fS)(i.spatialReference,o),b=i._geometryQueryCache?x&&p?JSON.stringify({geometry:a,spatialRelationship:u,outSpatialReference:o}):JSON.stringify({geometry:a,spatialRelationship:u}):null;if(b){const Q=i._geometryQueryCache.get(b);if(!(0,le.o8)(Q))return Q}const N=function(){var Q=(0,Z.Z)(function*(Y){if(x&&p){const X=yield Y.project(o);return b&&i._geometryQueryCache.put(b,X,X.size||1),X}return b&&i._geometryQueryCache.put(b,Y,Y.size||1),Y});return function(X){return Q.apply(this,arguments)}}();if(!a)return N(i._getAll());const H=i.featureAdapter;if("esriSpatialRelDisjoint"===u){const Q=i._searchFeatures(i._getQueryBBoxes(a));if(!Q.length)return N(i._getAll());let Y,X;const ue=new Set;for(const G of Q)ue.add(H.getObjectId(G));return yield i._reschedule(()=>{let G=0;Y=new Array(ue.size),i.featureStore.forEach(Se=>Y[G++]=Se),X=ue},r),N(yield i._reschedule((0,Z.Z)(function*(){const G=yield(0,xe.cW)(u,a,i.geometryType,i.hasZ,i.hasM);return new _(yield i._runSpatialFilter(Y,Ee=>!X.has(H.getObjectId(Ee))||G(H.getGeometry(Ee)),r),a,i)}),r))}const B=i._searchFeatures(i._getQueryBBoxes(a));if(!B.length){const Q=new _([],a,i);return b&&i._geometryQueryCache.put(b,Q,Q.size||1),Q}if(i._canExecuteSoloPass(a,s))return N(new _(B,a,i));const te=yield(0,xe.cW)(u,a,i.geometryType,i.hasZ,i.hasM),ne=yield i._runSpatialFilter(B,Q=>te(H.getGeometry(Q)),r);return N(new _(ne,a,i))})()}_runSpatialFilter(s,r,i){var a=this;return(0,Z.Z)(function*(){if(!r)return s;if(!a._budget)return s.filter(y=>r(y));let o=0;const u=new Array,f=function(){var y=(0,Z.Z)(function*(){for(;o<s.length;){const p=s[o];r(p)&&u.push(p),a._budget.done&&(yield a._reschedule(()=>f(),i)),++o}});return function(){return y.apply(this,arguments)}}();return a._reschedule(()=>f(),i).then(()=>u)})()}_canExecuteSoloPass(s,r){const{geometryType:i}=this,{spatialRel:a}=r;return(0,xe.hN)(s)&&("esriSpatialRelEnvelopeIntersects"===a||"esriGeometryPoint"===i&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a||"esriSpatialRelWithin"===a))}_getQueryBBoxes(s){if((0,xe.hN)(s)){if((0,D.YX)(s))return[(0,W.al)(s.xmin,s.ymin,s.xmax,s.ymax)];if((0,D.oU)(s))return s.rings.map(r=>(0,W.al)(Math.min(r[0][0],r[2][0]),Math.min(r[0][1],r[2][1]),Math.max(r[0][0],r[2][0]),Math.max(r[0][1],r[2][1])))}return[(0,T.$P)((0,W.Ue)(),s)]}_searchFeatures(s){for(const a of s)this.featureStore.forEachInBounds(a,o=>{Oe.add(o)});const r=new Array(Oe.size);let i=0;return Oe.forEach(a=>r[i++]=a),Oe.clear(),r}_checkSummaryStatisticsSupport(s,r){var i=this;return(0,Z.Z)(function*(){if(s.distance<0||null!=s.geometryPrecision||s.multipatchOption||s.pixelSize||s.relationParam||s.text||s.outStatistics||s.groupByFieldsForStatistics||s.having||s.orderByFields)throw new $.Z(Fe,"Unsupported query options",{query:s});return Promise.all([i._checkAttributesQuerySupport(s),i._checkSummaryStatisticsParamsSupport(r),(0,xe.P0)(s,i.geometryType,i.spatialReference),(0,ee._W)(i.spatialReference,s.outSR)]).then(()=>s)})()}_checkSummaryStatisticsParamsSupport(s){var r=this;return(0,Z.Z)(function*(){let i=[];if(s.valueExpression){const{arcadeUtils:a}=yield(0,P.LC)();i=a.extractFieldNames(s.valueExpression)}if(s.field&&i.push(s.field),s.normalizationField&&i.push(s.normalizationField),!i.length)throw new $.Z(Fe,"params should have at least a field or valueExpression",{params:s});de(r.fieldsIndex,i,"params contains missing fields")})()}_checkQuerySupport(s){var r=this;return(0,Z.Z)(function*(){if(s.distance<0||null!=s.geometryPrecision||s.multipatchOption||s.pixelSize||s.relationParam||s.text)throw new $.Z(Fe,"Unsupported query options",{query:s});return Promise.all([r._checkAttributesQuerySupport(s),r._checkStatisticsQuerySupport(s),(0,xe.P0)(s,r.geometryType,r.spatialReference),(0,ee._W)(r.spatialReference,s.outSR)]).then(()=>s)})()}_checkAttributesQuerySupport(s){const{outFields:r,orderByFields:i,returnDistinctValues:a,outStatistics:o}=s,u=o?o.map(f=>f.outStatisticFieldName&&f.outStatisticFieldName.toLowerCase()):[];if(i&&i.length>0){const f=" asc",y=" desc",p=i.map(x=>{const b=x.toLowerCase();return b.indexOf(f)>-1?b.split(f)[0]:b.indexOf(y)>-1?b.split(y)[0]:x}).filter(x=>-1===u.indexOf(x));de(this.fieldsIndex,p,"orderByFields contains missing fields")}if(r&&r.length>0)de(this.fieldsIndex,r,"outFields contains missing fields");else if(a)throw new $.Z(Fe,"outFields should be specified for returnDistinctValues",{query:s});!function(S,s){if(!s)return!0;const r=pe.get(s,S);if(!r)throw new $.Z(g,"invalid SQL expression",{where:s});if(!r.isStandardized)throw new $.Z(g,"where clause is not standard",{where:s});de(S,r.fieldNames,"where clause contains missing fields")}(this.fieldsIndex,s.where)}_checkStatisticsQuerySupport(s){var r=this;return(0,Z.Z)(function*(){const{outStatistics:i,groupByFieldsForStatistics:a,having:o}=s,u=a&&a.length,f=i&&i.length;if(o){if(!u||!f)throw new $.Z(Fe,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:s});!function(S,s,r){if(!s)return!0;const i=pe.get(s,S);if(!i)throw new $.Z(g,"invalid SQL expression",{having:s});if(!i.isAggregate)throw new $.Z(g,"having does not contain a valid aggregate function",{having:s});if(de(S,i.fieldNames,"having contains missing fields"),!i.getExpressions().every(o=>{const{aggregateType:u,field:f}=o,y=S.has(f)&&S.get(f).name;return r.some(p=>{const{onStatisticField:x,statisticType:b}=p;return(S.has(x)&&S.get(x).name)===y&&b.toLowerCase().trim()===u})}))throw new $.Z(g,"expressions in having should also exist in outStatistics",{having:s})}(r.fieldsIndex,o,i)}if(f){if(!i.every(s=>"exceedslimit"!==s.statisticType))return;const y=i.map(p=>p.onStatisticField);de(r.fieldsIndex,y,"onStatisticFields contains missing fields"),u&&de(r.fieldsIndex,a,"groupByFieldsForStatistics contains missing fields");for(const p of i){const{onStatisticField:x,statisticType:b}=p;if("percentile_disc"!==b&&"percentile_cont"!==b||!("statisticParameters"in p)){if("count"!==b&&x&&me(x,r.fieldsIndex))throw new $.Z(Fe,"outStatistics contains non-numeric fields",{definition:p,query:s})}else{const{statisticParameters:N}=p;if(!N)throw new $.Z(Fe,"statisticParamters should be set for percentile type",{definition:p,query:s})}}}})()}}const He=(0,J.Ue)(),_e=(0,J.Ue)()},26729:(he,q,m)=>{m.d(q,{g:()=>Z});const Z={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},84825:(he,q,m)=>{m.d(q,{hN:()=>ee,P0:()=>ve,cW:()=>ye});var Z=m(61921),$=m(22795),oe=m(87296),le=m(15969),V=m(52917),J=m(89096);function W(I,v){return I?v?4:3:v?3:2}function j(I,v,U,A,L){if(!I)return!1;const se=W(v,U),{coords:h,lengths:F}=I;let P=!1,C=0;for(const M of F)P=z(P,h,se,C,M,A,L),C+=M*se;return P}function z(I,v,U,A,L,se,h){let F=I,P=A;for(let C=A,M=A+L*U;C<M;C+=U){P=C+U,P===M&&(P=A);const ie=v[C],K=v[C+1],_=v[P],ge=v[P+1];(K<h&&ge>=h||ge<h&&K>=h)&&ie+(h-K)/(ge-K)*(_-ie)<se&&(F=!F)}return F}var ae=m(90097),fe=m(82490),ce=m(68310),pe=m(60343);const g="feature-store:unsupported-query",R={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},E_spatialRelationship={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},E_queryGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},E_layerGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function O(I){return!0===E_spatialRelationship[I]}function w(I){return!0===E_queryGeometry[(0,V.Ji)(I)]}function re(I){return!0===E_layerGeometry[I]}function ye(I,v,U,A,L){if((0,V.oU)(v)&&"esriGeometryPoint"===U&&("esriSpatialRelIntersects"===I||"esriSpatialRelContains"===I)){const se=(0,ae.Uy)(new fe.Z,v,!1,!1);return Promise.resolve(h=>function(I,v,U,A){return j(I,!1,!1,A.coords[0],A.coords[1])}(se,0,0,h))}if((0,V.oU)(v)&&"esriGeometryMultipoint"===U){const se=(0,ae.Uy)(new fe.Z,v,!1,!1);if("esriSpatialRelContains"===I)return Promise.resolve(h=>function(I,v,U,A,L,se){const h=W(L,se),{coords:F,lengths:P}=A;if(!P)return!1;for(let C=0,M=0;C<P.length;C++,M+=h)if(!j(I,false,false,F[M],F[M+1]))return!1;return!0}(se,0,0,h,A,L))}if((0,V.YX)(v)&&"esriGeometryPoint"===U&&("esriSpatialRelIntersects"===I||"esriSpatialRelContains"===I))return Promise.resolve(se=>(0,oe.aV)(v,(0,pe.Op)(U,A,L,se)));if((0,V.YX)(v)&&"esriGeometryMultipoint"===U&&"esriSpatialRelContains"===I)return Promise.resolve(se=>(0,oe.lQ)(v,(0,pe.Op)(U,A,L,se)));if((0,V.YX)(v)&&"esriSpatialRelIntersects"===I){const se=function(I){return"mesh"===I?le.h_:(0,le.IY)(I)}(U);return Promise.resolve(h=>se(v,(0,pe.Op)(U,A,L,h)))}return Promise.all([m.e(6536),m.e(8592),m.e(7889)]).then(m.bind(m,47889)).then(se=>{const h=se[R[I]].bind(null,v.spatialReference,v);return F=>h((0,pe.Op)(U,A,L,F))})}function ve(I,v,U){return me.apply(this,arguments)}function me(){return(me=(0,Z.Z)(function*(I,v,U){const{spatialRel:A,geometry:L}=I;if(L){if(!O(A))throw new $.Z(g,"Unsupported query spatial relationship",{query:I});if((0,J.JY)(L.spatialReference)&&(0,J.JY)(U)){if(!w(L))throw new $.Z(g,"Unsupported query geometry type",{query:I});if(!re(v))throw new $.Z(g,"Unsupported layer geometry type",{query:I});if(I.outSR)return(0,ce._W)(I.geometry&&I.geometry.spatialReference,I.outSR)}}})).apply(this,arguments)}function ee(I){if((0,V.YX)(I))return!0;if((0,V.oU)(I)){for(const v of I.rings)if(5!==v.length||v[0][0]!==v[1][0]||v[0][0]!==v[4][0]||v[2][0]!==v[3][0]||v[0][1]!==v[3][1]||v[0][1]!==v[4][1]||v[1][1]!==v[2][1])return!1;return!0}return!1}},32974:(he,q,m)=>{function Z(V,J){if(!V)return null;const W=J.featureAdapter,{startTimeField:T,endTimeField:D}=V;let j=Number.POSITIVE_INFINITY,z=Number.NEGATIVE_INFINITY;if(T&&D)J.forEach(ae=>{const fe=W.getAttribute(ae,T),ce=W.getAttribute(ae,D);null==fe||isNaN(fe)||(j=Math.min(j,fe)),null==ce||isNaN(ce)||(z=Math.max(z,ce))});else{const ae=T||D;J.forEach(fe=>{const ce=W.getAttribute(fe,ae);null==ce||isNaN(ce)||(j=Math.min(j,ce),z=Math.max(z,ce))})}return{start:j,end:z}}function $(V,J,W){if(!J||!V)return null;const{startTimeField:T,endTimeField:D}=V;if(!T&&!D)return null;const{start:j,end:z}=J;return null===j&&null===z?null:void 0===j&&void 0===z?()=>!1:T&&D?function(V,J,W,T,D){return null!=T&&null!=D?j=>{const z=V.getAttribute(j,J),ae=V.getAttribute(j,W);return(null==z||z<=D)&&(null==ae||ae>=T)}:null!=T?j=>{const z=V.getAttribute(j,W);return null==z||z>=T}:null!=D?j=>{const z=V.getAttribute(j,J);return null==z||z<=D}:void 0}(W,T,D,j,z):function(V,J,W,T){return null!=W&&null!=T&&W===T?D=>V.getAttribute(D,J)===W:null!=W&&null!=T?D=>{const j=V.getAttribute(D,J);return j>=W&&j<=T}:null!=W?D=>V.getAttribute(D,J)>=W:null!=T?D=>V.getAttribute(D,J)<=T:void 0}(W,T||D,j,z)}m.d(q,{R:()=>Z,y:()=>$})},60343:(he,q,m)=>{m.d(q,{vF:()=>ae,S2:()=>A,Op:()=>O,Up:()=>w,j6:()=>ve,EG:()=>R});var Z=m(61921),$=m(9836),oe=m(60305),le=m(4820),Ie=m(39643),V=m(52917),J=m(62354),W=m(89096),T=m(90097),D=m(82490),j=m(68310);const z=new $.Xn({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),ae=Object.freeze({}),fe=new D.Z,ce=new D.Z,pe=new D.Z,g={esriGeometryPoint:T.fQ,esriGeometryPolyline:T.J6,esriGeometryPolygon:T.eG,esriGeometryMultipoint:T.Iv};function R(h,F,P,C=h.hasZ,M=h.hasM){if((0,oe.Wi)(F))return null;const ie=h.hasZ&&C,K=h.hasM&&M;if(P){const _=(0,T.Nh)(pe,F,h.hasZ,h.hasM,"esriGeometryPoint",P,C,M);return(0,T.fQ)(_,ie,K)}return(0,T.fQ)(F,ie,K)}function O(h,F,P,C,M,ie,K=F,_=P){const ge=F&&K,Pe=P&&_,xe=(0,oe.pC)(C)?"coords"in C?C:C.geometry:null;if((0,oe.Wi)(xe))return null;if(M){let be=(0,T.zj)(ce,xe,F,P,h,M,K,_);return ie&&(be=(0,T.Nh)(pe,be,ge,Pe,h,ie)),g[h](be,ge,Pe)}if(ie){const be=(0,T.Nh)(pe,xe,F,P,h,ie,K,_);return g[h](be,ge,Pe)}return(0,T.hY)(fe,xe,F,P,K,_),g[h](fe,ge,Pe)}function w(h,F,P){return re.apply(this,arguments)}function re(){return(re=(0,Z.Z)(function*(h,F,P){const{outFields:C,orderByFields:M,groupByFieldsForStatistics:ie,outStatistics:K}=h;if(C)for(let _=0;_<C.length;_++)C[_]=C[_].trim();if(M)for(let _=0;_<M.length;_++)M[_]=M[_].trim();if(ie)for(let _=0;_<ie.length;_++)ie[_]=ie[_].trim();if(K)for(let _=0;_<K.length;_++)K[_].onStatisticField&&(K[_].onStatisticField=K[_].onStatisticField.trim());return h.geometry&&!h.outSR&&(h.outSR=h.geometry.spatialReference),ve(h,F,P)})).apply(this,arguments)}function ve(h,F,P){return me.apply(this,arguments)}function me(){return(me=(0,Z.Z)(function*(h,F,P){if(!h)return null;let{where:C}=h;if(h.where=C=C&&C.trim(),(!C||/^1 *= *1$/.test(C)||F&&F===C)&&(h.where=null),!h.geometry)return h;let M=yield ee(h);if(h.distance=0,h.units=null,"esriSpatialRelEnvelopeIntersects"===h.spatialRel){const{spatialReference:ge}=h.geometry;M=(0,Ie.aO)(M),M.spatialReference=ge}h.geometry=M,yield(0,j._W)(M.spatialReference,P);const ie=(yield(0,J.aX)((0,V.im)(M)))[0];if((0,oe.Wi)(ie))throw ae;const K=ie.toJSON(),_=yield(0,j.iV)(K,K.spatialReference,P);if(!_)throw ae;return _.spatialReference=P,h.geometry=_,h})).apply(this,arguments)}function ee(h){return I.apply(this,arguments)}function I(){return(I=(0,Z.Z)(function*(h){const{geometry:F,distance:P,units:C}=h;if(null==P||"vertexAttributes"in F)return F;const M=F.spatialReference,ie=C?z.fromJSON(C):(0,le.qE)(M),K=M&&((0,W.sT)(M)||(0,W.sS)(M))?F:yield(0,j._W)(M,W.Zn).then(()=>(0,j.iV)(F,W.Zn));return(yield v())(K.spatialReference,K,P,ie)})).apply(this,arguments)}function v(){return U.apply(this,arguments)}function U(){return(U=(0,Z.Z)(function*(){return(yield Promise.all([m.e(6536),m.e(8592),m.e(7889)]).then(m.bind(m,47889))).geodesicBuffer})).apply(this,arguments)}function A(h){return h&&L in h?JSON.parse(JSON.stringify(h,se)):h}const L="_geVersion",se=(h,F)=>h!==L?F:void 0},37194:(he,q,m)=>{function oe(g){return!(null!=g.normalizationField||null!=g.normalizationType||null!=g.minValue||null!=g.maxValue||g.sqlExpression&&g.supportsSQLExpression)}function le(g){const R=g.returnDistinct?[...new Set(g.values)]:g.values,E=R.filter(w=>null!=w).length,O={count:E};return g.supportsNullCount&&(O.nullcount=R.length-E),O}function Ie(g){const{values:R,useSampleStdDev:E,supportsNullCount:O}=g;let w=Number.POSITIVE_INFINITY,re=Number.NEGATIVE_INFINITY,de=null,ye=null,ve=null,me=null,ee=0;const I=null==g.minValue?-1/0:g.minValue,v=null==g.maxValue?1/0:g.maxValue;for(const A of R)Number.isFinite(A)?A>=I&&A<=v&&(de+=A,w=Math.min(w,A),re=Math.max(re,A),ee++):"string"==typeof A&&ee++;if(ee&&null!=de){ye=de/ee;let A=0;for(const L of R)Number.isFinite(L)&&L>=I&&L<=v&&(A+=Ge(L-ye,2));me=E?ee>1?A/(ee-1):0:ee>0?A/ee:0,ve=Math.sqrt(me)}else w=null,re=null;const U={avg:ye,count:ee,max:re,min:w,stddev:ve,sum:de,variance:me};return O&&(U.nullcount=R.length-ee),U}function V(g,R){return R&&["avg","stddev","variance"].forEach(E=>{null!=g[E]&&(g[E]=Math.ceil(g[E]))}),g}function J(g,R,E,O){let w=null;switch(R){case"log":0!==g&&(w=Math.log(g)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(O)&&0!==O&&(w=g/O*100);break;case"field":Number.isFinite(E)&&0!==E&&(w=g/E);break;case"natural-log":g>0&&(w=Math.log(g));break;case"square-root":g>0&&(w=Ge(g,.5))}return w}m.d(q,{i5:()=>Ie,H0:()=>le,fk:()=>J,S5:()=>oe,rt:()=>V}),m(22795),m(76009)}}]);