"use strict";var se=Math.pow;(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[1122],{41122:($s,Ee,B)=>{B.r(Ee),B.d(Ee,{WhereClause:()=>oe,defaultAttributeAdapter:()=>$});var Se=B(67474);const Ce={min:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.min.apply(Math,l[0])},max:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.max.apply(Math,l[0])},avg:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Pe(l[0])},sum:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:function(l){let u=0;for(let o=0;o<l.length;o++)u+=l[o];return u}(l[0])},stddev:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.sqrt(Fe(l[0]))},count:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:l[0].length},var:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Fe(l[0])}};function Pe(l){let u=0;for(let o=0;o<l.length;o++)u+=l[o];return u/l.length}function Fe(l){const u=Pe(l),o=l.length;let i=0;for(const p of l)i+=se(p-u,2);return o>1?i/(o-1):0}var Yt=B(9171);class C{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0}static fixDefaults(u){if(null!==u.precision||null!==u.secondary)throw new Error("Primary and Secondary SqlInterval qualifiers not supported")}static createFromMilliseconds(u){const o=new C;return o.second=u/1e3,o}static createFromValueAndQualifer(u,o,i){let p=null;const v=new C;if(v.op="-"===i?"-":"+","interval-period"===o.type){C.fixDefaults(o);const t=new RegExp("^[0-9]{1,}$");if("year"===o.period||"month"===o.period)throw new Error("Year-Month Intervals not supported");if(!t.test(u))throw new Error("Illegal Interval");v[o.period]=parseFloat(u)}else{if(C.fixDefaults(o.start),C.fixDefaults(o.end),"year"===o.start.period||"month"===o.start.period)throw new Error("Year-Month Intervals not supported");if("year"===o.end.period||"month"===o.end.period)throw new Error("Year-Month Intervals not supported");switch(o.start.period){case"day":switch(o.end.period){case"hour":if(p=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!p.test(u))throw new Error("Illegal Interval");v[o.start.period]=parseFloat(u.split(" ")[0]),v[o.end.period]=parseFloat(u.split(" ")[1]);break;case"minute":if(p=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!p.test(u))throw new Error("Illegal Interval");{v[o.start.period]=parseFloat(u.split(" ")[0]);const t=u.split(" ")[1].split(":");v.hour=parseFloat(t[0]),v.minute=parseFloat(t[1])}break;case"second":if(p=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!p.test(u))throw new Error("Illegal Interval");{v[o.start.period]=parseFloat(u.split(" ")[0]);const t=u.split(" ")[1].split(":");v.hour=parseFloat(t[0]),v.minute=parseFloat(t[1]),v.second=parseFloat(t[2])}break;default:throw"Invalid Interval."}break;case"hour":switch(o.end.period){case"minute":if(p=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!p.test(u))throw new Error("Illegal Interval");v.hour=parseFloat(u.split(":")[0]),v.minute=parseFloat(u.split(":")[1]);break;case"second":if(p=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!p.test(u))throw new Error("Illegal Interval");{const t=u.split(":");v.hour=parseFloat(t[0]),v.minute=parseFloat(t[1]),v.second=parseFloat(t[2])}break;default:throw"Invalid Interval."}break;case"minute":if("second"!==o.end.period)throw"Invalid Interval.";if(p=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!p.test(u))throw new Error("Illegal Interval");{const t=u.split(":");v.minute=parseFloat(t[0]),v.second=parseFloat(t[1])}break;default:throw"Invalid Interval."}}return v}valueInMilliseconds(){return("-"===this.op?-1:1)*(1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}function Le(l,u){const o=Me[l.toLowerCase()];if(null==o)throw new Error("Function Not Recognised");if(u.length<o.minParams||u.length>o.maxParams)throw new Error(`Invalid Parameter count for call to ${l.toUpperCase()}`);return o.evaluate(u)}const Me={extract:{minParams:2,maxParams:2,evaluate:([l,u])=>{if(null==u)return null;if(u instanceof Date)switch(l.toUpperCase()){case"SECOND":return u.getSeconds();case"MINUTE":return u.getMinutes();case"HOUR":return u.getHours();case"DAY":return u.getDate();case"MONTH":return u.getMonth()+1;case"YEAR":return u.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:l=>{if(2===l.length){const[u,o]=l;return null==u||null==o?null:u.toString().substring(o-1)}if(3===l.length){const[u,o,i]=l;return null==u||null==o||null==i?null:i<=0?"":u.toString().substring(o-1,o+i-1)}}},position:{minParams:2,maxParams:2,evaluate:([l,u])=>null==l||null==u?null:u.indexOf(l)+1},trim:{minParams:2,maxParams:3,evaluate:l=>{const u=3===l.length,o=u?l[1]:" ",i=u?l[2]:l[1];if(null==o||null==i)return null;const p=`(${(0,Yt.Qs)(o)})`;switch(l[0]){case"BOTH":return i.replace(new RegExp(`^${p}*|${p}*$`,"g"),"");case"LEADING":return i.replace(new RegExp(`^${p}*`,"g"),"");case"TRAILING":return i.replace(new RegExp(`${p}*$`,"g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.abs(l[0])},ceiling:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.ceil(l[0])},floor:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.floor(l[0])},log:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.log(l[0])},log10:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.log(l[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.sin(l[0])},cos:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.cos(l[0])},tan:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.tan(l[0])},asin:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.asin(l[0])},acos:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.acos(l[0])},atan:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.atan(l[0])},sign:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:l[0]>0?1:l[1]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:l=>null==l[0]||null==l[1]?null:se(l[0],l[1])},mod:{minParams:2,maxParams:2,evaluate:l=>null==l[0]||null==l[1]?null:l[0]%l[1]},round:{minParams:1,maxParams:2,evaluate:l=>{const u=l[0],o=2===l.length?se(10,l[1]):1;return null==u?null:Math.round(u*o)/o}},truncate:{minParams:1,maxParams:2,evaluate:l=>null==l[0]?null:1===l.length?parseInt(l[0].toFixed(0),10):parseFloat(l[0].toFixed(l[1]))},char_length:{minParams:1,maxParams:1,evaluate:l=>"string"==typeof l[0]||l[0]instanceof String?l[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:l=>{let u="";for(let o=0;o<l.length;o++){if(null==l[o])return null;u+=l[o].toString()}return u}},lower:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:l[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:l[0].toString().toUpperCase()}};B(90074);var De,Re={exports:{}};(De=Re).exports&&(De.exports=function(){function u(i,p,v,t){this.message=i,this.expected=p,this.found=v,this.location=t,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,u)}return function(i,p){function v(){this.constructor=i}v.prototype=p.prototype,i.prototype=new v}(u,Error),u.buildMessage=function(i,p){var y,v={literal:function(y){return'"'+T(y.text)+'"'},class:function(y){var N,L="";for(N=0;N<y.parts.length;N++)L+=y.parts[N]instanceof Array?I(y.parts[N][0])+"-"+I(y.parts[N][1]):I(y.parts[N]);return"["+(y.inverted?"^":"")+L+"]"},any:function(y){return"any character"},end:function(y){return"end of input"},other:function(y){return y.description}};function t(y){return y.charCodeAt(0).toString(16).toUpperCase()}function T(y){return y.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(N){return"\\x0"+t(N)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(N){return"\\x"+t(N)})}function I(y){return y.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(N){return"\\x0"+t(N)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(N){return"\\x"+t(N)})}function b(y){return v[y.type](y)}return"Expected "+function(y){var N,L,S=new Array(y.length);for(N=0;N<y.length;N++)S[N]=b(y[N]);if(S.sort(),S.length>0){for(N=1,L=1;N<S.length;N++)S[N-1]!==S[N]&&(S[L]=S[N],L++);S.length=L}switch(S.length){case 1:return S[0];case 2:return S[0]+" or "+S[1];default:return S.slice(0,-1).join(", ")+", or "+S[S.length-1]}}(i)+" but "+((y=p)?'"'+T(y)+'"':"end of input")+" found."},{SyntaxError:u,parse:function(i,p){p=void 0!==p?p:{};var v,e,r,a,t={},T={start:dt},I=dt,k=function(e,r){return Ie(e,r)},N=m("!",!1),S=m("=",!1),sr=m(">=",!1),ir=m(">",!1),lr=m("<=",!1),cr=m("<>",!1),pr=m("<",!1),vr=m("!=",!1),Ze=function(e){return e[0]+" "+e[2]},pe=m("+",!1),he=m("-",!1),Ir=m("*",!1),Sr=m("/",!1),Ke=function(e,r){return e+r.join("")},Fr=/^[A-Za-z_\x80-\uFFFF]/,Lr=O([["A","Z"],["a","z"],"_",["\x80","\uffff"]],!1,!1),Mr=/^[A-Za-z0-9_]/,Dr=O([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Or=/^[A-Za-z0-9_.\x80-\uFFFF]/,Rr=O([["A","Z"],["a","z"],["0","9"],"_",".",["\x80","\uffff"]],!1,!1),Jr=m("@",!1),Qe=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},Xe=function(e,r){return{type:"interval-period",period:"second",precision:e,secondary:r}},et=function(e){return parseFloat(e)},rt=m("'",!1),pn=m("N'",!1),j="''",at=m("''",!1),st=/^[^']/,ot=O(["'"],!0,!1),it=function(e,r){return{type:"when_clause",operand:e,value:r}},En=m(".",!1),Fn=/^[0-9]/,Ln=O([["0","9"]],!1,!1),Mn=/^[eE]/,Dn=O(["e","E"],!1,!1),On=/^[+\-]/,Rn=O(["+","-"],!1,!1),$n=m("NULL",!0),Hn=m("TRUE",!0),Vn=m("FALSE",!0),Wn=m("IN",!0),Yn=m("IS",!0),zn=m("LIKE",!0),Xn=m("ESCAPE",!0),ra=m("NOT",!0),ua=m("AND",!0),ia=m("OR",!0),fa=m("BETWEEN",!0),ha=m("FROM",!0),ga=m("FOR",!0),Na=m("SUBSTRING",!0),xa=m("EXTRACT",!0),Ea=m("TRIM",!0),Pa=m("POSITION",!0),Ma=m("TIMESTAMP",!0),Ra=m("DATE",!0),$a=m("LEADING",!0),Ua=m("TRAILING",!0),Wa=m("BOTH",!0),Ya=m("TO",!0),za=m("INTERVAL",!0),Xa=m("YEAR",!0),ru=m("MONTH",!0),uu=m("DAY",!0),iu=m("HOUR",!0),fu=m("MINUTE",!0),hu=m("SECOND",!0),gu=m("CASE",!0),Nu=m("END",!0),xu=m("WHEN",!0),Eu=m("THEN",!0),Pu=m("ELSE",!0),Mu=m(",",!1),Ou=m("(",!1),_u=m(")",!1),Ju=/^[ \t\n\r]/,$u=O([" ","\t","\n","\r"],!1,!1),ct=m("`",!1),ft=/^[^`]/,pt=O(["`"],!0,!1),n=0,Z=[{line:1,column:1}],M=0,de=[],c=0;if("startRule"in p){if(!(p.startRule in T))throw new Error("Can't start parsing from rule \""+p.startRule+'".');I=T[p.startRule]}function m(e,r){return{type:"literal",text:e,ignoreCase:r}}function O(e,r,a){return{type:"class",parts:e,inverted:r,ignoreCase:a}}function vt(e){var r,a=Z[e];if(a)return a;for(r=e-1;!Z[r];)r--;for(a={line:(a=Z[r]).line,column:a.column};r<e;)10===i.charCodeAt(r)?(a.line++,a.column=1):a.column++,r++;return Z[e]=a,a}function h(e){n<M||(n>M&&(M=n,de=[]),de.push(e))}function dt(){var e,r;return e=n,f()!==t&&(r=E())!==t&&f()!==t?e=r:(n=e,e=t),e}function mt(){var e,r,a,s,d,w,x,A;if(e=n,(r=E())!==t){for(a=[],s=n,(d=f())!==t&&(w=ue())!==t&&(x=f())!==t&&(A=E())!==t?s=d=[d,w,x,A]:(n=s,s=t);s!==t;)a.push(s),s=n,(d=f())!==t&&(w=ue())!==t&&(x=f())!==t&&(A=E())!==t?s=d=[d,w,x,A]:(n=s,s=t);a!==t?e=r=function(e,r){var a={type:"expr_list"},s=function(e,r,a){return function(e,r){for(var a=[e],s=0;s<r.length;s++)a.push(r[s][3]);return a}(e,r)}(e,r);return a.value=s,a}(r,a):(n=e,e=t)}else n=e,e=t;return e}function E(){var e,r,a,s,d,w,x,A;if(e=n,(r=me())!==t){for(a=[],s=n,(d=f())!==t&&(w=Lt())!==t&&(x=f())!==t&&(A=me())!==t?s=d=[d,w,x,A]:(n=s,s=t);s!==t;)a.push(s),s=n,(d=f())!==t&&(w=Lt())!==t&&(x=f())!==t&&(A=me())!==t?s=d=[d,w,x,A]:(n=s,s=t);a!==t?e=r=k(r,a):(n=e,e=t)}else n=e,e=t;return e}function me(){var e,r,a,s,d,w,x,A;if(e=n,(r=z())!==t){for(a=[],s=n,(d=f())!==t&&(w=re())!==t&&(x=f())!==t&&(A=z())!==t?s=d=[d,w,x,A]:(n=s,s=t);s!==t;)a.push(s),s=n,(d=f())!==t&&(w=re())!==t&&(x=f())!==t&&(A=z())!==t?s=d=[d,w,x,A]:(n=s,s=t);a!==t?e=r=k(r,a):(n=e,e=t)}else n=e,e=t;return e}function z(){var e,r,a,s,d;return e=n,(r=q())===t&&(r=n,33===i.charCodeAt(n)?(a="!",n++):(a=t,0===c&&h(N)),a!==t?(s=n,c++,61===i.charCodeAt(n)?(d="=",n++):(d=t,0===c&&h(S)),c--,d===t?s=void 0:(n=s,s=t),s!==t?r=a=[a,s]:(n=r,r=t)):(n=r,r=t)),r!==t&&(a=f())!==t&&(s=z())!==t?e=r=function(e){return function(e,r){return{type:"unary_expr",operator:"NOT",expr:r}}(0,e)}(s):(n=e,e=t),e===t&&(e=function(){var e,r,a;return e=n,(r=R())!==t&&f()!==t?((a=function(){var e;return(e=function(){var e,r,a,s,d,w;if(e=[],r=n,(a=f())!==t&&(s=gt())!==t&&(d=f())!==t&&(w=R())!==t?r=a=[a,s,d,w]:(n=r,r=t),r!==t)for(;r!==t;)e.push(r),r=n,(a=f())!==t&&(s=gt())!==t&&(d=f())!==t&&(w=R())!==t?r=a=[a,s,d,w]:(n=r,r=t);else e=t;return e!==t&&(e=function(e){return{type:"arithmetic",tail:e}}(e)),e}())===t&&(e=function(){var e,r,a,s;return e=n,(r=ge())!==t&&f()!==t&&(a=P())!==t&&f()!==t&&(s=mt())!==t&&f()!==t&&F()!==t?e=r=function(e,r){return{op:e,right:r}}(r,s):(n=e,e=t),e===t&&(e=n,(r=ge())!==t&&f()!==t&&(a=P())!==t&&f()!==t&&(s=F())!==t?e=r=function(e){return{op:e,right:{type:"expr_list",value:[]}}}(r):(n=e,e=t),e===t&&(e=n,(r=ge())!==t&&f()!==t&&(a=be())!==t?e=r=function(e,r){return{op:e,right:r}}(r,a):(n=e,e=t))),e}())===t&&(e=function(){var e,r,a,s,d,w;return e=n,(r=q())!==t&&f()!==t&&(a=Mt())!==t&&f()!==t&&(s=R())!==t&&f()!==t&&(d=re())!==t&&f()!==t&&(w=R())!==t?e=r=function(e,r,a){return{op:"NOT"+e,right:{type:"expr_list",value:[r,a]}}}(a,s,w):(n=e,e=t),e===t&&(e=n,(r=Mt())!==t&&f()!==t&&(a=R())!==t&&f()!==t&&(s=re())!==t&&f()!==t&&(d=R())!==t?e=r=function(e,r,a){return{op:e,right:{type:"expr_list",value:[r,a]}}}(r,a,d):(n=e,e=t)),e}())===t&&(e=function(){var e,r,a,s;return e=n,(r=Pt())!==t&&f()!==t&&(a=q())!==t&&f()!==t&&(s=R())!==t?e=r=function(e,r){return{op:e+"NOT",right:r}}(r,s):(n=e,e=t),e===t&&(e=n,(r=Pt())!==t&&f()!==t&&(a=R())!==t?e=r=function(e,r){return{op:e,right:r}}(r,a):(n=e,e=t)),e}())===t&&(e=function(){var e,r,a,s;return e=n,(r=wt())!==t&&f()!==t&&(a=U())!==t&&f()!==t&&function(){var e,r,a,s;return e=n,"escape"===i.substr(n,6).toLowerCase()?(r=i.substr(n,6),n+=6):(r=t,0===c&&h(Xn)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="ESCAPE":(n=e,e=t)):(n=e,e=t),e}()!==t&&f()!==t&&(s=Te())!==t?e=r=function(e,r,a){return{op:e,right:r,escape:a.value}}(r,a,s):(n=e,e=t),e===t&&(e=n,(r=wt())!==t&&f()!==t&&(a=U())!==t?e=r=function(e,r){return{op:e,right:r,escape:""}}(r,a):(n=e,e=t)),e}()),e}())===t&&(a=null),a!==t?e=r=function(e,r){return""==r||null==r||null==r?e:"arithmetic"==r.type?Ie(e,r.tail):Bt(r.op,e,r.right,r.escape)}(r,a):(n=e,e=t)):(n=e,e=t),e}()),e}function gt(){var e;return">="===i.substr(n,2)?(e=">=",n+=2):(e=t,0===c&&h(sr)),e===t&&(62===i.charCodeAt(n)?(e=">",n++):(e=t,0===c&&h(ir)),e===t&&("<="===i.substr(n,2)?(e="<=",n+=2):(e=t,0===c&&h(lr)),e===t&&("<>"===i.substr(n,2)?(e="<>",n+=2):(e=t,0===c&&h(cr)),e===t&&(60===i.charCodeAt(n)?(e="<",n++):(e=t,0===c&&h(pr)),e===t&&(61===i.charCodeAt(n)?(e="=",n++):(e=t,0===c&&h(S)),e===t&&("!="===i.substr(n,2)?(e="!=",n+=2):(e=t,0===c&&h(vr)))))))),e}function wt(){var e,r,a,s,d;return e=n,r=n,(a=q())!==t&&(s=f())!==t&&(d=Ft())!==t?r=a=[a,s,d]:(n=r,r=t),r!==t&&(r=Ze(r)),(e=r)===t&&(e=Ft()),e}function ge(){var e,r,a,s,d;return e=n,r=n,(a=q())!==t&&(s=f())!==t&&(d=xe())!==t?r=a=[a,s,d]:(n=r,r=t),r!==t&&(r=Ze(r)),(e=r)===t&&(e=xe()),e}function R(){var e,r,a,s,d,w,x,A;if(e=n,(r=we())!==t){for(a=[],s=n,(d=f())!==t&&(w=yt())!==t&&(x=f())!==t&&(A=we())!==t?s=d=[d,w,x,A]:(n=s,s=t);s!==t;)a.push(s),s=n,(d=f())!==t&&(w=yt())!==t&&(x=f())!==t&&(A=we())!==t?s=d=[d,w,x,A]:(n=s,s=t);a!==t?e=r=k(r,a):(n=e,e=t)}else n=e,e=t;return e}function yt(){var e;return 43===i.charCodeAt(n)?(e="+",n++):(e=t,0===c&&h(pe)),e===t&&(45===i.charCodeAt(n)?(e="-",n++):(e=t,0===c&&h(he))),e}function we(){var e,r,a,s,d,w,x,A;if(e=n,(r=ye())!==t){for(a=[],s=n,(d=f())!==t&&(w=Nt())!==t&&(x=f())!==t&&(A=ye())!==t?s=d=[d,w,x,A]:(n=s,s=t);s!==t;)a.push(s),s=n,(d=f())!==t&&(w=Nt())!==t&&(x=f())!==t&&(A=ye())!==t?s=d=[d,w,x,A]:(n=s,s=t);a!==t?e=r=function(e,r){return Ie(e,r)}(r,a):(n=e,e=t)}else n=e,e=t;return e}function Nt(){var e;return 42===i.charCodeAt(n)?(e="*",n++):(e=t,0===c&&h(Ir)),e===t&&(47===i.charCodeAt(n)?(e="/",n++):(e=t,0===c&&h(Sr))),e}function ye(){var e,r;return(e=function(){var e;return(e=Te())===t&&(e=function(){var e,r,a,s;return e=n,(r=function(){var e,r,a,s;return e=n,(r=te())!==t&&(a=Et())!==t&&(s=St())!==t?e=r=function(e,r,a){return parseFloat(e+r+a)}(r,a,s):(n=e,e=t),e===t&&(e=n,(r=te())!==t&&(a=Et())!==t?e=r=function(e,r){return parseFloat(e+r)}(r,a):(n=e,e=t),e===t&&(e=n,(r=te())!==t&&(a=St())!==t?e=r=function(e,r){return parseFloat(e+r)}(r,a):(n=e,e=t),e===t&&(e=n,(r=te())!==t&&(r=function(e){return parseFloat(e)}(r)),e=r))),e}())!==t?(a=n,c++,s=Ne(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r=function(e){return{type:"number",value:e}}(r):(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function(){var e,r;return e=n,(r=function(){var e,r,a,s;return e=n,"true"===i.substr(n,4).toLowerCase()?(r=i.substr(n,4),n+=4):(r=t,0===c&&h(Hn)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r=[r,a]:(n=e,e=t)):(n=e,e=t),e}())!==t&&(r={type:"bool",value:!0}),(e=r)===t&&(e=n,(r=function(){var e,r,a,s;return e=n,"false"===i.substr(n,5).toLowerCase()?(r=i.substr(n,5),n+=5):(r=t,0===c&&h(Vn)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r=[r,a]:(n=e,e=t)):(n=e,e=t),e}())!==t&&(r={type:"bool",value:!1}),e=r),e}())===t&&(e=function(){var e;return(e=function(){var e,r,a,s;return e=n,"null"===i.substr(n,4).toLowerCase()?(r=i.substr(n,4),n+=4):(r=t,0===c&&h($n)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r=[r,a]:(n=e,e=t)):(n=e,e=t),e}())!==t&&(e={type:"null",value:null}),e}())===t&&(e=function(){var e,r;return e=n,function(){var e,r,a,s;return e=n,"date"===i.substr(n,4).toLowerCase()?(r=i.substr(n,4),n+=4):(r=t,0===c&&h(Ra)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="DATE":(n=e,e=t)):(n=e,e=t),e}()!==t&&f()!==t&&(r=U())!==t?e=function(e){return{type:"date",value:e.value}}(r):(n=e,e=t),e}())===t&&(e=function(){var e,r;return e=n,function(){var e,r,a,s;return e=n,"timestamp"===i.substr(n,9).toLowerCase()?(r=i.substr(n,9),n+=9):(r=t,0===c&&h(Ma)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="TIMESTAMP":(n=e,e=t)):(n=e,e=t),e}()!==t&&f()!==t&&(r=U())!==t?e=function(e){return{type:"timestamp",value:e.value}}(r):(n=e,e=t),e}())===t&&(e=function(){var e,r,a,s;return e=n,Ot()!==t&&f()!==t?(45===i.charCodeAt(n)?(r="-",n++):(r=t,0===c&&h(he)),r===t&&(43===i.charCodeAt(n)?(r="+",n++):(r=t,0===c&&h(pe))),r!==t&&f()!==t&&(a=U())!==t&&f()!==t&&(s=At())!==t?e=function(e,r,a){return{type:"interval",value:r,qualifier:a,op:e}}(r,a,s):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,Ot()!==t&&f()!==t&&(r=U())!==t&&f()!==t&&(a=At())!==t?e=function(e,r){return{type:"interval",value:e,qualifier:r,op:""}}(r,a):(n=e,e=t)),e}()),e}())===t&&(e=function(){var e,r,a;return e=n,function(){var e,r,a,s;return e=n,"extract"===i.substr(n,7).toLowerCase()?(r=i.substr(n,7),n+=7):(r=t,0===c&&h(xa)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="EXTRACT":(n=e,e=t)):(n=e,e=t),e}()!==t&&f()!==t&&P()!==t&&f()!==t&&(r=function(){var e;return(e=Rt())===t&&(e=_t())===t&&(e=Jt())===t&&(e=$t())===t&&(e=kt())===t&&(e=H()),e}())!==t&&f()!==t&&Ae()!==t&&f()!==t&&(a=E())!==t&&f()!==t&&F()!==t?e=function(e,r){return{type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:e},r]}}}(r,a):(n=e,e=t),e}())===t&&(e=function(){var e,r,a,s,d,w,x,A;return e=n,function(){var e,r,a,s;return e=n,"substring"===i.substr(n,9).toLowerCase()?(r=i.substr(n,9),n+=9):(r=t,0===c&&h(Na)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="SUBSTRING":(n=e,e=t)):(n=e,e=t),e}()!==t&&f()!==t&&P()!==t&&f()!==t&&(r=E())!==t&&f()!==t&&Ae()!==t&&f()!==t&&(a=E())!==t&&f()!==t?(s=n,(d=function(){var e,r,a,s;return e=n,"for"===i.substr(n,3).toLowerCase()?(r=i.substr(n,3),n+=3):(r=t,0===c&&h(ga)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="FOR":(n=e,e=t)):(n=e,e=t),e}())!==t&&(w=f())!==t&&(x=E())!==t&&(A=f())!==t?s=d=[d,w,x,A]:(n=s,s=t),s===t&&(s=null),s!==t&&(d=F())!==t?e=function(e,r,a){return{type:"function",name:"substring",args:{type:"expr_list",value:a?[e,r,a[2]]:[e,r]}}}(r,a,s):(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function(){var e,r,a,s;return e=n,Dt()!==t&&f()!==t&&P()!==t&&f()!==t?((r=xt())===t&&(r=null),r!==t&&f()!==t&&(a=E())!==t&&f()!==t&&Ae()!==t&&f()!==t&&(s=E())!==t&&f()!==t&&F()!==t?e=function(e,r,a){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},r,a]}}}(r,a,s):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,Dt()!==t&&f()!==t&&P()!==t&&f()!==t?((r=xt())===t&&(r=null),r!==t&&f()!==t&&(a=E())!==t&&f()!==t&&F()!==t?e=function(e,r){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},r]}}}(r,a):(n=e,e=t)):(n=e,e=t)),e}())===t&&(e=function(){var e,r,a;return e=n,function(){var e,r,a,s;return e=n,"position"===i.substr(n,8).toLowerCase()?(r=i.substr(n,8),n+=8):(r=t,0===c&&h(Pa)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="POSITION":(n=e,e=t)):(n=e,e=t),e}()!==t&&f()!==t&&P()!==t&&f()!==t&&(r=E())!==t&&f()!==t&&xe()!==t&&f()!==t&&(a=E())!==t&&f()!==t&&F()!==t?e=function(e,r){return{type:"function",name:"position",args:{type:"expr_list",value:[e,r]}}}(r,a):(n=e,e=t),e}())===t&&(e=function(){var e,r,a;return e=n,(r=function(){var e,r,a,s;if(e=n,(r=bt())!==t&&(r=r),(e=r)===t)if(e=n,96===i.charCodeAt(n)?(r="`",n++):(r=t,0===c&&h(ct)),r!==t){if(a=[],ft.test(i.charAt(n))?(s=i.charAt(n),n++):(s=t,0===c&&h(pt)),s!==t)for(;s!==t;)a.push(s),ft.test(i.charAt(n))?(s=i.charAt(n),n++):(s=t,0===c&&h(pt));else a=t;a!==t?(96===i.charCodeAt(n)?(s="`",n++):(s=t,0===c&&h(ct)),s!==t?e=r=function(e){return e.join("")}(a):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}())!==t&&f()!==t&&P()!==t&&f()!==t?((a=mt())===t&&(a=null),a!==t&&f()!==t&&F()!==t?e=r=function(e,r){return{type:"function",name:e,args:r||{type:"expr_list",value:[]}}}(r,a):(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function(){var e;return(e=function(){var e,r,a,s,d;if(e=n,ne()!==t)if(f()!==t)if((r=E())!==t)if(f()!==t){for(a=[],s=ee();s!==t;)a.push(s),s=ee();a!==t&&(s=f())!==t&&(d=ae())!==t?e=function(e,r){return{type:"case_expression",format:"simple",operand:e,clauses:r,else:null}}(r,a):(n=e,e=t)}else n=e,e=t;else n=e,e=t;else n=e,e=t;else n=e,e=t;if(e===t)if(e=n,ne()!==t)if(f()!==t)if((r=E())!==t)if(f()!==t){for(a=[],s=ee();s!==t;)a.push(s),s=ee();a!==t&&(s=f())!==t&&(d=It())!==t&&f()!==t&&ae()!==t?e=function(e,r,a){return{type:"case_expression",format:"simple",operand:e,clauses:r,else:a.value}}(r,a,d):(n=e,e=t)}else n=e,e=t;else n=e,e=t;else n=e,e=t;else n=e,e=t;return e}())===t&&(e=function(){var e,r,a,s;if(e=n,ne()!==t)if(f()!==t){for(r=[],a=X();a!==t;)r.push(a),a=X();r!==t&&(a=f())!==t&&(s=ae())!==t?e=function(e){return{type:"case_expression",format:"searched",clauses:e,else:null}}(r):(n=e,e=t)}else n=e,e=t;else n=e,e=t;if(e===t)if(e=n,ne()!==t)if(f()!==t){for(r=[],a=X();a!==t;)r.push(a),a=X();r!==t&&(a=f())!==t&&(s=It())!==t&&f()!==t&&ae()!==t?e=function(e,r){return{type:"case_expression",format:"searched",clauses:e,else:r.value}}(r,s):(n=e,e=t)}else n=e,e=t;else n=e,e=t;return e}()),e}())===t&&(e=function(){var e;return(e=function(){var e;return(e=function(){var e,r,a,s;if(e=n,(r=Ne())!==t){for(a=[],s=Tt();s!==t;)a.push(s),s=Tt();a!==t?e=r=Ke(r,a):(n=e,e=t)}else n=e,e=t;return e}())!==t&&(e=e),e}())!==t&&(e=function(e){return/^CURRENT_DATE$/i.test(e)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(e)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:e}}(e)),e}())===t&&(e=be())===t&&(e=n,P()!==t&&f()!==t&&(r=E())!==t&&f()!==t&&F()!==t?e=function(e){return e.paren=!0,e}(r):(n=e,e=t)),e}function bt(){var e,r,a,s;if(e=n,(r=Ne())!==t){for(a=[],s=g();s!==t;)a.push(s),s=g();a!==t?e=r=Ke(r,a):(n=e,e=t)}else n=e,e=t;return e}function Ne(){var e;return Fr.test(i.charAt(n))?(e=i.charAt(n),n++):(e=t,0===c&&h(Lr)),e}function g(){var e;return Mr.test(i.charAt(n))?(e=i.charAt(n),n++):(e=t,0===c&&h(Dr)),e}function Tt(){var e;return Or.test(i.charAt(n))?(e=i.charAt(n),n++):(e=t,0===c&&h(Rr)),e}function be(){var e,r,a;return e=n,64===i.charCodeAt(n)?(r="@",n++):(r=t,0===c&&h(Jr)),r!==t&&(a=bt())!==t?e=r=[r,a]:(n=e,e=t),e!==t&&(e=function(e){return{type:"param",value:e[1]}}(e)),e}function xt(){var e;return(e=function(){var e,r,a,s;return e=n,"leading"===i.substr(n,7).toLowerCase()?(r=i.substr(n,7),n+=7):(r=t,0===c&&h($a)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="LEADING":(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function(){var e,r,a,s;return e=n,"trailing"===i.substr(n,8).toLowerCase()?(r=i.substr(n,8),n+=8):(r=t,0===c&&h(Ua)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="TRAILING":(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function(){var e,r,a,s;return e=n,"both"===i.substr(n,4).toLowerCase()?(r=i.substr(n,4),n+=4):(r=t,0===c&&h(Wa)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="BOTH":(n=e,e=t)):(n=e,e=t),e}()),e}function At(){var e,r,a;return e=n,(r=function(){var e,r,a;return e=n,(r=G())!==t&&f()!==t&&P()!==t&&f()!==t&&(a=Q())!==t&&f()!==t&&F()!==t?e=r=function(e,r){return{type:"interval-period",period:e.value,precision:r,secondary:null}}(r,a):(n=e,e=t),e===t&&(e=n,(r=G())!==t&&(r=Qe(r)),e=r),e}())!==t&&f()!==t&&function(){var e,r,a,s;return e=n,"to"===i.substr(n,2).toLowerCase()?(r=i.substr(n,2),n+=2):(r=t,0===c&&h(Ya)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="TO":(n=e,e=t)):(n=e,e=t),e}()!==t&&f()!==t&&(a=function(){var e,r,a,s;return e=n,(r=G())!==t&&(r=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}}(r)),(e=r)===t&&(e=n,(r=H())!==t&&f()!==t&&P()!==t&&f()!==t&&(a=Q())!==t&&f()!==t&&ue()!==t&&f()!==t&&(s=K())!==t&&f()!==t&&F()!==t?e=r=Xe(a,s):(n=e,e=t),e===t&&(e=n,(r=H())!==t&&f()!==t&&P()!==t&&f()!==t&&(a=Q())!==t&&f()!==t&&F()!==t?e=r=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}}(a):(n=e,e=t),e===t&&(e=n,(r=H())!==t&&(r={type:"interval-period",period:"second",precision:null,secondary:null}),e=r))),e}())!==t?e=r=function(e,r){return{type:"interval-qualifier",start:e,end:r}}(r,a):(n=e,e=t),e===t&&(e=function(){var e,r,a,s;return e=n,(r=G())!==t&&f()!==t&&P()!==t&&f()!==t&&(a=K())!==t&&f()!==t&&F()!==t?e=r=function(e,r){return{type:"interval-period",period:e.value,precision:r,secondary:null}}(r,a):(n=e,e=t),e===t&&(e=n,(r=G())!==t&&(r=Qe(r)),(e=r)===t&&(e=n,(r=H())!==t&&f()!==t&&P()!==t&&f()!==t&&(a=Q())!==t&&f()!==t&&ue()!==t&&f()!==t&&(s=K())!==t&&f()!==t&&F()!==t?e=r=Xe(a,s):(n=e,e=t),e===t&&(e=n,(r=H())!==t&&f()!==t&&P()!==t&&f()!==t&&(a=K())!==t&&f()!==t&&F()!==t?e=r=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}}(a):(n=e,e=t),e===t&&(e=n,(r=H())!==t&&(r={type:"interval-period",period:"second",precision:null,secondary:null}),e=r)))),e}()),e}function G(){var e,r;return e=n,(r=Jt())!==t&&(r={type:"string",value:"day"}),(e=r)===t&&(e=n,(r=$t())!==t&&(r={type:"string",value:"hour"}),(e=r)===t&&(e=n,(r=kt())!==t&&(r={type:"string",value:"minute"}),(e=r)===t&&(e=n,(r=_t())!==t&&(r={type:"string",value:"month"}),(e=r)===t&&(e=n,(r=Rt())!==t&&(r={type:"string",value:"year"}),e=r)))),e}function K(){var e;return(e=V())!==t&&(e=et(e)),e}function Q(){var e;return(e=V())!==t&&(e=et(e)),e}function U(){var e;return(e=Te())===t&&(e=be()),e}function Te(){var e,r,a,s,d;if(e=n,39===i.charCodeAt(n)?(r="'",n++):(r=t,0===c&&h(rt)),r===t&&("N'"===i.substr(n,2)?(r="N'",n+=2):(r=t,0===c&&h(pn))),r!==t){for(a=[],s=n,i.substr(n,2)===j?(d=j,n+=2):(d=t,0===c&&h(at)),d!==t&&(d="'"),(s=d)===t&&(st.test(i.charAt(n))?(s=i.charAt(n),n++):(s=t,0===c&&h(ot)));s!==t;)a.push(s),s=n,i.substr(n,2)===j?(d=j,n+=2):(d=t,0===c&&h(at)),d!==t&&(d="'"),(s=d)===t&&(st.test(i.charAt(n))?(s=i.charAt(n),n++):(s=t,0===c&&h(ot)));a!==t?(39===i.charCodeAt(n)?(s="'",n++):(s=t,0===c&&h(rt)),s!==t?e=r=function(e){return{type:"string",value:e.join("")}}(a):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}function X(){var e,r,a;return e=n,Ht()!==t&&f()!==t&&(r=E())!==t&&f()!==t&&Ut()!==t&&f()!==t&&(a=E())!==t?e=it(r,a):(n=e,e=t),e}function ee(){var e,r,a;return e=n,Ht()!==t&&f()!==t&&(r=E())!==t&&f()!==t&&Ut()!==t&&f()!==t&&(a=E())!==t?e=it(r,a):(n=e,e=t),e}function It(){var e,r;return e=n,function(){var e,r,a,s;return e=n,"else"===i.substr(n,4).toLowerCase()?(r=i.substr(n,4),n+=4):(r=t,0===c&&h(Pu)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="ELSE":(n=e,e=t)):(n=e,e=t),e}()!==t&&f()!==t&&(r=E())!==t?e=function(e){return{type:"else_clause",value:e}}(r):(n=e,e=t),e}function te(){var e,r,a;return(e=V())===t&&(e=n,45===i.charCodeAt(n)?(r="-",n++):(r=t,0===c&&h(he)),r===t&&(43===i.charCodeAt(n)?(r="+",n++):(r=t,0===c&&h(pe))),r!==t&&(a=V())!==t?e=r=function(e,r){return e[0]+r}(r,a):(n=e,e=t)),e}function Et(){var e,r,a;return e=n,46===i.charCodeAt(n)?(r=".",n++):(r=t,0===c&&h(En)),r!==t?((a=V())===t&&(a=null),a!==t?e=r=function(e){return"."+(null!=e?e:"")}(a):(n=e,e=t)):(n=e,e=t),e}function St(){var e,r,a;return e=n,(r=function(){var e,r,a;return e=n,Mn.test(i.charAt(n))?(r=i.charAt(n),n++):(r=t,0===c&&h(Dn)),r!==t?(On.test(i.charAt(n))?(a=i.charAt(n),n++):(a=t,0===c&&h(Rn)),a===t&&(a=null),a!==t?e=r=function(e,r){return"e"+(null===r?"":r)}(0,a):(n=e,e=t)):(n=e,e=t),e}())!==t&&(a=V())!==t?e=r=function(e,r){return e+r}(r,a):(n=e,e=t),e}function V(){var e,r;if(e=[],(r=Ct())!==t)for(;r!==t;)e.push(r),r=Ct();else e=t;return e!==t&&(e=function(e){return e.join("")}(e)),e}function Ct(){var e;return Fn.test(i.charAt(n))?(e=i.charAt(n),n++):(e=t,0===c&&h(Ln)),e}function xe(){var e,r,a,s;return e=n,"in"===i.substr(n,2).toLowerCase()?(r=i.substr(n,2),n+=2):(r=t,0===c&&h(Wn)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="IN":(n=e,e=t)):(n=e,e=t),e}function Pt(){var e,r,a,s;return e=n,"is"===i.substr(n,2).toLowerCase()?(r=i.substr(n,2),n+=2):(r=t,0===c&&h(Yn)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="IS":(n=e,e=t)):(n=e,e=t),e}function Ft(){var e,r,a,s;return e=n,"like"===i.substr(n,4).toLowerCase()?(r=i.substr(n,4),n+=4):(r=t,0===c&&h(zn)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="LIKE":(n=e,e=t)):(n=e,e=t),e}function q(){var e,r,a,s;return e=n,"not"===i.substr(n,3).toLowerCase()?(r=i.substr(n,3),n+=3):(r=t,0===c&&h(ra)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="NOT":(n=e,e=t)):(n=e,e=t),e}function re(){var e,r,a,s;return e=n,"and"===i.substr(n,3).toLowerCase()?(r=i.substr(n,3),n+=3):(r=t,0===c&&h(ua)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="AND":(n=e,e=t)):(n=e,e=t),e}function Lt(){var e,r,a,s;return e=n,"or"===i.substr(n,2).toLowerCase()?(r=i.substr(n,2),n+=2):(r=t,0===c&&h(ia)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="OR":(n=e,e=t)):(n=e,e=t),e}function Mt(){var e,r,a,s;return e=n,"between"===i.substr(n,7).toLowerCase()?(r=i.substr(n,7),n+=7):(r=t,0===c&&h(fa)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="BETWEEN":(n=e,e=t)):(n=e,e=t),e}function Ae(){var e,r,a,s;return e=n,"from"===i.substr(n,4).toLowerCase()?(r=i.substr(n,4),n+=4):(r=t,0===c&&h(ha)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="FROM":(n=e,e=t)):(n=e,e=t),e}function Dt(){var e,r,a,s;return e=n,"trim"===i.substr(n,4).toLowerCase()?(r=i.substr(n,4),n+=4):(r=t,0===c&&h(Ea)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="TRIM":(n=e,e=t)):(n=e,e=t),e}function Ot(){var e,r,a,s;return e=n,"interval"===i.substr(n,8).toLowerCase()?(r=i.substr(n,8),n+=8):(r=t,0===c&&h(za)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="INTERVAL":(n=e,e=t)):(n=e,e=t),e}function Rt(){var e,r,a,s;return e=n,"year"===i.substr(n,4).toLowerCase()?(r=i.substr(n,4),n+=4):(r=t,0===c&&h(Xa)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="YEAR":(n=e,e=t)):(n=e,e=t),e}function _t(){var e,r,a,s;return e=n,"month"===i.substr(n,5).toLowerCase()?(r=i.substr(n,5),n+=5):(r=t,0===c&&h(ru)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="MONTH":(n=e,e=t)):(n=e,e=t),e}function Jt(){var e,r,a,s;return e=n,"day"===i.substr(n,3).toLowerCase()?(r=i.substr(n,3),n+=3):(r=t,0===c&&h(uu)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="DAY":(n=e,e=t)):(n=e,e=t),e}function $t(){var e,r,a,s;return e=n,"hour"===i.substr(n,4).toLowerCase()?(r=i.substr(n,4),n+=4):(r=t,0===c&&h(iu)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="HOUR":(n=e,e=t)):(n=e,e=t),e}function kt(){var e,r,a,s;return e=n,"minute"===i.substr(n,6).toLowerCase()?(r=i.substr(n,6),n+=6):(r=t,0===c&&h(fu)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="MINUTE":(n=e,e=t)):(n=e,e=t),e}function H(){var e,r,a,s;return e=n,"second"===i.substr(n,6).toLowerCase()?(r=i.substr(n,6),n+=6):(r=t,0===c&&h(hu)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="SECOND":(n=e,e=t)):(n=e,e=t),e}function ne(){var e,r,a,s;return e=n,"case"===i.substr(n,4).toLowerCase()?(r=i.substr(n,4),n+=4):(r=t,0===c&&h(gu)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="CASE":(n=e,e=t)):(n=e,e=t),e}function ae(){var e,r,a,s;return e=n,"end"===i.substr(n,3).toLowerCase()?(r=i.substr(n,3),n+=3):(r=t,0===c&&h(Nu)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="END":(n=e,e=t)):(n=e,e=t),e}function Ht(){var e,r,a,s;return e=n,"when"===i.substr(n,4).toLowerCase()?(r=i.substr(n,4),n+=4):(r=t,0===c&&h(xu)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="WHEN":(n=e,e=t)):(n=e,e=t),e}function Ut(){var e,r,a,s;return e=n,"then"===i.substr(n,4).toLowerCase()?(r=i.substr(n,4),n+=4):(r=t,0===c&&h(Eu)),r!==t?(a=n,c++,s=g(),c--,s===t?a=void 0:(n=a,a=t),a!==t?e=r="THEN":(n=e,e=t)):(n=e,e=t),e}function ue(){var e;return 44===i.charCodeAt(n)?(e=",",n++):(e=t,0===c&&h(Mu)),e}function P(){var e;return 40===i.charCodeAt(n)?(e="(",n++):(e=t,0===c&&h(Ou)),e}function F(){var e;return 41===i.charCodeAt(n)?(e=")",n++):(e=t,0===c&&h(_u)),e}function f(){var e,r;for(e=[],r=Vt();r!==t;)e.push(r),r=Vt();return e}function Vt(){var e;return Ju.test(i.charAt(n))?(e=i.charAt(n),n++):(e=t,0===c&&h($u)),e}function Bt(e,r,a,s){var d={type:"binary_expr",operator:e,left:r,right:a};return void 0!==s&&(d.escape=s),d}function Ie(e,r){for(var a=e,s=0;s<r.length;s++)a=Bt(r[s][1],a,r[s][3]);return a}if((v=I())!==t&&n===i.length)return v;throw v!==t&&n<i.length&&h({type:"end"}),e=de,r=M<i.length?i.charAt(M):null,a=function(e,r){var a=vt(e),s=vt(r);return{start:{offset:e,line:a.line,column:a.column},end:{offset:r,line:s.line,column:s.column}}}(M,M<i.length?M+1:M),new u(u.buildMessage(e,r),e,r,a)}}}());const _e=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,zt=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,Kt=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,Qt=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,Xt=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,er=new Set(["current_timestamp","current_date","current_time"]);function J(l,u){return(l+="").length>=u?l:new Array(u-l.length+1).join("0")+l}function W(l,u,o="0",i="0",p="0",v="0",t="",T="0",I="0"){if("+"===t||"-"===t){const b=`${J(parseInt(l,10),4)}-${J(parseInt(u,10),2)}-${J(parseInt(o,10),2)}`;let _="";parseFloat(v)<10&&(_="0");const k=`${J(parseInt(i,10),2)}:${J(parseInt(p,10),2)}:${_+parseFloat(v).toString()}`,y=`${t}${J(parseInt(T,10),2)}:${J(parseInt(I,10),2)}`;return new Date(b+"T"+k+y)}return new Date(parseInt(l,10),parseInt(u,10)-1,parseInt(o,10),parseInt(i,10),parseInt(p,10),parseFloat(v))}class tr{static makeBool(u){return ke(u)}static featureValue(u,o,i,p){return We(u,o,i,p)}static equalsNull(u){return null===u}static applyLike(u,o,i){return ce(u,o,i)}static ensureArray(u){return ie(u)}static applyIn(u,o){return le(u,o)}static currentDate(){const u=new Date;return u.setHours(0,0,0,0),u}static makeSqlInterval(u,o,i){return C.createFromValueAndQualifer(u,o,i)}static convertInterval(u){return u instanceof C?u.valueInMilliseconds():u}static currentTimestamp(){return new Date}static compare(u,o,i){return Ve(u,o,i)}static calculate(u,o,i){return Be(u,o,i)}static makeComparable(u){return D(u)}static evaluateFunction(u,o){return Le(u,o)}static lookup(u,o){const i=o[u];return void 0===i?null:i}static between(u,o){return null==u||null==o[0]||null==o[1]?null:u>=o[0]&&u<=o[1]}static notbetween(u,o){return null==u||null==o[0]||null==o[1]?null:u<o[0]||u>o[1]}static ternaryNot(u){return Y(u)}static ternaryAnd(u,o){return He(u,o)}static ternaryOr(u,o){return Ue(u,o)}}class oe{constructor(u,o){this.fieldsIndex=o,this.datefields={},this.parameters={},this._hasDateFunctions=void 0,this.parseTree=class{static parse(u){return Re.exports.parse(u)}}.parse(u);const{isStandardized:i,isAggregate:p,referencedFieldNames:v}=this.extractExpressionInfo(o);this.referencedFieldNames=v,this.isStandardized=i,this.isAggregate=p}static create(u,o){return new oe(u,o)}get fieldNames(){return this.referencedFieldNames}testSet(u,o=$){const i={};for(const p of this.fieldNames)i[p]=u.map(v=>o.getAttribute(v,p));return!!this.evaluateNode(this.parseTree,{attributes:i},$)}calculateValue(u,o=$){const i=this.evaluateNode(this.parseTree,u,o);return i instanceof C?i.valueInMilliseconds()/864e5:i}calculateValueCompiled(u,o=$){return null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(u,this.parameters,o,this.datefields):(0,Se.Z)("csp-restrictions")?this.calculateValue(u,o):(this.compileMe(),this.parseTree._compiledVersion(u,this.parameters,o,this.datefields))}testFeature(u,o=$){return!!this.evaluateNode(this.parseTree,u,o)}testFeatureCompiled(u,o=$){return null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(u,this.parameters,o,this.datefields):(0,Se.Z)("csp-restrictions")?this.testFeature(u,o):(this.compileMe(),!!this.parseTree._compiledVersion(u,this.parameters,o,this.datefields))}get hasDateFunctions(){return null!=this._hasDateFunctions||(this._hasDateFunctions=!1,this.visitAll(this.parseTree,u=>{"current_time"===u.type?this._hasDateFunctions=!0:"function"===u.type&&(this._hasDateFunctions=this._hasDateFunctions||er.has(u.name.toLowerCase()))})),this._hasDateFunctions}getFunctions(){const u=new Set;return this.visitAll(this.parseTree,o=>{"function"===o.type&&u.add(o.name.toLowerCase())}),Array.from(u)}getExpressions(){const u=new Map;return this.visitAll(this.parseTree,o=>{if("function"===o.type){const i=o.name.toLowerCase(),p=o.args.value[0];if("column_ref"===p.type){const v=p.column,t=`${i}-${v}`;u.has(t)||u.set(t,{aggregateType:i,field:v})}}}),[...u.values()]}getVariables(){const u=new Set;return this.visitAll(this.parseTree,o=>{"param"===o.type&&u.add(o.value.toLowerCase())}),Array.from(u)}compileMe(){const u="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","datefields",u).bind(tr)}extractExpressionInfo(u){const o=[],i=new Set;let p=!0,v=!0;return this.visitAll(this.parseTree,t=>{switch(t.type){case"column_ref":{const T=u.get(t.column);let I,b;T?I=b=T.name:(b=t.column,I=b.toLowerCase()),!T||"date"!==T.type&&"esriFieldTypeDate"!==T.type||(this.datefields[T.name]=1),i.has(I)||(i.add(I),o.push(b)),t.column=b;break}case"function":{const{name:T,args:I}=t,b=I.value.length;p&&(p=function(l,u){const o=Me[l.toLowerCase()];return null!=o&&u>=o.minParams&&u<=o.maxParams}(T,b)),v&&(v=function(l,u){const o=Ce[l.toLowerCase()];return null!=o&&u>=o.minParams&&u<=o.maxParams}(T,b));break}}}),{referencedFieldNames:Array.from(o),isStandardized:p,isAggregate:v}}visitAll(u,o){if(null!=u)switch(o(u),u.type){case"when_clause":this.visitAll(u.operand,o),this.visitAll(u.value,o);break;case"case_expression":for(const i of u.clauses)this.visitAll(i,o);"simple"===u.format&&this.visitAll(u.operand,o),null!==u.else&&this.visitAll(u.else,o);break;case"expr_list":for(const i of u.value)this.visitAll(i,o);break;case"unary_expr":this.visitAll(u.expr,o);break;case"binary_expr":this.visitAll(u.left,o),this.visitAll(u.right,o);break;case"function":this.visitAll(u.args,o)}}evaluateNodeToJavaScript(u){switch(u.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(u.value)+", "+JSON.stringify(u.qualifier)+","+JSON.stringify(u.op)+")";case"case_expression":{let o="";if("simple"===u.format){const i="this.makeComparable("+this.evaluateNodeToJavaScript(u.operand)+")";o="( ";for(let p=0;p<u.clauses.length;p++)o+=" ("+i+" === this.makeComparable("+this.evaluateNodeToJavaScript(u.clauses[p].operand)+")) ? ("+this.evaluateNodeToJavaScript(u.clauses[p].value)+") : ";o+=null!==u.else?this.evaluateNodeToJavaScript(u.else):"null",o+=" )"}else{o="( ";for(let i=0;i<u.clauses.length;i++)o+=" this.makeBool("+this.evaluateNodeToJavaScript(u.clauses[i].operand)+")===true ? ("+this.evaluateNodeToJavaScript(u.clauses[i].value)+") : ";o+=null!==u.else?this.evaluateNodeToJavaScript(u.else):"null",o+=" )"}return o}case"param":return"this.lookup("+JSON.stringify(u.value.toLowerCase())+",lookups)";case"expr_list":{let o="[";for(const i of u.value)"["!==o&&(o+=","),o+=this.evaluateNodeToJavaScript(i);return o+="]",o}case"unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(u.expr)+")";case"binary_expr":switch(u.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+" )";case"IS":if("null"!==u.right.type)throw new Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(u.left)+")";case"ISNOT":if("null"!==u.right.type)throw new Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(u.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(u.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(u.right)+"))";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(u.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(u.right)+")))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+")";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+")";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+","+JSON.stringify(u.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+","+JSON.stringify(u.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(u.operator)+","+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+")";case"*":case"-":case"+":case"/":return"this.calculate("+JSON.stringify(u.operator)+","+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+")"}throw new Error("Not Supported Operator "+u.operator);case"null":case"bool":case"string":case"number":return JSON.stringify(u.value);case"date":return"(new Date("+$e(u.value).getTime().toString()+"))";case"timestamp":return"(new Date("+Je(u.value).getTime().toString()+"))";case"current_time":return"date"===u.mode?"this.currentDate()":"this.currentTimestamp()";case"column_ref":return"this.featureValue(feature,"+JSON.stringify(u.column)+",datefields,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(u.name)+","+this.evaluateNodeToJavaScript(u.args)+")"}throw new Error("Unsupported sql syntax "+u.type)}evaluateNode(u,o,i){switch(u.type){case"interval":{const p=this.evaluateNode(u.value,o,i);return C.createFromValueAndQualifer(p,u.qualifier,u.op)}case"case_expression":if("simple"===u.format){const p=D(this.evaluateNode(u.operand,o,i));for(let v=0;v<u.clauses.length;v++)if(p===D(this.evaluateNode(u.clauses[v].operand,o,i)))return this.evaluateNode(u.clauses[v].value,o,i);if(null!==u.else)return this.evaluateNode(u.else,o,i)}else{for(let p=0;p<u.clauses.length;p++)if(ke(this.evaluateNode(u.clauses[p].operand,o,i)))return this.evaluateNode(u.clauses[p].value,o,i);if(null!==u.else)return this.evaluateNode(u.else,o,i)}return null;case"param":return this.parameters[u.value.toLowerCase()];case"expr_list":{const p=[];for(const v of u.value)p.push(this.evaluateNode(v,o,i));return p}case"unary_expr":return Y(this.evaluateNode(u.expr,o,i));case"binary_expr":switch(u.operator){case"AND":return He(this.evaluateNode(u.left,o,i),this.evaluateNode(u.right,o,i));case"OR":return Ue(this.evaluateNode(u.left,o,i),this.evaluateNode(u.right,o,i));case"IS":if("null"!==u.right.type)throw new Error("Unsupported RHS for IS");return null===this.evaluateNode(u.left,o,i);case"ISNOT":if("null"!==u.right.type)throw new Error("Unsupported RHS for IS");return null!==this.evaluateNode(u.left,o,i);case"IN":{const p=ie(this.evaluateNode(u.right,o,i));return le(this.evaluateNode(u.left,o,i),p)}case"NOT IN":{const p=ie(this.evaluateNode(u.right,o,i));return Y(le(this.evaluateNode(u.left,o,i),p))}case"BETWEEN":{const p=this.evaluateNode(u.left,o,i),v=this.evaluateNode(u.right,o,i);return null==p||null==v[0]||null==v[1]?null:p>=D(v[0])&&p<=D(v[1])}case"NOTBETWEEN":{const p=this.evaluateNode(u.left,o,i),v=this.evaluateNode(u.right,o,i);return null==p||null==v[0]||null==v[1]?null:p<D(v[0])||p>D(v[1])}case"LIKE":return ce(this.evaluateNode(u.left,o,i),this.evaluateNode(u.right,o,i),u.escape);case"NOT LIKE":return Y(ce(this.evaluateNode(u.left,o,i),this.evaluateNode(u.right,o,i),u.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return Ve(u.operator,this.evaluateNode(u.left,o,i),this.evaluateNode(u.right,o,i));case"-":case"+":case"*":case"/":return Be(u.operator,this.evaluateNode(u.left,o,i),this.evaluateNode(u.right,o,i))}case"null":case"bool":case"string":case"number":return u.value;case"date":return $e(u.value);case"timestamp":return Je(u.value);case"current_time":{const p=new Date;return"date"===u.mode&&p.setHours(0,0,0,0),p}case"column_ref":return We(o,u.column,this.datefields,i);case"function":{const p=this.evaluateNode(u.args,o,i);return this.isAggregate?function(l,u){const o=Ce[l.toLowerCase()];if(null==o)throw new Error("Function Not Recognised");if(u.length<o.minParams||u.length>o.maxParams)throw new Error(`Invalid Parameter count for call to ${l.toUpperCase()}`);return o.evaluate(u)}(u.name,p):Le(u.name,p)}}throw new Error("Unsupported sql syntax "+u.type)}}function Je(l){let u=zt.exec(l);if(null!==u){const[,o,i,p,v,t,T]=u;return W(o,i,p,v,t,T)}if(u=Kt.exec(l),null!==u){const[,o,i,p,v,t,T,I,b,_]=u;return W(o,i,p,v,t,T,I,b,_)}if(u=Qt.exec(l),null!==u){const[,o,i,p,v,t,T,I,b]=u;return W(o,i,p,v,t,"0",T,I,b)}if(u=Xt.exec(l),null!==u){const[,o,i,p,v,t]=u;return W(o,i,p,v,t)}if(u=_e.exec(l),null!==u){const[,o,i,p]=u;return W(o,i,p)}throw new Error("SQL Invalid Timestamp")}function $e(l){const u=_e.exec(l);if(null===u)throw new Error("SQL Invalid Date");const[,o,i,p]=u;return new Date(parseInt(o,10),parseInt(i,10)-1,parseInt(p,10))}function ke(l){return!0===l}function ie(l){return Array.isArray(l)?l:[l]}function Y(l){return null!==l?!0!==l:null}function He(l,u){return null!=l&&null!=u?!0===l&&!0===u:!1!==l&&!1!==u&&null}function Ue(l,u){return null!=l&&null!=u?!0===l||!0===u:!0===l||!0===u||null}function le(l,u){if(null==l)return null;let o=!1;for(const i of u)if(null==i)o=null;else if(l===i){o=!0;break}return o}function ce(l,u,o){if(null==l)return null;const i=u,p=o;let v="";const t="-[]/{}()*+?.\\^$|";let T=0;for(let I=0;I<i.length;I++){const b=i.charAt(I);switch(T){case 0:b===p?T=1:t.indexOf(b)>=0?v+="\\"+b:v+="%"===b?".*":"_"===b?".":b;break;case 1:t.indexOf(b)>=0?v+="\\"+b:v+=b,T=0}}return new RegExp("^"+v+"$").test(l)}function D(l){return l instanceof Date?l.valueOf():l}function Ve(l,u,o){if(null==u||null==o)return null;const i=D(u),p=D(o);switch(l){case"<>":return i!==p;case"=":return i===p;case">":return i>p;case"<":return i<p;case">=":return i>=p;case"<=":return i<=p}}function Be(l,u,o){if(u instanceof C)if(o instanceof Date)switch(l){case"+":return new Date(u.valueInMilliseconds()+o.getTime());case"-":return u.valueInMilliseconds()-o.getTime();case"*":return u.valueInMilliseconds()*o.getTime();case"/":return u.valueInMilliseconds()/o.getTime()}else if(o instanceof C)switch(l){case"+":return C.createFromMilliseconds(u.valueInMilliseconds()+o.valueInMilliseconds());case"-":return C.createFromMilliseconds(u.valueInMilliseconds()-o.valueInMilliseconds());case"*":return u.valueInMilliseconds()*o.valueInMilliseconds();case"/":return u.valueInMilliseconds()/o.valueInMilliseconds()}else u=u.valueInMilliseconds();else if(o instanceof C)if(u instanceof Date)switch(l){case"+":return new Date(o.valueInMilliseconds()+u.getTime());case"-":return new Date(u.getTime()-o.valueInMilliseconds());case"*":return u.getTime()*o.valueInMilliseconds();case"/":return u.getTime()/o.valueInMilliseconds()}else o=o.valueInMilliseconds();else if(u instanceof Date&&"number"==typeof o)switch(o=24*o*60*60*1e3,u=u.getTime(),l){case"+":return new Date(u+o);case"-":return new Date(u-o);case"*":return new Date(u*o);case"/":return new Date(u/o)}else if(o instanceof Date&&"number"==typeof u)switch(u=24*u*60*60*1e3,o=o.getTime(),l){case"+":return new Date(u+o);case"-":return new Date(u-o);case"*":return new Date(u*o);case"/":return new Date(u/o)}switch(l){case"+":return u+o;case"-":return u-o;case"*":return u*o;case"/":return u/o}}function We(l,u,o,i){const p=i.getAttribute(l,u);return null!=p&&1===o[u]?new Date(p):p}const $={getAttribute:(l,u)=>(function(l){return l&&"object"==typeof l.attributes}(l)?l.attributes:l)[u]}}}]);