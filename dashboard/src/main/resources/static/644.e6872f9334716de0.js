"use strict";(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[644],{40644:(m,h,a)=>{a.r(h),a.d(h,{Blur:()=>O}),a(26436);var g=a(27001),E=(a(67474),a(36320),a(40150),a(94345),a(82705),a(13006),a(48082),a(10269));const p=[1,0],B=[0,1];class O{constructor(){this._blurFBO=null,this._size=[0,0],this._programDesc={gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},radialBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/radial-blur",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}dispose(){this._blurFBO&&(this._blurFBO.dispose(),this._blurFBO=null)}draw(r,n,t){const{context:e}=r,{type:l,radius:i}=t;if(0===i)return;this._createOrResizeResources(r),this._quad||(this._quad=new E.Z(e,[-1,-1,1,-1,-1,1,1,1]));const s=this._quad;s.bind(),"blur"===l?this._gaussianBlur(r,n,i):this._radialBlur(r,n),s.unbind()}_gaussianBlur(r,n,t){const{context:e,state:l,painter:i,pixelRatio:s}=r,{size:_}=l,{materialManager:u}=i,d=this._programDesc,b=this._quad,M=[Math.round(s*_[0]),Math.round(s*_[1])],c=this._blurFBO,o=u.getProgram(r,d.gaussianBlur,[{name:"radius",value:Math.ceil(t)}]);e.useProgram(o),e.setBlendingEnabled(!1),e.bindFramebuffer(c),e.bindTexture(n.colorTexture,4),o.setUniform1i("u_colorTexture",4),o.setUniform2fv("u_texSize",M),o.setUniform2fv("u_direction",p),o.setUniform1f("u_sigma",t),b.draw(),e.bindFramebuffer(n),e.setStencilWriteMask(0),e.setStencilTestEnabled(!1),e.setDepthWriteEnabled(!1),e.setDepthTestEnabled(!1),e.bindTexture(c.colorTexture,5),o.setUniform1i("u_colorTexture",5),o.setUniform2fv("u_direction",B),b.draw(),e.setBlendingEnabled(!0),e.setBlendFunction(1,771),e.setStencilTestEnabled(!0)}_radialBlur(r,n){const{context:t,painter:e}=r,{materialManager:l}=e,i=this._programDesc,s=this._quad,_=this._blurFBO;t.bindFramebuffer(_);const u=l.getProgram(r,i.radialBlur);t.useProgram(u),t.setBlendingEnabled(!1),t.bindTexture(n.colorTexture,4),u.setUniform1i("u_colorTexture",4),s.draw(),t.bindFramebuffer(n),t.setStencilWriteMask(0),t.setStencilTestEnabled(!1),t.setDepthWriteEnabled(!1),t.setDepthTestEnabled(!1),t.setBlendingEnabled(!0);const d=l.getProgram(r,i.blit);t.useProgram(d),t.bindTexture(_.colorTexture,5),d.setUniform1i("u_texture",5),t.setBlendFunction(1,771),s.draw()}_createOrResizeResources(r){const{context:n,state:t,pixelRatio:e}=r,{size:l}=t,i=Math.round(e*l[0]),s=Math.round(e*l[1]);this._blurFBO&&this._size[0]===i&&this._size[1]===s||(this._size[0]=i,this._size[1]=s,this._blurFBO?this._blurFBO.resize(i,s):this._blurFBO=new g.Z(n,{colorTarget:0,depthStencilTarget:0,width:i,height:s},{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:i,height:s}))}}}}]);