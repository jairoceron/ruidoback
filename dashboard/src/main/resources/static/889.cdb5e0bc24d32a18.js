"use strict";var ae=Object.defineProperty,se=Object.defineProperties,oe=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertySymbols,le=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,$=(v,u,r)=>u in v?ae(v,u,{enumerable:!0,configurable:!0,writable:!0,value:r}):v[u]=r,A=(v,u)=>{for(var r in u||(u={}))le.call(u,r)&&$(v,r,u[r]);if(N)for(var r of N(u))ue.call(u,r)&&$(v,r,u[r]);return v},Q=(v,u)=>se(v,oe(u));(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[889,9453],{98722:(v,u,r)=>{function x(a,i,e){return i.flatten(({sublayers:o})=>o).length!==a.length||!!a.some(o=>o.originIdOf("minScale")>e||o.originIdOf("maxScale")>e||o.originIdOf("renderer")>e||o.originIdOf("labelingInfo")>e||o.originIdOf("opacity")>e||o.originIdOf("labelsVisible")>e||o.originIdOf("source")>e)||!I(a,i)}function h(a,i,e){return!!a.some(s=>{const o=s.source;return!(!o||"map-layer"===o.type&&o.mapLayerId===s.id&&(!o.gdbVersion||o.gdbVersion===e.gdbVersion))||s.originIdOf("renderer")>2||s.originIdOf("labelingInfo")>2||s.originIdOf("opacity")>2||s.originIdOf("labelsVisible")>2})||!I(a,i)}function I(a,i){if(!a||!a.length)return!0;const e=i.slice().reverse().flatten(({sublayers:l})=>l&&l.toArray().reverse()).map(l=>l.id).toArray();if(a.length>e.length)return!1;let s=0;const o=e.length;for(const{id:l}of a){for(;s<o&&e[s]!==l;)s++;if(s>=o)return!1}return!0}function b(a){return!!a&&a.some(i=>null!=i.minScale||i.layerDefinition&&null!=i.layerDefinition.minScale)}r.d(u,{FN:()=>h,ac:()=>b,QV:()=>x})},62008:(v,u,r)=>{function x(i,e){return e?"xoffset"in e&&e.xoffset?Math.max(i,Math.abs(e.xoffset)):"yoffset"in e&&e.yoffset?Math.max(i,Math.abs(e.yoffset||0)):i:i}function I(i,e){return"number"==typeof i?i:i&&i.stops&&i.stops.length?function(i){let e=0,s=0;for(let o=0;o<i.length;o++){const l=i[o].size;"number"==typeof l&&(e+=l,s++)}return e/s}(i.stops):e}function a(i){const e=i&&i.renderer,s="touch"===(i&&i.event&&i.event.pointerType)?9:6;if(!e)return s;const o="visualVariables"in e?function(i,e){if(!e)return i;const s=e.filter(y=>"size"===y.type).map(y=>{const{maxSize:C,minSize:E}=y;return(I(C,i)+I(E,i))/2});let o=0;const l=s.length;if(0===l)return i;for(let y=0;y<l;y++)o+=s[y];const f=Math.floor(o/l);return Math.max(f,i)}(s,e.visualVariables):s;if("simple"===e.type)return x(o,e.symbol);if("unique-value"===e.type){let l=o;return e.uniqueValueInfos.forEach(f=>{l=x(l,f.symbol)}),l}if("class-breaks"===e.type){let l=o;return e.classBreakInfos.forEach(f=>{l=x(l,f.symbol)}),l}return o}r.d(u,{k:()=>a})},43904:(v,u,r)=>{r.r(u),r.d(u,{default:()=>re});var x=r(61921),h=r(60046),I=r(33870),b=r(12523),a=r(9077),s=(r(67474),r(57025),r(42442)),o=r(12794),l=r(7109),f=r(70297),y=r(8940),C=r(38963),E=r(88854);let P=class extends E.Z{renderChildren(d){if(d.drawPhase!==C.jx.HIGHLIGHT||(this.attributeView.bindTextures(d.context),!this.children.some(M=>M.hasData)))return;super.renderChildren(d);const{painter:c}=d,m=c.effects.highlight;m.bind(d),d.context.setColorMask(!0,!0,!0,!0),d.context.clear(16384),this._renderChildren(d,m.defines.concat(["highlightAll"])),m.draw(d),m.unbind()}};P=(0,h._)([(0,s.j)("esri.views.2d.layers.support.HighlightGraphicContainer")],P);var g=P,w=r(79821),O=r(59989),R=r(22795),G=r(60305),J=r(99737),X=r(57104),Y=r(62008),_=r(8982),Z=r(72501);const k=d=>{let c=class extends d{initialize(){this.exportImageParameters=new X.R({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get exportImageVersion(){var m;return null==(m=this.exportImageParameters)||m.commitProperty("version"),this.commitProperty("timeExtent"),(this._get("exportImageVersion")||0)+1}fetchPopupFeatures(m,M){var T=this;return(0,x.Z)(function*(){const{layer:S}=T;if(!m)return Promise.reject(new R.Z("mapimagelayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:S}));const j=T.get("view.scale"),B=[],H=function(){var U=(0,x.Z)(function*(p){if(p.visible&&(0===p.minScale||j<=p.minScale)&&(0===p.maxScale||j>=p.maxScale))if(p.sublayers)p.sublayers.forEach(H);else if(p.popupEnabled){const F=(0,Z.V)(p,Q(A({},M),{defaultPopupTemplateEnabled:!1}));(0,G.pC)(F)&&B.unshift({sublayer:p,popupTemplate:F})}});return function(V){return U.apply(this,arguments)}}(),ne=S.sublayers.toArray().reverse().map(H);yield Promise.all(ne);const ie=B.map(function(){var U=(0,x.Z)(function*({sublayer:p,popupTemplate:V}){yield p.load().catch(()=>{});const D=p.createQuery(),F=(0,G.pC)(M)?M.event:null,K=(0,Y.k)({renderer:p.renderer,event:F}),W=T.createFetchPopupFeaturesQueryGeometry(m,K);D.geometry=W,D.outFields=yield(0,Z.e)(p,V);const z=yield T._loadArcadeModules(V);return z&&z.arcadeUtils.hasGeometryOperations(V)||(D.maxAllowableOffset=W.width/K),(yield p.queryFeatures(D)).features});return function(p){return U.apply(this,arguments)}}());return(yield(0,b.as)(ie)).reduce((U,p)=>p.value?[...U,...p.value]:U,[]).filter(U=>null!=U)})()}canResume(){var m;return!(!super.canResume()||null!=(m=this.timeExtent)&&m.isEmpty)}_loadArcadeModules(m){if(m.get("expressionInfos.length"))return(0,_.LC)()}};return(0,h._)([(0,a.Cb)()],c.prototype,"exportImageParameters",void 0),(0,h._)([(0,a.Cb)({readOnly:!0})],c.prototype,"exportImageVersion",null),(0,h._)([(0,a.Cb)()],c.prototype,"layer",void 0),(0,h._)([(0,a.Cb)()],c.prototype,"suspended",void 0),(0,h._)([(0,a.Cb)(J.qG)],c.prototype,"timeExtent",void 0),c=(0,h._)([(0,s.j)("esri.views.layers.MapImageLayerView")],c),c};var q=r(72619),ee=r(16204);const te=I.Z.getLogger("esri.views.2d.layers.MapImageLayerView2D");let L=class extends(k((0,q.y)((0,f.y)(O.Z)))){constructor(){super(...arguments),this._highlightGraphics=new o.ZP}hitTest(){return null}update(d){this.strategy.update(d).catch(c=>{(0,b.D_)(c)||te.error(c)})}attach(){const{imageMaxWidth:d,imageMaxHeight:c,version:m}=this.layer,M=m>=10.3,T=m>=10;this._bitmapContainer=new l.c,this.container.addChild(this._bitmapContainer);const S=new y.Z({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new g(this.view.featuresTilingScheme)});this.container.addChild(S.container),this.strategy=new w.Z({container:this._bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:d,imageMaxHeight:c,imageRotationSupported:M,imageNormalizationSupported:T,hidpi:!0}),this.handles.add(this.watch("exportImageVersion",()=>this.requestUpdate()),"exportImageVersion"),this.handles.add(this.watch("view.floors",()=>this.requestUpdate()),"view.floors"),this.requestUpdate()}detach(){this.handles.remove("exportImageVersion"),this.handles.remove("view.floors"),this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}highlight(d,c){return this._highlightGraphics.add(d),{remove:()=>{this._highlightGraphics.remove(d)}}}createFetchPopupFeaturesQueryGeometry(d,c){return(0,ee.K)(d,c,this.view)}doRefresh(){var d=this;return(0,x.Z)(function*(){d.requestUpdate()})()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(d,c,m,M){return this.layer.fetchImage(d,c,m,A({timeExtent:this.timeExtent,floors:this.view.floors},M))}};(0,h._)([(0,a.Cb)()],L.prototype,"strategy",void 0),(0,h._)([(0,a.Cb)()],L.prototype,"updating",void 0),L=(0,h._)([(0,s.j)("esri.views.2d.layers.MapImageLayerView2D")],L);var re=L},72501:(v,u,r)=>{r.d(u,{V:()=>i,e:()=>b});var x=r(61921),h=r(60305),I=r(76009);function b(e){return a.apply(this,arguments)}function a(){return(a=(0,x.Z)(function*(e,s=e.popupTemplate){if(!(0,h.pC)(s))return[];const o=yield s.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:l}=s,{objectIdField:f,typeIdField:y,globalIdField:C,relationships:E}=e;if(o.includes("*"))return["*"];const P=l?yield(0,I.CH)(e):[],g=(0,I.Q0)(e.fieldsIndex,[...o,...P]);return y&&g.push(y),g&&f&&e.fieldsIndex.has(f)&&-1===g.indexOf(f)&&g.push(f),g&&C&&e.fieldsIndex.has(C)&&-1===g.indexOf(C)&&g.push(C),E&&E.forEach(w=>{const{keyField:O}=w;g&&O&&e.fieldsIndex.has(O)&&-1===g.indexOf(O)&&g.push(O)}),g})).apply(this,arguments)}function i(e,s){return e.popupTemplate?e.popupTemplate:(0,h.pC)(s)&&s.defaultPopupTemplateEnabled&&(0,h.pC)(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}},16204:(v,u,r)=>{r.d(u,{K:()=>a}),r(73513);var h=r(60305),I=r(4820),b=r(82059);function a(s,o,l,f=new b.Z){let y;if("2d"===l.type)y=o*l.resolution;else if("3d"===l.type){const O=l.overlayPixelSizeInMapUnits(s),R=l.basemapSpatialReference;y=(0,h.pC)(R)&&!R.equals(l.spatialReference)?(0,I.c9)(R)/(0,I.c9)(l.spatialReference):o*O}const C=s.x-y,E=s.y-y,P=s.x+y,g=s.y+y,{spatialReference:w}=l;return f.xmin=Math.min(C,P),f.ymin=Math.min(E,g),f.xmax=Math.max(C,P),f.ymax=Math.max(E,g),f.spatialReference=w,f}new b.Z},19453:(v,u,r)=>{function x(a){var i;const e=a.layer;return"floorInfo"in e&&null!=(i=e.floorInfo)&&i.floorField&&"floors"in a.view?b(a.view.floors,e.floorInfo.floorField):null}function h(a,i){var e;return"floorInfo"in i&&null!=(e=i.floorInfo)&&e.floorField?b(a,i.floorInfo.floorField):null}function I(a,i){const{definitionExpression:e}=i;return a?e?`(${e}) AND (${a})`:a:e}function b(a,i){if(null==a||!a.length)return null;const e=a.filter(s=>""!==s).map(s=>`'${s}'`);return e.push("''"),`${i} IN (${e.join(",")}) OR ${i} IS NULL`}r.d(u,{Hp:()=>I,cx:()=>x,ff:()=>h})}}]);